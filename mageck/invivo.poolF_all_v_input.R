pdf(file='invivo.poolF_all_v_input.pdf',width=4.5,height=4.5);
gstable=read.table('invivo.poolF_all_v_input.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Banf1","Slc25a19","Vcp","Hspa5","Psmg1","Dph3","Gpn1","Snrnp35","Rtcb","Cramp1l")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24_vs_0 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(30.65199305972779,7.136031212514908,4.88566132300656,24.36488208442136,8.781572240788904,88.9296714688188,16.64781136129056,1.9478387998449305,0.0,30.15399159554903,17.115564480438685,105.72681986193287,0.0,1.3350173716782314,0.0,42.78835075259057,7.69359484858515,17.0694108330658,35.345991520525494,14.66811719342769,4.692071618526308,7.534058489473054,6.842097731240341,10.218905501324588,17.420098270183033),c(25.936301819769668,22.597432172963874,2.44283066150328,106.43606384247227,0.0,0.0,0.0,7.791355199379722,0.0,3.015399159554903,3.260107520083559,0.74983560185768,0.0,8.010104230069388,0.0,5.462342649266881,2.5645316161950498,44.886228486950806,19.978169120297018,15.530947616570495,12.512190982736822,8.78973490438523,1.0526304201908216,3.9303482697402266,6.968039308073214),c(16.504919339853426,0.0,0.0,0.0,0.0,0.0,2.77463522688176,0.0,0.0,0.0,0.0,0.0,4.160458932849904,0.0,1.8652738389262187,7.283123532355841,8.20650117182416,4.425402808572615,0.0,1.294245634714208,3.1280477456842055,61.52814433069661,0.0,13.36318411711677,3.484019654036607),c(21.613584849808056,10.704046818772362,18.3212299612746,6.411811074847726,24.881121348901896,0.0,0.0,0.0,0.0,7.5384978988872575,43.19642464110716,2.2495068055730396,0.0,0.0,0.0,20.938980155523044,16.41300234364832,15.172809629391821,16.1362135202399,5.608397750428234,10.948167109894719,2.5113528298243515,11.052619412003628,7.074626885532408,30.194837001650594))
targetgene="Banf1"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(44.013118239609135,65.41361944805332,47.63519789931396,5.129448859878181,11.70876298771854,0.0,13.873176134408801,0.0,0.0,7.5384978988872575,0.0,7.4983560185768,10.401147332124761,24.030312690208167,6.528458436241765,35.50522722023472,18.46462763660436,37.299823672254895,24.58851584036556,29.33623438685538,0.7820119364210514,36.4146160324531,27.894706135056772,39.303482697402266,37.162876309723806),c(158.3686308085936,33.30147899173623,37.86387525330084,12.823622149695453,40.98067045701489,0.0,147.05566702473328,11.687032799069582,67.68822789347027,18.092394957329418,79.0576073620263,29.243588472449517,4.160458932849904,317.73413445941907,11.191643033557312,60.99615958348017,52.31644497037902,20.230412839189096,35.345991520525494,20.707930155427327,68.81705040505253,82.8746433842036,37.36837991677417,44.019900621090535,46.453595387154756),c(118.28525526894956,30.922801920897932,18.3212299612746,78.22409511314225,108.30605763639649,25.89091700990927,95.26247612294043,13.634871598914513,15.04182842077117,15.076995797774515,123.88408576317524,63.73602615790279,1.040114733212476,149.5219456279619,24.248559906040843,57.35459781730225,24.61950351547248,41.09302607960285,33.04081816049122,43.14152115714027,68.81705040505253,22.602175468419162,41.57890159753745,40.08955235135031,13.936078616146428),c(80.55972534928458,24.976109243802178,10.99273797676476,29.49433094429954,35.126288963155616,0.0,33.29562272258112,0.0,0.0,167.3546533552971,17.930591360459573,28.493752870591837,2.080229466424952,5.340069486712926,27.04647066443017,25.49093236324544,38.46797424292575,25.28801604898637,11.525866800171356,0.0,14.858226791999977,11.301087734209581,35.78943428648794,52.66666681451903,45.29225550247589))
targetgene="Slc25a19"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(5.501639779951142,21.408093637544724,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,22.005725760564022,0.0,0.0,0.0,0.0,0.0,3.59034426267307,0.0,0.0,0.0,9.384143237052616,0.0,3.157891260572465,22.009950310545268,11.613398846788689),c(90.38408209919733,39.24817166883199,34.19962926104592,37.18850423411681,16.099549108112992,38.273529492909354,24.97171704193584,50.64380879596819,0.0,24.123193276439224,28.525940800731142,9.74786282414984,0.0,8.010104230069388,147.35663327517128,94.68060592062594,75.39722951613447,32.87442086368228,61.4712896009139,28.041988752141172,72.72711008715778,32.64758678771657,35.26311907639253,55.810945430311214,44.13091561779702),c(34.974710029689405,5.946692677095756,0.0,0.0,2.927190746929635,0.0,0.0,77.91355199379721,26.323199736349547,10.55389705844216,0.0,74.23372458391032,1.040114733212476,0.0,0.0,6.37273309081136,1.02581264647802,26.552416851435687,24.58851584036556,47.02425806128289,0.0,45.204350936838324,31.05259739562924,16.50746273290895,2.322679769357738),c(38.9044527296545,11.893385354191512,2.44283066150328,5.129448859878181,4.390786120394452,0.0,0.0,0.0,0.0,197.50864495084613,2.4450806400626695,0.74983560185768,2.080229466424952,8.010104230069388,18.652738389262186,6.37273309081136,5.641969555629109,29.081218456334327,39.18794712058261,10.785380289285067,18.76828647410523,0.0,6.31578252114493,10.218905501324588,8.129379192752083))
targetgene="Vcp"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(44.013118239609135,161.75004081700456,18.3212299612746,0.0,55.616624191663064,49.530449932000344,59.19221817347755,0.0,0.0,104.03127100464415,114.91879008294545,5.248849213003759,28.083097796736855,18.69024320349524,0.9326369194631093,43.698741194135046,41.032505859120796,43.62182768450149,36.88277376054834,23.296421424855744,46.92071618526308,21.34649905350699,40.526271177346636,43.23383096714249,31.35617688632946),c(12.968150909884834,10.704046818772362,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.7311713246334404,3.07743793943406,1.8966012036739777,6.14712896009139,0.0,1.5640238728421028,0.0,0.0,0.0,0.0),c(55.80234633950444,58.27758823553841,14.65698396901968,19.23543322454318,108.30605763639649,831.886420448824,95.26247612294043,0.0,0.0,22.615493696661773,71.72236544183829,98.22846384335607,195.5415698439455,78.76602492901566,80.2067750738274,42.78835075259057,24.10659719223347,51.84043290042206,39.18794712058261,25.88491269428416,19.550298410526285,18.835146223682635,52.63152100954108,21.223880656597224,33.6788566556872),c(14.540047989870875,0.0,0.0,0.0,4.390786120394452,0.0,0.0,0.0,0.0,0.0,26.895887040689363,43.490464907745434,0.0,0.0,1.8652738389262187,0.0,15.90009602040931,2.528801604898637,2.305173360034271,0.0,6.256095491368411,0.0,0.0,0.0,0.0))
targetgene="Hspa5"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(110.42576986901935,14.272062425029816,170.9981463052296,46.16503973890363,16.099549108112992,38.273529492909354,28.671230677778187,91.54842359271173,109.05325605059097,34.677090334881385,23.6357795206058,73.48388898205263,14.561606264974664,40.050521150346945,249.0140574966502,50.98186472649088,102.06835832456298,41.72522648082751,74.53393864110811,37.964538618283434,89.14936075199985,28.880557542980043,75.26307504364375,44.80597027503858,182.33036189458244),c(214.56395141809455,3.568015606257454,87.94190381411808,34.62377980417772,54.153028818198244,124.95181687390996,160.0039647501815,634.9954487494473,71.44868499866305,69.35418066976277,111.6586825628619,55.487834537468316,706.2379038512712,46.7256080087381,63.41931052349143,86.48709194672561,81.03919907176358,67.64544293103854,92.20693440137084,27.17915832899837,51.61278780378939,110.49952451227146,42.105216807632864,150.13930390407666,68.51905319605326),c(82.91757096926364,39.24817166883199,15.87839929977132,3.847086644908636,27.808312095831532,96.8095157761825,3.699513635842347,27.269743197829026,0.0,99.5081722653118,13.855456960355125,10.497698426007519,277.7106337677311,36.04546903531225,125.90598412751976,35.50522722023472,66.6778220210713,37.93202407347955,66.85002744099387,39.25878425299764,78.9832055785262,25.113528298243516,42.105216807632864,29.084577196077674,106.84326939045594),c(42.834195429619605,44.005525810508594,3.66424599225492,2.5647244299390906,11.70876298771854,0.0,38.84489317634464,19.478387998449303,0.0,19.60009453710687,13.855456960355125,286.43719990963376,6.240688399274856,6.675086858391158,1.8652738389262187,47.34030296031297,23.593690868994457,18.966012036739777,21.514951360319863,28.473403963712578,63.342966850105164,11.301087734209581,6.842097731240341,4.7164179236882715,16.258758385504166))
targetgene="Psmg1"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(135.1831488787995,10.704046818772362,142.90559369794187,93.6124416927768,21.953930601972264,76.54705898581871,41.619528403226404,0.0,41.36502815712072,104.03127100464415,4.890161280125339,25.494410463161117,3.120344199637428,300.3789086276021,124.97334720805665,40.9675698695016,32.31309836405763,59.42683771511797,96.04889000142796,13.373871558713482,30.498465520421004,10.045411319297406,47.36836890858697,84.8955226263889,37.162876309723806),c(270.7592720275955,82.06435894392143,210.08343688928207,93.6124416927768,297.10986081335795,117.07197256654626,476.31238061470214,159.7227815872843,236.90879762714593,375.41719536458544,96.173171842465,104.9769842600752,163.29801311435875,200.2526057517347,75.54359047651185,97.41177724525937,135.92017565833766,101.78426459717014,106.8063656815879,54.35831665799674,136.85208887368398,74.08490847981837,178.42085622234427,51.094527506622946,130.07006708403333),c(73.87916275934391,57.08824970011926,15.87839929977132,11.541259934725907,1.4635953734648175,0.0,18.497568179211733,196.73171878433797,0.0,27.138592435994127,17.930591360459573,8.24819162043448,0.0,9.34512160174762,11.191643033557312,23.670151480156484,17.43881499012634,21.494813641638416,11.525866800171356,59.96671440842497,21.896334219789438,38.92596886227745,55.789412270113544,64.45771162373971,26.710817347613986),c(82.52459669926714,10.704046818772362,2.44283066150328,12.823622149695453,4.390786120394452,43.90198971245485,4.624392044802933,1.9478387998449305,0.0,4.5230987393323545,5.705188160146228,6.74852041671912,0.0,4.005052115034694,5.595821516778656,10.014294856989281,9.74522014154119,14.540609228167163,18.44138688027417,14.236701981856289,56.3048594223157,6.278382074560879,20.52629319372102,39.303482697402266,2.322679769357738))
targetgene="Dph3"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(5.501639779951142,1.1893385354191512,4.88566132300656,0.0,1.4635953734648175,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7683911200114237,0.0,0.0,0.0,0.0,0.0,0.0),c(65.62670308941719,92.7684057626938,7.32849198450984,32.05905537423863,13.172358361183358,32.645069273363866,36.070257949462885,99.33977879209145,30.08365684154234,27.138592435994127,20.375672000522243,15.746547639011279,54.085966127048756,2.670034743356463,27.04647066443017,71.01045444046945,26.67112880842852,78.39284975185775,30.73564480045695,23.727836636427146,29.716453583999954,18.835146223682635,42.631532017728276,49.52238819872685,55.74431446458571),c(5.894614049947652,1.1893385354191512,0.0,0.0,8.781572240788904,0.0,7.399027271684694,0.0,0.0,15.076995797774515,0.0,0.0,0.0,0.0,0.0,2.7311713246334404,6.15487587886812,0.0,0.0,0.0,0.0,0.0,0.0,3.9303482697402266,15.097418500825297),c(39.297426999651016,4.757354141676605,57.406520545327076,19.23543322454318,2.927190746929635,0.0,21.272203406093496,0.0,0.0,6.030798319109806,215.98212320553577,49.489149722606875,11.441262065337236,0.0,10.259006114094202,19.118199272434083,51.290632323901,44.886228486950806,21.514951360319863,33.218971290998006,45.35669231242098,2.5113528298243515,4.210521680763287,56.59701508425926,25.549477462935116))
targetgene="Gpn1"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(25.936301819769668,0.0,12.2141533075164,8.976535504786817,0.0,1.1256920439090987,0.0,0.0,41.36502815712072,9.046197478664709,0.0,0.0,0.0,9.34512160174762,23.315922986577732,21.849370597067523,17.43881499012634,5.057603209797274,6.915520080102814,0.0,7.820119364210514,0.0,5.263152100954108,10.218905501324588,38.32421619440267),c(30.65199305972779,71.36031212514908,7.32849198450984,3.847086644908636,16.099549108112992,115.94628052263717,1.8497568179211734,5.843516399534791,3.7604571051927924,1.5076995797774515,39.9363171210236,3.7491780092884,0.0,10.680138973425851,0.9326369194631093,7.283123532355841,2.5645316161950498,28.449018055109665,45.335076080674,47.45567327285429,57.8688832951578,5.022705659648703,13.15788025238527,50.3084578526749,2.322679769357738),c(12.968150909884834,0.0,3.66424599225492,0.0,2.927190746929635,0.0,61.041974991398725,0.0,33.844113946735135,9.046197478664709,0.0,0.74983560185768,0.0,2.670034743356463,1.8652738389262187,1.8207808830889602,21.542065576038418,15.805010030616481,16.90460464025132,1.294245634714208,14.076214855578925,0.0,5.263152100954108,7.074626885532408,2.322679769357738),c(48.335835209570746,49.952218487604355,266.2685421038575,33.34141758920818,33.662693589690804,2.2513840878181974,175.72689770251148,7.791355199379722,3.7604571051927924,3.015399159554903,6.520215040167118,10.497698426007519,49.92550719419885,113.47647659264968,63.41931052349143,29.132494129423364,50.26481967742298,8.21860521592057,38.419556000571184,43.572936368711666,36.75456101178941,23.85785188333134,58.4209883205906,17.293532386856995,8.129379192752083))
targetgene="Snrnp35"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(133.61125179881344,128.44856182526834,102.59888778313776,242.36645862924405,121.47841599757986,4.502768175636395,100.81174657670395,74.01787439410735,0.0,73.87727940909512,38.306263360981816,125.22254551023255,23.92263886388695,36.04546903531225,23.315922986577732,127.45466181622722,115.91682905201625,122.6468778375839,79.91267648118807,91.02860964156596,143.1081843650524,27.624881128067866,133.15774815413894,109.2636818987783,106.84326939045594),c(57.76721768948699,2.3786770708383025,1.22141533075164,1.2823622149695453,21.953930601972264,0.0,114.68492271111275,3.895677599689861,26.323199736349547,12.061596638219612,13.855456960355125,8.998027222292158,7.280803132487332,5.340069486712926,1.8652738389262187,32.774055895601286,37.442161596447725,38.56422447470421,53.01898728078824,31.924725656283798,108.69965916252615,0.0,38.42101033696499,18.865671694753086,16.258758385504166),c(25.15035327977665,1.1893385354191512,2.44283066150328,1.2823622149695453,5.85438149385927,25.89091700990927,0.0,0.0,3.7604571051927924,4.5230987393323545,14.670483840376015,0.0,110.25216172052247,0.0,0.9326369194631093,12.74546618162272,13.33556440421426,23.391414845312394,1.5367822400228475,9.059719442999455,0.0,0.0,25.78944529467513,14.149253771064815,2.322679769357738),c(29.86604451973477,1.1893385354191512,1.22141533075164,5.129448859878181,8.781572240788904,59.66167832718223,20.347324997132908,44.8002923964334,0.0,4.5230987393323545,5.705188160146228,0.74983560185768,9.361032598912285,62.745816468876875,5.595821516778656,19.118199272434083,5.641969555629109,6.954204413471252,1.5367822400228475,22.433591001712937,18.76828647410523,27.624881128067866,0.0,3.9303482697402266,18.581438154861903))
targetgene="Rtcb"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(33.40281294970336,3.568015606257454,8.54990731526148,1.2823622149695453,5.85438149385927,1690.7894499514662,83.23905680645281,1.9478387998449305,11.281371315578378,87.44657562709219,10.595349440271567,48.7393141207492,0.0,0.0,1.8652738389262187,5.462342649266881,15.90009602040931,18.966012036739777,15.367822400228475,40.984445099283256,27.370417774736797,1.2556764149121757,4.736836890858697,4.7164179236882715,47.61493527183363),c(60.91101184945907,1.1893385354191512,9.77132264601312,5.129448859878181,8.781572240788904,94.5581316883643,0.9248784089605867,5.843516399534791,0.0,1.5076995797774515,8.150268800208897,11.2475340278652,16.641835731399617,114.81149396432791,35.44020293959815,24.580541921700963,34.87762998025268,55.001434906545356,38.419556000571184,14.236701981856289,10.948167109894719,32.64758678771657,9.473673781717395,14.93532342501286,6.968039308073214),c(104.92413008906821,76.11766626682568,12.2141533075164,79.50645732811181,172.70425406884846,445.7740493880031,211.79715565197435,27.269743197829026,22.562742631156755,61.81568277087551,26.080860160668472,39.741286898457034,142.49571845010922,234.96305741536872,32.64229218120882,63.72733090811361,24.61950351547248,77.12844894940842,29.967253680445527,18.982269309141717,87.58533687915775,35.15893961754092,39.999955967251225,50.3084578526749,56.90565434926458),c(49.90773228955679,1.1893385354191512,0.0,25.647244299390906,13.172358361183358,0.0,0.0,0.0,157.93919841809728,0.0,15.485510720396904,21.745232453872717,30.163327263161804,5.340069486712926,224.76549759060936,58.26498825884673,12.30975175773624,43.62182768450149,27.662080320411256,6.47122817357104,9.384143237052616,3.767029244736527,9.999988991812806,24.368159272389406,3.484019654036607))
targetgene="Cramp1l"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Setd5","Arl15","Ankrd11","Slc23a2","Calm1","Calm2","Gm21188","Gm10356_Ikzf5","Nudcd2","Kctd10")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24_vs_0 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(141.86371146874015,1008.5590780354403,118.47728708290909,420.61480651001085,588.3653401328567,391.74083128036636,343.1298897243777,301.9150139759642,52.646399472699095,114.58516806308631,1048.1245677068641,872.0588049604818,399.4040575535908,1073.353966829298,480.3080135235013,456.1056112137845,305.17926232721095,288.28338295844463,381.1219955256662,529.7778798096825,422.28644566736773,399.3050999420719,689.9992404350836,391.46268766612656,629.4462174959469),c(181.5541127383877,1227.397368552564,630.2503106678463,366.75559348128996,502.0132130984324,950.0840850592793,352.37867381398354,966.1280447230855,567.8290228841116,1142.8362814713082,742.4894876990305,818.8204772285865,365.0802713575791,81.43605967237211,2588.067451510128,432.4354597336281,328.26004687296637,261.0987657057843,340.3972661650607,844.279569045235,567.7406658416833,217.2320197798064,838.9464448920849,363.1641801239969,376.2741226359535),c(223.20938535801776,663.6509027638864,1071.1812450691882,264.16661628372634,485.91366399031944,960.2153134544612,587.2977896899725,2576.990732194843,5945.282683309805,682.9879096391855,384.69268736986,822.5696552378749,1275.1806629184957,779.6501450600872,931.7042825436462,534.3991891866099,670.8814707966251,526.6229342201411,315.04035920468374,1214.4338205734985,902.4417746298933,763.4512602666028,858.4201076656151,663.4427879321502,587.6379816475077),c(81.3456738892776,325.8787587048474,306.5752480186616,65.40047296344682,48.29864732433898,995.1117668156433,46.243920448029336,652.5259979480517,266.99245446868827,241.23193276439224,233.09768768597448,421.4076082440161,464.9312857459768,137.50678928285782,339.4798386845718,334.1132920468242,142.58795786044476,163.73990391718675,272.77884760405544,234.68987509484305,448.87485150568347,349.07804334558483,135.78932420461598,244.4676623778421,191.62108097201337))
targetgene="Setd5"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(24.757379009780138,73.73898919598737,170.9981463052296,2.5647244299390906,74.6433640467057,118.19766461045536,604.8704794602237,434.3680523654195,244.4297118375315,28.64629201577158,389.5828486499853,107.97632666750592,864.3353432995676,313.7290823443844,172.53783010067522,91.039044154448,50.26481967742298,51.2082324991974,22.28334248033129,229.94430776755763,267.44808225599957,195.8855207262994,367.8943318566922,295.56218988446506,49.937615041191364),c(124.1798693188972,1137.0076398607087,955.1467886477825,647.5929185596203,180.02223093617255,488.55034705654884,810.193486249474,342.81962877270774,3271.5976815177296,568.4027415760992,1301.597927393361,554.8783453746831,335.95705882762974,218.94284895522995,97.92687654362648,474.31342004467416,731.9173232620673,257.3055632984363,222.83342480331288,327.87556079426605,584.1629165065253,408.0948348464571,492.10472143920913,566.7562204965407,333.3045469028354),c(249.53866144778394,2539.237773119888,2040.9850176859904,747.6171713272449,714.2345422508309,1240.512632387827,2203.9852485530782,1920.5690566471014,323.3993110465801,2852.567604938938,2649.6523869479124,3542.9732187775376,775.9255909765071,1177.4853218202002,958.7507532080764,1022.3684658544512,818.5984918894599,589.2107739413824,585.5140334487049,2050.516500598877,932.1582282138933,1121.3190385165728,2136.3134377772726,1089.4925403719908,2262.2900953544367),c(125.75176639888325,397.23907082999654,108.70596443689595,211.58976546997496,139.04156047915765,1159.4628052263718,84.16393521541339,175.30549198604373,56.40685657789189,557.8488445176571,698.4780361779025,353.92240407682493,1200.2924021271974,818.3656488387559,223.83286067114625,146.5728610886613,345.1859555398537,284.49018055109667,96.8172811214394,214.41336015098713,198.63103185094704,616.5371197218783,459.4731784132936,416.616916592464,802.4858603130984))
targetgene="Arl15"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(263.2927608976618,1927.917765914444,499.55887027742074,357.7790579765031,1083.0605763639649,1614.2423909656475,763.9495658014446,362.29801677115705,1842.6239815444683,2222.3491805919634,1119.0319062686817,807.5729432007213,880.9771790309672,352.4445861230531,1045.4859867181456,628.1694046656913,620.103744795963,542.4279442507576,447.97202296666006,666.9679170893885,758.5515783284199,345.31101410084835,903.6832157338204,812.0099525283308,1253.0857355684996),c(251.896507067763,132.01657743152577,412.8383817940543,1577.3055244125408,330.77255440304873,762.0935137264598,835.1652032914099,309.7063691753439,112.81371315578377,183.93934873284908,242.06298336620426,763.3326426911182,629.269413593548,1174.8152870768436,323.6250110536989,354.1418817608028,325.1826089335323,501.96711857237943,224.37020704333574,503.4615519038269,351.12335945305205,155.7038754491098,246.31551832465226,503.084578526749,299.6256902471482),c(94.70679906915895,472.16739856140305,91.606149806373,156.4481902262845,74.6433640467057,897.1765589955517,34.22050113154171,66.22651919472763,225.62742631156755,91.96967436642454,776.7206166599079,165.71366801054728,12.481376798549713,348.4395340080184,490.56701963759554,325.0093876313794,217.47228105334023,103.04866539961947,212.07594912315295,169.54617814756125,235.38559286273647,175.7946980877046,156.84193260843242,398.53731455165894,196.26644051072884),c(43.22716969961611,432.91922689257103,86.72048848336644,456.5209485291581,35.126288963155616,280.2973189333656,3172.3329427348126,853.1533943320795,71.44868499866305,2225.3645797515182,728.6340307386754,106.47665546379055,625.1089546606981,2.670034743356463,240.6203252214822,140.20012799784993,184.6462763660436,104.94526660329343,96.8172811214394,317.5215957165524,102.44356367115773,120.54493583156886,125.78933521280318,187.87064729358283,408.79163940696185))
targetgene="Ankrd11"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(143.4356085487262,419.8365030029604,190.54079159725583,678.3696117188895,447.86018428023414,339.9589972605478,200.69861474444733,594.0908339527037,127.85554157655494,266.86282562060893,744.1195414590724,519.6360720873722,676.0745765881094,22.695295318529933,724.658886422836,179.34691698426258,209.77868620475508,249.71915848374042,237.43285608352994,481.027960902114,442.61875601431507,280.0158405254152,288.9470503423805,238.96517480020577,444.7931758320068),c(95.49274760915196,405.56444057793055,202.75494490477223,287.24913615317814,257.5927857298079,274.6688587138201,459.66456925341157,89.6005847928668,560.3081086737261,1192.590367603964,339.866208968711,374.1679653269823,195.5415698439455,1746.2027221551266,339.4798386845718,251.26776186627652,297.9985738018648,251.6157596874144,133.70005488198774,420.6298312821176,279.9602732387364,158.21522827893415,370.5259079071692,282.19900576734824,622.4781781878737),c(190.98549521830392,652.9468559451141,1072.4026603999398,365.4732312663204,267.8379533440616,1053.6477530989164,1423.387871390343,802.5095855361113,797.216906300872,1334.3141281030446,1736.822281324516,950.0417075536805,1025.5531269475014,678.1888248125416,822.5857629664624,386.0055472148596,458.53825297567494,312.93919860620633,370.36451984550627,588.4503485833933,746.039387345683,376.70292447365273,551.5783401799905,711.393036822981,868.682233739794),c(102.56628446908914,594.6692677095756,274.818449419119,527.0508703524831,136.11436973222803,354.5929938313661,215.4966692878167,124.66168319007555,248.1901689427243,105.5389705844216,636.5359932963149,131.97106592695167,128.97422691834703,652.8234947506552,341.345112523498,190.27160228279635,227.2175011948814,160.57890191106344,168.2776552825018,317.5215957165524,247.8977838454733,538.6851819973234,271.05233319913657,346.65671739108797,292.657650939075))
targetgene="Slc23a2"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(338.7438207369917,756.4193085265802,806.1341182960824,907.912448198438,523.9671437004047,2846.8751790461106,2053.2300678925026,1326.4782226943976,778.414620774908,737.2650945111737,1926.7235443693833,2826.8802190034535,783.2063941089945,1122.7496095813926,1358.8519916577502,826.634520922388,733.4560422317843,577.8311667193385,733.8135196109097,1500.8935210569098,1068.2283051511563,1042.211424377106,1337.8932640625344,1358.3283620222223,1080.0460927513482),c(337.5648979270022,443.6232737113434,660.7856939366372,750.181895757184,775.7055479363532,684.420762696732,1151.4736191559305,654.4738367478966,274.51336867907384,863.9118592124797,674.0272297772758,534.6327841245258,1333.4270879783942,586.0726261667436,708.8040587919631,395.10945163030436,426.2251546116173,286.38678175477065,455.6559341667743,924.9542136090873,642.0317998016832,627.8382074560878,521.0520579944567,406.39801109113944,565.5725238386092),c(62.875883199441624,126.06988475443003,14.65698396901968,125.67149706701544,35.126288963155616,33.770761317272964,173.8771408845903,33.113259597363815,0.0,31.66169117532648,56.23685472144139,656.1061516254699,42.644704061711515,109.47142447761497,2.797910758389328,48.25069340185745,95.91348244569487,52.47263330164672,89.90176104133657,174.72316068641808,332.35507297894685,192.1184914815629,177.89454101224885,102.97512466719394,267.1081734761399),c(64.44778027942766,146.2886398565556,94.04898046787628,57.70629967362954,563.4842187839547,762.0935137264598,272.8391306433731,9.739193999224652,112.81371315578377,176.40085083396184,190.7162899248882,389.1646773641359,189.30088144467064,157.53204985803131,107.25324573825758,117.44036695923793,90.27151289006575,69.54204413471251,119.86901472178211,235.98412072955725,251.0258315911575,37.67029244736527,51.05257537925485,104.54726397509002,73.16441273476875))
targetgene="Calm1"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(353.67684299685914,361.558914767422,349.32478459496906,721.9699270278539,365.89884336620435,297.18269959200205,1840.5080338315674,1260.25170349967,225.62742631156755,1340.3449264221545,892.4544336228743,629.8619055604512,774.8854762432946,307.05399548599325,1053.8797189933136,654.5707274704812,470.84800473341113,568.3481607009687,508.6749214475625,452.5545569384014,707.7208024610514,792.3318178095828,740.525500604243,630.4278624663323,864.0368742010785))
targetgene="Calm2"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(67.19860016940324,170.07541056493864,184.43371494349765,178.2483478807668,30.735502842761168,146.33996570818283,41.619528403226404,196.73171878433797,165.46011262848288,81.41577730798238,312.15529504800077,165.71366801054728,170.57881624684606,177.55731043320478,102.59006114094203,141.1105184393944,130.27820610270854,103.04866539961947,61.4712896009139,89.73436400685175,161.87647083915763,111.75520092718364,196.84188857568364,158.0000004435571,145.1674855848586))
targetgene="Gm21188"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(53.05152644952887,57.08824970011926,265.0471267731059,93.6124416927768,103.91527151600204,323.07361660191134,0.0,274.64527077813517,33.844113946735135,230.6780357059501,163.00537600417795,224.950680557304,75.92837552451076,262.9984222206116,151.0871809530237,152.03520373792819,177.46558784069745,159.9467015098388,150.60465952223905,280.41988752141174,114.1737427174735,61.52814433069661,179.47348664253508,65.24378127768776,120.77934800660238),c(189.02062386832137,211.70225930460893,418.94545844781254,166.70708794604087,247.34761811555416,234.14394513309253,205.32300678925026,190.88820238480318,101.53234184020539,215.60103990817555,242.87801024622513,419.1581014384431,63.44699872596104,464.5860453440245,124.97334720805665,380.5432045655927,259.01769323570005,366.0440323090777,275.0840209640897,298.97074161898206,170.4786021397892,218.48769619471858,334.21015841058585,258.6169161489069,153.2968647776107))
targetgene="Gm10356_Ikzf5"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(117.10633245896003,278.3052172880814,434.8238577475838,110.2831504873809,114.16043913025577,401.87205967554826,78.61466476164988,87.65274599302187,225.62742631156755,321.1400104925972,308.0801606478963,114.72484708422503,158.09743944829637,218.94284895522995,289.1174450335639,224.8664390614866,150.79445903226895,116.95707422656196,116.7954502417364,97.499837815137,100.09752786189458,223.51040185436727,148.94720445700128,105.33333362903807,204.39581970348092),c(137.93396876877506,324.6894201694283,775.5987350272914,501.4036260530922,482.98647324338975,1630.002079580375,353.3035522229441,146.08790998836977,767.1332494593297,1264.9599474332817,414.03365505061197,770.0811631078373,526.2980550055129,521.9917923261885,331.08610640940384,143.84168976402785,123.6104239006014,49.943831696748084,122.9425792018278,110.01087895070768,98.53350398905248,86.64167262894013,285.2628438717127,229.53233895282924,257.8174543987089),c(112.3906412190019,147.47797839197474,203.97636023552388,420.61480651001085,424.4426583047971,336.5819211288205,61.041974991398725,249.3233663801511,86.49051341943422,16.584695377551967,181.75099424465841,314.1811171783679,458.69059734670196,104.13135499090205,108.18588265772068,116.52997651769346,100.52963935484595,92.93345898002491,72.22876528107383,258.8491269428416,73.50912202357883,138.12440564033932,109.99987890994086,68.38805989347993,214.84787866559077),c(185.48385543835278,325.8787587048474,554.5225601612445,292.3785850130563,266.3743579705968,336.5819211288205,96.18735453190102,99.33977879209145,199.304226575218,52.7694852922108,238.80287584612068,179.21070884398551,229.86535603995722,102.79633761922382,379.5832262214855,111.06763386842657,168.7461803456343,125.8078798437072,92.20693440137084,177.7430671674179,86.02131300631565,236.06716600348904,128.42091126328023,290.0597023068287,199.75046016476546))
targetgene="Nudcd2"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(36.153632839678934,8.325369747934058,96.49181112937956,61.55338631853817,462.4961380148823,83.30121124927331,40.694649994265816,0.0,150.4182842077117,10.55389705844216,60.31198912154584,46.48980731517616,126.89399745192208,9.34512160174762,6.528458436241765,86.48709194672561,55.39388290981308,29.713418857558985,106.03797456157648,28.041988752141172,18.76828647410523,25.113528298243516,27.368390924961364,14.149253771064815,75.48709250412648),c(117.10633245896003,186.72615006080676,244.283066150328,179.53071009573634,550.3118604227714,209.37872016709235,825.9164192018039,181.14900838557853,109.05325605059097,256.3089285621668,184.19607488472107,43.490464907745434,65.52722819238599,109.47142447761497,184.66211005369564,183.89886919198497,165.1558360829612,221.9023408298554,239.73802944356422,139.77852854913448,170.4786021397892,51.482733011399205,68.42097731240341,153.28358251986884,138.1994462767854),c(59.73208903946954,57.08824970011926,21.98547595352952,109.00078827241134,51.22583807126861,120.44904869827356,837.014960109331,247.37552758030617,120.33462736616936,90.46197478664709,45.64150528116983,536.1324553282411,88.40975232306046,499.29649700765856,62.486673604028326,229.418391269209,188.74952695195566,152.99249709636754,226.67538040337,130.718809106135,136.85208887368398,62.783820745608786,201.57872546654235,81.75124401059671,178.84634224054582),c(57.76721768948699,137.96327010862154,79.3919964988566,125.67149706701544,229.78447363397635,621.3820082378224,354.2284306319047,83.757068393332,274.51336867907384,91.96967436642454,336.60610144862744,256.44377583532656,125.8538827187096,234.96305741536872,116.57961493288867,134.73778534858306,147.20411476959586,166.26870552208538,156.75178848233045,218.72751226670115,141.5441604922103,173.28334525788026,305.7891370654337,113.98009982246657,146.3288254695375))
targetgene="Kctd10"
collabel=c("In.vivo.input.Pool.F..41.47._1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1911_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._BM_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._BM_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1916_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1917_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1919_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1920_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1922_Pool.F..41.48._BM_mCD19_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1910_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1912_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1913_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1914_Pool.F..41.48._SP_hEGFRv3_15m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1925_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1926_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1927_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1928_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1929_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446","In.vivo_AR1924_Pool.F..41.48._SP_mCD19_10m_1439..1440..1441..1442..1443..1444..1445..1446")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("invivo.poolF_all_v_input_summary.Rnw");
library(tools);

texi2dvi("invivo.poolF_all_v_input_summary.tex",pdf=TRUE);

