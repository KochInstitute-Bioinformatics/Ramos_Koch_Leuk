pdf(file='invivo.poolA_all_v_input.pdf',width=4.5,height=4.5);
gstable=read.table('invivo.poolA_all_v_input.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Myh9","Uqcr10","H2ac11_H2ac23_H2ac24_H2ac6","Cox17","Elavl1","Hscb","Rpl7","Ndufa6","Actb","Aldoa")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21_vs_0 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(34.0610825618808,0.6588525634914374,2.390771524325636,20.256390462688955,8.926948392275019,0.0,82.87061134692281,5.153549716056344,8.84097161742452,0.0,0.0,0.0,0.0,2.24351501955771,32.185360836707446,4.263431569085298,0.0,8.757811605004644,116.64883103281409,3.6827167384557313,36.22048886359336,0.8926026852316816),c(38.650873829084595,6.753238775787233,7.1723145729769096,0.0,0.0,28.266234656989777,0.0,0.0,46.28508670298719,2.845866491874259,10.500428793410185,3.2411679359604237,4.276164369182997,12.114981105611633,2.8081187307194413,2.5580589414511787,8.134460988940354,4.378905802502322,5.690186879649468,0.0,5.795278218174937,0.0),c(54.83592724501377,9.223935888880124,5.464620627030026,28.358946647764533,0.0,33.91948158838773,4.690789321523933,8.589249526760574,28.083086314172007,4.268799737811388,0.0,11.344087775861484,14.966575292140488,21.836879523695043,22.896968112020062,12.790294707255894,0.0,8.757811605004644,0.0,1.8413583692278657,184.00008342705425,11.60383490801186),c(31.645402947563014,1.6471314087285935,1.02461636756813,4.051278092537791,0.0,0.0,3.1271928810159553,1.7178499053521146,5.720628693627631,15.652265705308425,0.0,12.964671743841695,0.0,4.038327035203878,4.752200928909824,2.5580589414511787,0.0,4.378905802502322,3.7934579197663116,0.0,1.4488195545437343,52.66355842866922))
targetgene="Myh9"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(45.4147767491744,1.8118445496014528,0.0,4.051278092537791,26.780845176825057,0.0,0.0,0.0,0.0,136.60159160996443,304.51243500889535,36.46313927955477,79.10904082988544,4.337462371144905,4.104173529513029,24.72790310069473,0.0,4.378905802502322,0.0,6.137861230759553,26.078751981787217,0.0),c(36.959898099062144,3.6236890992029056,1.3661551567575065,64.82044948060465,0.0,5.653246931397955,0.0,0.8589249526760573,6.240685847593779,86.7989280021649,0.0,69.68511062314911,0.0,6.73054505867313,50.33012801981768,8.526863138170595,0.0,8.757811605004644,79.66261631509255,87.7714155998616,11.590556436349875,7.140821481853453),c(52.90338355355954,7.247378198405811,81.28623182707165,28.358946647764533,0.0,73.49221010817342,0.0,0.8589249526760573,3.640400077763038,89.64479449403916,0.0,13.774963727831802,0.0,21.986447191665558,54.00228328306618,35.8128251803165,8.134460988940354,8.757811605004644,0.0,0.6137861230759553,8.692917327262407,6.248218796621772),c(24.88150002747321,5.435533648804358,0.0,4.051278092537791,8.926948392275019,14.133117328494889,4.690789321523933,0.8589249526760573,3.1203429237968896,0.0,1.1667143103789095,2.430875951970318,12.82849310754899,21.089041183842472,5.616237461438883,1.7053726276341192,0.0,8.757811605004644,43.624766077312586,4.296502861531687,21.732293318156014,0.0))
targetgene="Uqcr10"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(21.499548567428306,26.848241962276074,11.27078004324943,32.410224740302326,0.0,62.185716245377506,0.0,0.0,2.6002857698307413,31.30453141061685,198.3414327644146,3.2411679359604237,4.276164369182997,68.05328892658386,27.00114164153309,5.1161178829023575,40.67230494470177,30.652340617516252,0.0,20.254942061506522,0.0,9.818629537548498),c(17.15132526165629,2.964836535711468,7.855392151355662,0.0,8.926948392275019,11.30649386279591,1.5635964405079776,0.0,6.240685847593779,0.0,1.1667143103789095,12.154379759851588,19.242739661323483,9.572330750112895,5.184219195174354,7.674176824353537,16.26892197788071,4.378905802502322,47.4182239970789,1.2275722461519105,13.039375990893609,0.0),c(9.179582534407592,0.0,0.0,0.0,0.0,0.0,0.0,6.012474668732401,0.5200571539661483,0.0,214.67543310971934,0.8102919839901059,0.0,0.0,0.0,4.263431569085298,0.0,0.0,4.74182239970789,4.910288984607642,4.3464586636312035,0.0),c(15.460349531633838,13.177051269828748,56.01236142705777,8.102556185075581,0.0,8.479870397096933,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.021033754024437,11.016465789745501,0.0,32.53784395576142,13.136717407506966,3.7934579197663116,0.0,21.732293318156014,0.0),c(29.954427217540562,2.305983972220031,17.076939459468832,28.358946647764533,80.34253553047517,19.786364259892842,0.0,232.76866217521152,11.96131454122141,11.383465967497036,0.0,4.861751903940636,0.0,13.610657785316773,29.80926037225253,23.02253047306061,24.403382966821063,4.378905802502322,0.0,22.710086553810346,7.244097772718671,45.52273694681576),c(6.280766997226246,0.0,0.34153878918937663,0.0,0.0,0.0,21.890350167111688,2.576774858028172,0.0,0.0,0.0,0.0,0.0,0.0,0.6480273993967942,5.968804196719417,0.0,0.0,0.0,2.455144492303821,0.0,0.0),c(15.943485454497395,5.270820507931499,0.0,0.0,0.0,2.8266234656989777,0.0,0.8589249526760573,0.0,0.0,1.1667143103789095,0.8102919839901059,4.276164369182997,9.871466086053923,4.536191795777559,5.1161178829023575,8.134460988940354,8.757811605004644,1.8967289598831558,0.0,14.488195545437343,0.0))
targetgene="H2ac11_H2ac23_H2ac24_H2ac6"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(44.93164082631084,5.764959930550077,0.6830775783787533,12.153834277613372,0.0,8.479870397096933,0.0,0.0,0.0,8.537599475622777,1.1667143103789095,4.0514599199505295,4.276164369182997,9.572330750112895,12.312520588539089,0.0,0.0,0.0,0.0,7.365433476911463,0.0,9.818629537548498),c(32.853242754721904,0.8235657043642968,0.6830775783787533,16.205112370151163,0.0,0.0,0.0,0.0,66.04725855370083,0.0,2.333428620757819,1.6205839679802119,0.0,0.299135335941028,5.8322465945711475,8.526863138170595,0.0,4.378905802502322,0.0,0.0,14.488195545437343,2.6778080556950448),c(32.37010683185835,3.6236890992029056,4.09846547027252,4.051278092537791,44.6347419613751,8.479870397096933,0.0,14.601724195492974,0.0,12.806399213434165,1.1667143103789095,92.37328617487208,0.0,5.683571382879531,15.984675851787589,1.7053726276341192,8.134460988940354,4.378905802502322,0.0,0.0,0.0,1.7852053704633633),c(93.00366515123481,6.588525634914374,8.19693094054504,32.410224740302326,0.0,19.786364259892842,4.690789321523933,4.294624763380287,109.73205948685728,2.845866491874259,37.334857932125104,50.23810300738657,10.690410922957492,11.96541343764112,45.36191795777559,47.75043357375534,0.0,17.515623210009288,42.676401597371004,8.593005723063374,30.42521064541842,28.563285927413812))
targetgene="Cox17"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(89.62171369118991,12.024059283718733,5.806159416219403,12.153834277613372,0.0,2.8266234656989777,0.0,36.93377296507046,9.361028771390668,0.0,8.167000172652367,2.430875951970318,6.414246553774495,5.23486837896799,3.6721552632485004,12.790294707255894,0.0,17.515623210009288,2.845093439824734,0.0,1.4488195545437343,13.389040278475225),c(40.10028159767527,3.6236890992029056,3.4153878918937663,4.051278092537791,8.926948392275019,2.8266234656989777,0.0,0.0,8.84097161742452,12.806399213434165,22.16757189719928,34.03226332758445,173.18465695191136,7.029680394614157,11.448484056010031,12.790294707255894,0.0,0.0,9.48364479941578,14.730866953822925,1.4488195545437343,24.100272501255404),c(83.58251465539544,5.435533648804358,227.80637238931422,48.61533711045349,26.780845176825057,2.8266234656989777,1.5635964405079776,0.0,0.0,509.4101020454924,0.0,5.672043887930742,4.276164369182997,4.786165375056448,49.250082354156355,43.48700200467004,8.134460988940354,4.378905802502322,3.7934579197663116,10.43436409229124,1.4488195545437343,0.8926026852316816),c(66.67275735517093,5.435533648804358,8.880008518923793,8.102556185075581,8.926948392275019,16.959740794193866,0.0,24.90882362760566,2.080228615864593,8.537599475622777,11.667143103789094,64.82335871920847,128.2849310754899,18.695958496314248,26.137105109004032,16.20103996252413,8.134460988940354,8.757811605004644,0.0,37.44095350763327,0.0,21.422464445560358))
targetgene="Elavl1"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(40.82498548197061,0.494139422618578,0.0,0.0,0.0,0.0,0.0,4.294624763380287,0.0,8.537599475622777,5.833571551894547,8.913211823891166,0.0,0.299135335941028,0.0,35.8128251803165,16.26892197788071,0.0,0.0,3.0689306153797764,78.23625594536165,2.6778080556950448),c(38.89244179051637,2.1412708313471716,820.7177104220721,36.46150283284012,0.0,8.479870397096933,7.817982202539888,0.8589249526760573,14.561600311052151,7.114666229685648,8.167000172652367,4.861751903940636,21.380821845914983,2.393082687528224,63.50668514088583,19.61178521779237,8.134460988940354,4.378905802502322,3.7934579197663116,1.2275722461519105,11.590556436349875,0.0),c(39.858713636243486,2.800123394838609,0.0,0.0,8.926948392275019,8.479870397096933,4.690789321523933,41.22839772845075,18.722057542781336,18.498132197182684,3.5001429311367285,38.89401523152509,14.966575292140488,6.580977390702616,0.0,36.66551149413356,8.134460988940354,4.378905802502322,55.00513983661152,15.344653076898881,13.039375990893609,12.496437593243543),c(17.15132526165629,1.6471314087285935,0.0,0.0,0.0,0.0,31.27192881015955,3.435699810704229,2.080228615864593,21.343998689056942,15.167286034925823,0.0,2.1380821845914983,0.0,0.0,5.1161178829023575,8.134460988940354,0.0,12.328738239240513,3.0689306153797764,7.244097772718671,7.140821481853453))
targetgene="Hscb"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3.8650873829084595,8.070943902770107,3.4153878918937663,16.205112370151163,0.0,0.0,0.0,37.79269791774652,1.5601714618984448,0.0,0.0,0.0,0.0,3.7391916992628498,13.608575387332678,0.0,8.134460988940354,8.757811605004644,0.0,0.0,0.0,5.3556161113900895),c(9.42115049583937,0.0,2.390771524325636,4.051278092537791,0.0,2.8266234656989777,0.0,0.0,0.0,2.845866491874259,0.0,0.0,0.0,0.0,2.160091331322647,1.7053726276341192,0.0,0.0,0.0,1.2275722461519105,0.0,5.3556161113900895),c(2.657247575749566,0.3294262817457187,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.49567667970514,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0),c(20.533276721701192,2.47069711309289,7.1723145729769096,36.46150283284012,0.0,0.0,10.945175083555844,0.8589249526760573,0.0,22.766931934994073,33.834715000988375,32.411679359604236,220.22246501292432,2.8417856914397657,35.20948870055915,26.433275728328848,0.0,17.515623210009288,0.9483644799415779,17.18601144612675,4.3464586636312035,41.05972352065736))
targetgene="Rpl7"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(39.61714567481171,109.04009925783289,35.86157286488454,8.102556185075581,0.0,28.266234656989777,0.0,9.44817447943663,2.6002857698307413,1.4229332459371296,4.666857241515638,4.0514599199505295,17.104657476731987,40.08413501609775,22.46494984575553,0.0,97.61353186728425,113.85155086506037,1.8967289598831558,3.0689306153797764,0.0,2.6778080556950448),c(46.13948063346974,23.389266003946027,35.52003407569517,0.0,8.926948392275019,22.61298772559182,0.0,0.8589249526760573,3.1203429237968896,1.4229332459371296,9.333714483031276,16.205839679802118,29.933150584280977,11.217575097788549,9.504401857819648,19.61178521779237,24.403382966821063,26.273434815013932,18.01892511888998,6.751647353835508,18.834654209068546,0.8926026852316816),c(64.98178162514847,6.423812494041514,44.40004259461896,32.410224740302326,8.926948392275019,16.959740794193866,0.0,21.47312381690143,171.61886080882894,8.537599475622777,7.000285862273457,9.723503807881272,59.866301168561954,15.555037468933454,15.768666718655325,27.285962042145908,8.134460988940354,13.136717407506966,17.070560638948404,3.0689306153797764,2.8976391090874687,8.926026852316816),c(17.634461184519846,8.894509607134404,0.34153878918937663,4.051278092537791,0.0,2.8266234656989777,7.817982202539888,0.8589249526760573,0.5200571539661483,2.845866491874259,0.0,0.0,0.0,14.508063793139858,0.43201826626452944,20.46447153160943,0.0,0.0,2.845093439824734,9.820577969215284,0.0,7.140821481853453))
targetgene="Ndufa6"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(33.09481071615369,1.6471314087285935,2.04923273513626,8.102556185075581,98.1964323150252,0.0,6.2543857620319105,2.576774858028172,1.5601714618984448,19.921065443119815,3.5001429311367285,168.54073266994203,23.518904030506484,2.8417856914397657,8.640365325290588,34.10745255268238,0.0,0.0,0.0,11.66193633844315,0.0,18.744656389865312),c(57.010038897899776,19.76557690474312,13.320012778385689,20.256390462688955,17.853896784550038,11.30649386279591,6.2543857620319105,0.8589249526760573,14.041543157086004,45.533863869988146,12.833857414168005,2.430875951970318,12.82849310754899,14.358496125169342,13.392566254200412,18.75909890397531,32.53784395576142,30.652340617516252,31.29602783807207,1.2275722461519105,17.385834654524814,8.033424167085135),c(56.04376705217266,5.10610736705864,11.953857621628183,0.0,44.6347419613751,16.959740794193866,0.0,1.7178499053521146,13.001428849153706,0.0,1.1667143103789095,0.0,12.82849310754899,15.255902132992427,8.640365325290588,20.46447153160943,0.0,4.378905802502322,129.92593375199618,0.0,68.09451906355551,6.248218796621772),c(56.04376705217266,7.741517621024389,2.04923273513626,8.102556185075581,8.926948392275019,19.786364259892842,1.5635964405079776,36.93377296507046,35.36388646969808,1.4229332459371296,21.00085758682037,28.360219439653708,158.2180816597709,25.576071222957893,4.752200928909824,11.937608393438834,0.0,4.378905802502322,165.96378398977615,11.66193633844315,52.157503963574435,6.248218796621772))
targetgene="Actb"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(18.359165068815184,0.16471314087285935,0.0,0.0,0.0,0.0,0.0,1.7178499053521146,0.0,4.268799737811388,1.1667143103789095,0.0,2.1380821845914983,0.0,0.43201826626452944,5.968804196719417,8.134460988940354,0.0,0.0,20.254942061506522,0.0,2.6778080556950448),c(29.712859256108782,3.294262817457187,6.14769820540878,40.51278092537791,26.780845176825057,2.8266234656989777,25.017543048127642,1.7178499053521146,100.89108786943277,19.921065443119815,5.833571551894547,20.25729959975265,117.59452015253241,6.8801127266436435,11.232474922877765,24.72790310069473,8.134460988940354,4.378905802502322,19.915654078773137,122.1434384921151,162.26779010889825,56.233969169595944),c(6.763902920089804,0.0,0.0,0.0,0.0,0.0,0.0,91.90496993633813,5.720628693627631,1.4229332459371296,0.0,2.430875951970318,14.966575292140488,0.598270671882056,0.0,0.0,0.0,0.0,0.0,20.86872818458248,0.0,14.281642963706906),c(18.60073303024696,0.0,0.6830775783787533,8.102556185075581,0.0,11.30649386279591,1.5635964405079776,37.79269791774652,1.0401143079322965,8.537599475622777,0.0,14.585255711821906,0.0,0.299135335941028,6.480273993967941,2.5580589414511787,0.0,0.0,0.0,90.84034621524138,0.0,20.52986176032868))
targetgene="Aldoa"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Cd19","Cd8a","Ncor1","Atp2b1","Sipa1","H2ac4","Stim1","Smad4","Cd3e","Tk2")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21_vs_0 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(54.83592724501377,42.16656406345199,47.47389169732335,28.358946647764533,169.61201945322537,22.61298772559182,173.55920489638552,92.76389488901418,2019.9019860045198,1782.9353571592233,7921.990167472795,204.1935799655067,324.98849205790776,36.3449433168349,13.176557121068148,69.92027773299888,56.94122692258248,35.031246420018576,16480.67793242474,1862.2270974124483,30002.15533549165,502.53531178543676),c(78.26801950389631,211.1622465990057,89.82470155680606,56.717893295529066,17.853896784550038,53.705845848280575,2680.004299030674,580.6332680090147,1162.8477962683075,11586.945421666045,52637.48282705488,3506.1334147251882,1255.0542423552095,78.97172868843138,73.44310526497,79.29982718498654,203.36152472350886,153.26170308758128,13089.326552153658,3952.168846486076,11519.564278177231,335.6186096471123),c(118.60986906300336,156.8069101109621,177.94170916766524,113.43578659105813,124.97727749185026,59.359092779678534,16008.100357920675,4760.16208773071,3021.0120073893554,8551.82880808215,9619.559489074109,531.5515414975094,1009.1747911271872,103.6503939035662,100.22823777337084,77.59445455735242,162.6892197788071,131.36717407506967,23748.943306696994,9729.123836876966,51289.66105040274,1523.6727836904806),c(164.99091765790487,143.7945719820062,217.9017475028223,247.12796364480522,133.90422588412528,226.12987725591822,7394.247567162226,2207.437128377467,6452.869166411968,21112.06056996919,13431.215141082006,2036.2637557671362,600.801093870211,155.40080702136405,197.8643659491545,234.4887362996914,113.88245384516496,188.29294950759984,64247.90005812213,25978.497659189805,79375.02811523303,1541.5248373951142))
targetgene="Cd19"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(358.7284227261914,448.84330887854173,1218.9519386168852,563.1276548627529,89.2694839227502,489.0058595659231,3480.565676570758,318.6611574428172,255.3480625973788,1095.6585993715898,1278.7188841752848,679.8349745676989,519.5539708557341,543.8280407407889,580.8485589926598,286.502601442532,488.06765933642123,280.2499713601486,753.9497615535545,519.2630601222581,863.4964545080657,604.2920179018485),c(232.38837889737113,140.82973544629473,148.22783450818946,267.3843541074942,133.90422588412528,327.8883220210814,2631.5328093749263,536.8280954225359,616.7877846038518,1539.6137721039743,675.5275857093886,364.6313927955477,938.6180790356677,278.9437007650086,302.62879551830287,156.0415954285219,122.01691483410531,179.5351379025952,219.0721948665045,375.02332119940866,402.7718361631581,456.1199721533893),c(480.2371073263761,748.6212252671457,637.3113806273768,506.4097615672238,812.3523036970267,443.7798841147395,1876.3157286095732,918.1907744107052,631.349384914904,586.2484973260973,1579.7311762530435,1231.643815664961,857.3709560211909,472.9329661227652,441.9546863886136,624.1663817140876,561.2778082368844,564.8788485227996,621.1787343617335,615.6274814451831,930.1421540170775,455.22736946815763),c(89.62171369118991,164.38371459111363,364.4218880650649,170.1536798865872,62.48863874592513,144.15779675064786,1494.7981971256265,3300.8485931340883,1354.7488860818162,6558.29933052423,6000.411698278732,3547.458305908684,446.8591765796232,119.65413437641119,128.95745247996203,100.61698503041303,244.03382966821061,201.42966691510682,8043.079154384523,1328.8469564594432,4728.947026030749,1166.631709597808))
targetgene="Cd8a"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(159.19328658354218,478.985813658275,421.4588658596908,226.87157318211626,2071.0520270078046,395.7272851978569,1738.719241844871,726.6505099639445,696.8765863146386,3520.3368504484583,511.0208679459624,553.4294250652423,342.09314953463974,474.27907513449986,237.82605557862345,203.79202900227725,455.52981538065984,420.3749570402229,719.8086402756576,2159.9133671042864,398.4253774995269,357.93367677790434),c(280.70197118372687,328.6027160413544,1157.133417773608,522.614873937375,1428.3117427640032,607.7240451252802,4947.219137767242,1104.5774891414096,2549.840225896025,2475.9038479306055,3412.63935785831,1022.5884837955136,4023.8706714012,532.3113303070593,490.5567413433732,690.6759141918183,333.51290054655453,394.10152222520895,4001.149740873517,1999.7151889814622,1527.055810489096,601.6142098461535),c(43.72380101915195,75.93275794238816,58.06159416219403,76.97428375821802,687.3750262051765,288.3155935012957,115.70613659759034,76.4443207881691,311.5142352257228,45.533863869988146,86.33685896803931,176.6436525098431,81.24712301447694,112.77402164976755,38.44962569754312,91.23743557842538,32.53784395576142,87.57811605004645,369.8621471772154,358.4510958763579,169.51188788161693,100.86410343118003),c(28.02188352608633,13.671190692447325,0.34153878918937663,12.153834277613372,0.0,25.4396111912908,1.5635964405079776,441.48742567549345,34.32377216176579,14.229332459371296,261.34400552487574,376.78577255539926,1879.3742402559271,36.04580798089387,9.072383591555118,34.10745255268238,24.403382966821063,8.757811605004644,1.8967289598831558,25.165231046114165,150.67723367254837,83.90465241177807))
targetgene="Ncor1"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(37.20146606049392,22.071560876963154,21.51694371893073,36.46150283284012,44.6347419613751,2.8266234656989777,0.0,8.589249526760574,1.0401143079322965,19.921065443119815,127.17185983130113,166.92014870196184,848.8186272828249,11.068007429818035,23.112977245152326,51.16117882902358,24.403382966821063,17.515623210009288,0.0,9.820577969215284,0.0,27.67068324218213),c(70.77941269951117,21.412708313471715,311.4833757407115,105.33323040598256,8.926948392275019,53.705845848280575,7.817982202539888,25.76774858028172,237.14606220856362,35.57333114842824,350.01429311367286,60.77189879925795,369.8882179343292,49.656465766210644,118.80502322274559,45.19237463230416,8.134460988940354,17.515623210009288,37.93457919766312,14.730866953822925,15.937015099981078,59.80437991052267),c(86.96446611544035,410.79457333691124,99.04624886491922,133.6921770537471,169.61201945322537,45.22597545118364,550.3859470588081,37.79269791774652,104.01143079322965,12.806399213434165,56.002286898187656,8.102919839901059,19.242739661323483,63.71582655543896,124.20525155105221,192.70710692265547,325.3784395576142,367.82808741019505,98.6299059139241,105.57121316906431,194.1418203088604,34.811504724035586),c(150.25527201056636,539.1061100768686,395.16037909210877,640.1019386209709,1178.3571877803024,432.4733902519436,2848.8727146055353,2404.9898674929605,273.03000583222786,1045.8559357637903,532.0217255327827,1332.1200216797342,2324.0953346509586,440.92548517707525,651.4835455269103,555.0987902949058,601.9501131815862,503.574167287767,782.4006959518018,1167.421206090467,463.62225745399496,714.9747508705769))
targetgene="Atp2b1"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(104.11579137709663,306.53115516439124,394.47730151373,947.999073653843,874.8409424429518,308.10195776118854,40.65350745320742,759.2896581656346,787.8865882587146,307.35358112242,3396.3053575130057,34.84255531157456,6.414246553774495,283.43073080412404,1005.9545329969568,377.7400370209574,341.6473615354949,297.7655945701579,5.690186879649468,48.48910372300047,7923.5941437996835,458.79778020908435),c(296.88702459965606,1735.7470785181918,394.8188403029194,761.6402813971047,1231.9188781339526,1455.7110848349735,1341.5657459558447,328.9682568749299,346.8781216954209,5639.084453648845,236.84300500691862,974.7812567400974,1227.25917395552,1285.9828092104792,665.5241391805076,1628.630859390584,1838.38818350052,1839.1404370509752,312.0119139007791,372.56817670710484,492.59864854486966,493.60928493311997),c(5.797631074362689,137.86489891058326,53.96312869192151,12.153834277613372,0.0,302.4487108297906,6.2543857620319105,0.0,14.561600311052151,39.84213088623963,2.333428620757819,6.4823358719208475,0.0,441.97245885286884,13.824584520464942,8.526863138170595,138.28583681198603,131.36717407506967,0.0,7.9792195999874185,8.692917327262407,104.43451417210674),c(46.864184517765075,46.77853200789205,962.114769146474,247.12796364480522,17.853896784550038,132.85130288785194,10.945175083555844,13.742799242816917,97.25068779166972,149.4079908233986,11.667143103789094,38.08372324753498,143.25150636763038,140.59360789228316,195.9202837509641,167.97920382196074,65.07568791152283,61.304681235032504,95.78481247409937,15.344653076898881,84.03153416353659,362.39669020406274))
targetgene="Sipa1"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(35.027354407607916,224.33929786883442,136.95705446494003,64.82044948060465,187.4659162377754,296.79546389839265,384.6447243649625,23.190973722253545,31.723486391935044,155.09972380714711,176.17386086721532,197.71124409358586,1024.1413664193276,294.3491705659715,59.402511611372795,54.571924084291815,219.63044670138956,166.39842049508823,120.4422889525804,33.758236769177536,91.27563193625527,5.3556161113900895),c(13.527805840179608,3.294262817457187,0.0,4.051278092537791,0.0,2.8266234656989777,0.0,0.0,0.0,0.0,0.0,0.0,0.0,11.815845769670606,0.6480273993967942,5.1161178829023575,0.0,4.378905802502322,0.0,6.137861230759553,0.0,0.0),c(6.522334958658026,0.0,9.22154730811317,16.205112370151163,0.0,0.0,0.0,0.0,0.0,2.845866491874259,0.0,5.672043887930742,0.0,0.0,23.112977245152326,5.968804196719417,0.0,0.0,0.9483644799415779,0.0,0.0,5.3556161113900895),c(155.32819920063372,127.32325789472027,43.37542622705083,89.12811803583139,116.05032909957525,81.97208050527036,37.52631457219147,11.166024384788745,85.28937325044832,159.36852354495852,110.8378594859964,221.2097116292989,38.48547932264697,85.552706079134,60.698566410166386,150.07279123180248,146.4202978009264,140.1249856800743,18.01892511888998,96.36442132292497,85.48035371808032,26.77808055695045))
targetgene="H2ac4"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(51.93711170783242,39.53115380948624,33.129262551369536,28.358946647764533,62.48863874592513,81.97208050527036,7.817982202539888,23.190973722253545,1.5601714618984448,93.91359423185055,2.333428620757819,731.6936615430657,6.414246553774495,59.079228848353026,30.67329690478159,31.549393611231206,8.134460988940354,43.78905802502322,3.7934579197663116,3.0689306153797764,2.8976391090874687,35.704107409267266),c(93.00366515123481,74.61505281540528,53.96312869192151,72.92300566568024,232.1006581991505,73.49221010817342,48.471489655747305,58.406896781971895,22.882514774510526,21.343998689056942,324.3465782853368,145.85255711821907,538.7967105170576,68.20285659455438,64.37072167341489,63.09878722246241,113.88245384516496,91.95702185254876,19.915654078773137,23.937658799962254,24.629932427243485,17.852053704633633),c(133.8286506332054,741.8679864913585,692.2991256868664,388.9226968836279,401.7126776523759,228.9565007216172,62.5438576203191,677.6917876614092,168.49851788503204,1422.9332459371296,1447.8924591802268,136.9393452943279,348.5073960884142,244.99184013570192,317.9654439706937,231.07799104442316,658.8913401041686,617.4257181528274,1236.6672818438176,324.07907298410436,557.7955284993377,243.68053306824908),c(64.49864570228492,44.14312175392631,51.2308183784065,40.51278092537791,80.34253553047517,104.58506823086218,2481.4275510861603,237.92221189126786,156.01714618984448,200.63358767713527,147.0060031077426,98.85562204679293,350.6454782730057,92.73195414171867,34.77747043429462,545.7192408429181,40.67230494470177,91.95702185254876,365.1203247775075,539.5180021837647,241.95286560880365,144.60163500753242))
targetgene="Stim1"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(49.03829617065108,99.98087650982562,161.88938607576452,101.28195231344476,35.707793569100076,56.532469313979554,3.1271928810159553,4.294624763380287,88.92977332821135,44.110930624051015,24.5010005179571,59.96160681526784,44.89972587642146,91.98411580186611,121.18112368720051,120.22877024820541,89.47907087834389,113.85155086506037,86.30116767468358,30.689306153797762,18.834654209068546,83.90465241177807),c(128.51415548170627,152.52436844826775,213.4617432433604,295.7433007552587,267.80845176825056,248.74286498151002,744.2719056817973,253.3828610394369,784.7662453349177,220.55465312025507,247.34343380032882,756.0024210627688,2050.420815023247,248.73103183496477,206.9367495407096,306.1143866603244,138.28583681198603,175.1562321000929,423.91892253388534,325.30664523025627,168.06306832707318,292.77368075599156),c(44.69007286487906,31.789636188461856,22.20002129730948,12.153834277613372,1115.8685490343773,79.14545703957137,4.690789321523933,566.0315438135218,25.482800544341266,61.18612957529657,60.66914413970329,20.25729959975265,47.03780806101297,56.23744315691326,18.3607763162425,71.625650360633,24.403382966821063,56.92577543253019,75.86915839532624,122.1434384921151,147.7795945634609,74.08602287422957),c(99.28443214846105,401.90006372977683,211.41251050822413,214.7177389045029,196.3928646300504,285.48897003559676,3477.438483689742,255.100710944789,213.2234331261208,263.24265049836896,38.50157224250401,1349.9464453275166,153.94191729058787,300.63101262073315,126.7973611486394,458.7452368335781,577.5467302147651,407.23823963271593,461.8535017315484,286.6381194764711,315.8426628905341,182.98355047249473))
targetgene="Smad4"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(111.36283022004999,54.19062334717073,76.84622756760974,186.35879225673838,562.3977487133262,70.66558664247444,184.50437997994135,20.614198864225376,195.54148989127174,68.30079580498222,158.6731462115317,101.28649799876324,49.175890245604464,67.15588291876078,212.3369778690162,117.67071130675423,65.07568791152283,52.546869630027864,589.8827065236615,61.378612307595525,230.36230917245376,109.79013028349684),c(66.18962143230738,39.366440668613386,48.49850806489148,101.28195231344476,26.780845176825057,39.572728519785684,18.763157286095733,150.31186671831003,60.3266298600732,1099.9273991094012,37.334857932125104,69.68511062314911,318.5742455041333,58.92966118038251,99.58021037397404,121.93414287583953,48.806765933642126,39.4101522225209,107.1651862333983,17.18601144612675,134.7402185725673,108.89752759826516),c(60.1504223965129,251.68167925372907,185.7971013190209,36.46150283284012,160.68507106095035,178.0772783390356,395.58989944851834,31.78022324901412,449.3293810267521,367.1167774517794,144.6725744869848,257.67285090885366,992.0701336504552,160.03740472844996,66.098794738473,43.48700200467004,268.4372126350317,183.91404370509753,767.2268642727365,58.30968169221575,240.5040460542599,51.77095574343753),c(85.27349038541789,40.02529323210482,251.3725488433812,137.74345514628487,44.6347419613751,84.79870397096933,75.05262914438293,220.74371283774673,41.08451516332571,92.49066098591342,57.16900120856656,320.87562566008194,164.63232821354538,95.57373983315844,171.07923344075365,55.424610398108875,40.67230494470177,43.78905802502322,42.676401597371004,206.23213735352095,65.19687995446805,124.96437593243543))
targetgene="Cd3e"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(89.13857776832634,164.38371459111363,73.43083967571597,93.17939612836919,160.68507106095035,87.62532743666831,9.381578643047867,10.307099432112688,8.84097161742452,42.687997378113884,3.5001429311367285,167.73044068595192,21.380821845914983,86.45011208695709,97.20410990951912,138.9878691521807,138.28583681198603,144.50389148257662,15.173831679065247,141.1708083074697,49.25986485448697,8.033424167085135),c(121.5086846001847,56.82603360113647,98.36317128654048,129.6408989612093,508.8360583596761,70.66558664247444,3904.30031194842,369.33772965070466,133.6546885693001,165.06025652870701,74.66971586425021,81.8394903830007,91.93753393743442,96.17201050504049,128.093415947433,91.23743557842538,73.2101489004632,52.546869630027864,389.7778012559885,376.25089344556056,173.8583465452481,66.94520139237612),c(205.3327672170119,792.4349207393263,352.4680304434367,340.3073597731744,276.7354001605256,390.0740382664589,983.5021610795179,669.9614630873247,552.3006975120495,843.7994148407179,634.6925848461268,266.58606273274484,1000.6224623888212,493.4237366347256,381.040110845315,216.58232370953314,683.2947230709898,753.1717980303994,1018.5434514572547,300.7552003072181,362.20488863593357,379.3561412234647),c(216.9280293657373,192.055522257754,513.6743389408225,340.3073597731744,303.51624533735065,310.92858122688756,123.52411880013024,129.69766785408464,56.166172628344015,48.37973036186241,73.5030015538713,51.85868697536678,192.42739661323486,256.20941523349046,326.1737910297197,240.45754049641081,146.4202978009264,192.67185531010216,126.13247583222986,60.76482618451957,81.13389505444913,116.0383490801186))
targetgene="Tk2"
collabel=c("In.vivo.input_Pool.A..1.8._1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._BM_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._BM_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1817_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1819_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1820_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1822_Pool.A..1.8._BM_mCD19_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1813_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1814_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1810_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1811_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1812_Pool.A..1.8._SP_hEGFRv3_15m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1823_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1825_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1827_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409","In.vivo_AR1828_Pool.A..1.8._SP_mCD19_10m_1360..1361..1362..1363..1406..1407..1408..1409")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("invivo.poolA_all_v_input_summary.Rnw");
library(tools);

texi2dvi("invivo.poolA_all_v_input_summary.tex",pdf=TRUE);

