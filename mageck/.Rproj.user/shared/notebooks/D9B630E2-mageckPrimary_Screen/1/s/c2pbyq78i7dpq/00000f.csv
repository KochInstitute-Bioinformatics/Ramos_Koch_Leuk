"0","files.toPlot <- list.files(pattern=glob2rx(""*all_v_input.normalized.txt""), full.names=FALSE)"
"0",""
"0","# Create an empty list to store the ggplot objects"
"0","PCAdata <- list()"
"0","PCAplots <- list()"
"0",""
"0","for (i in files.toPlot){"
"0","  plotTitle <- sub(""_all_v_input.normalized.txt"", """", i)"
"0","  norm <- read.table(i, row.names = 1, sep = ""\t"", header = TRUE)"
"0","  norm.l2 <- norm %>% select(-Gene)"
"0","  norm.l2 <- log2(norm.l2+1)"
"0","  dims <- dim(norm.l2)"
"0","  norm.l2 <- norm.l2 %>% rename_at(vars(everything()), ~str_replace_all(., ""\\.\\.\\d+\\.\\d+\\."", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""_\\d{4}\\.{2}\\d{4}\\.{2}\\d{4}\\.{2}\\d{4}\\.{2}\\d{4}\\.{2}\\d{4}\\.{2}\\d{4}\\.{2}\\d{4}"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""In.vitro_"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""In.vitro\\."", """")) %>%"
"0","    rename_at(vars(everything()), ~str_replace_all(., ""In.vivo_"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""In.vivo\\."", """")) %>% "
"0","    #rename_at(vars(everything()), ~str_replace_all(., ""^AR\\d{4}_"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""Pool\\.[ABCDEF]_"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""_Pool\\.[ABCDEF]_."", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""\\.Pool\\.[ABCDEF]"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""_Pool\\.[ABCDEF]"", """")) %>% "
"0","    rename_at(vars(everything()), ~str_replace_all(., ""_rep"", ""_""))"
"0","  assign(paste0(plotTitle,"".boxPlot""),"
"0","         ggplot(stack(norm.l2), aes(x = ind, y = values)) + geom_boxplot() + ylim(0, 12) +"
"0","           theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + "
"0","           ggtitle(paste0(plotTitle,"" - "",dims[1],""x"",dims[2])))"
"0","  "
"0","  select.pca <- prcomp(t(norm.l2))"
"0","  var <- select.pca$sdev^2"
"0","  variance <- var/sum(var)"
"0","  percentVar <- select.pca$sdev^2 / sum(select.pca$sdev^2 )"
"0","  percentVar <- round(100 * percentVar,2)"
"0","  select.pca$percentVar <- percentVar"
"0","  select.pca$samps <- colnames(norm.l2)"
"0","  select.pca$samps <- select.pca$samps %>% "
"0","    str_replace_all(., ""^AR\\d{4}_"", """") %>% "
"0","    str_replace_all(., ""\\.[xy]$"", """") %>%"
"0","    str_replace_all(., ""CAR_"", """") %>%"
"0","    str_replace_all(., ""_[123]$"", """")"
"0","  data <- as.data.frame(select.pca$x)"
"0","  data$fill <- factor(select.pca$samps)"
"0","  plot <- ggplot(data, aes(x=PC1, y=PC2)) + "
"0","         geom_point(aes(fill = fill),shape=21, size = 4) + "
"0","         xlab(paste0(""PC1 - "",select.pca$percentVar[1],"" % of variability"")) + "
"0","         ylab(paste0(""PC2 - "",select.pca$percentVar[2],"" % of variability"")) +"
"0","    theme(legend.text = element_text(size = 8))"
"0","  PCAdata[[plotTitle]] <- data"
"0","  PCAplots[[plotTitle]] <- plot"
"0","}"
