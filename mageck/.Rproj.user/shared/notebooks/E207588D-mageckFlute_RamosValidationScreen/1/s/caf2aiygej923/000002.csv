"0","# Create an empty list to store the ggplot objects"
"0","PCAdata <- list()"
"0","PCAplots <- list()"
"0",""
"0","# Read in sample annotations"
"0","AR.samps <- read_xlsx(""AR_validation_conditions.xlsx"")"
"0",""
"0","# PCA of all samples together"
"0","plotTitle <- ""All Validation Samples"""
"0","select.pca <- prcomp(t(validation.n.l2.reorder))"
"0","var <- select.pca$sdev^2"
"0","variance <- var/sum(var)"
"0","percentVar <- select.pca$sdev^2 / sum(select.pca$sdev^2 )"
"0","percentVar <- round(100 * percentVar,2)"
"0","select.pca$percentVar <- percentVar"
"0",""
"0","select.pca$treatment <- AR.samps$treatment"
"0","select.pca$tissue <- AR.samps$tissue"
"0","select.pca$tissTreat <- paste0(AR.samps$tissue,""."",AR.samps$treatment)"
"0",""
"0","select.pca$samps <- colnames(validation.n.l2.reorder)"
"0",""
"0","data <- as.data.frame(select.pca$x)"
"0","data$fill <- factor(select.pca$tissTreat)"
"0","plot <- ggplot(data, aes(x=PC1, y=PC2)) + geom_point(aes(fill = fill),shape=21, size = 4) + xlab(paste0(""PC1 - "",select.pca$percentVar[1],"" % of variability"")) + ylab(paste0(""PC2 - "",select.pca$percentVar[2],"" % of variability"")) + theme(legend.text = element_text(size = 8))"
"0",""
"0","PCAdata[[plotTitle]] <- data"
"0","PCAplots[[plotTitle]] <- plot"
"0",""
"0","# PCA of just in vitro"
"0",""
"0","plotTitle <- ""In vitro"""
"0","invitro.l2 <- validation.n.l2.reorder %>% dplyr::select(starts_with(""pDNA"") |"
"0","                                                          starts_with(""Input"") |"
"0","                                                          starts_with(""ah"") |"
"0","                                                          starts_with(""am"") |"
"0","                                                          starts_with(""NoCAR""))"
"0","select.pca <- prcomp(t(invitro.l2))"
"0","var <- select.pca$sdev^2"
"0","variance <- var/sum(var)"
"0","percentVar <- select.pca$sdev^2 / sum(select.pca$sdev^2 )"
"0","percentVar <- round(100 * percentVar,2)"
"0","select.pca$percentVar <- percentVar"
"0",""
"0","meta_df <- AR.samps %>% dplyr::filter(tissue == ""inVitro"") %>% dplyr::select(treatment)"
"0","select.pca$treatment <- meta_df$treatment"
"0"," "
"0","select.pca$samps <- colnames(invitro.l2)"
"0",""
"0","data <- as.data.frame(select.pca$x)"
"0","data$fill <- factor(select.pca$treatment)"
"0","plot <- ggplot(data, aes(x=PC1, y=PC2)) + geom_point(aes(fill = fill),shape=21, size = 4) +"
"0","  xlab(paste0(""PC1 - "",select.pca$percentVar[1],"" % of variability"")) +"
"0","  ylab(paste0(""PC2 - "",select.pca$percentVar[2],"" % of variability"")) +"
"0","  theme(legend.text = element_text(size = 8)) + ggtitle(plotTitle)"
"0",""
"0","PCAdata[[plotTitle]] <- data"
"0","PCAplots[[plotTitle]] <- plot"
"0",""
"0","# PCA of BM"
"0",""
"0","plotTitle <- ""BM Samples"""
"0","invitro.l2 <- validation.n.l2.reorder %>% dplyr::select(ends_with(""BM""))"
"0",""
"0","select.pca <- prcomp(t(invitro.l2))"
"0","var <- select.pca$sdev^2"
"0","variance <- var/sum(var)"
"0","percentVar <- select.pca$sdev^2 / sum(select.pca$sdev^2 )"
"0","percentVar <- round(100 * percentVar,2)"
"0","select.pca$percentVar <- percentVar"
"0",""
"0","meta_df <- AR.samps %>% dplyr::filter(tissue == ""BM"") %>% dplyr::select(treatment)"
"0","select.pca$treatment <- meta_df$treatment"
"0"," "
"0","select.pca$samps <- colnames(invitro.l2)"
"0",""
"0","data <- as.data.frame(select.pca$x)"
"0","data$fill <- factor(select.pca$treatment)"
"0","plot <- ggplot(data, aes(x=PC1, y=PC2)) + geom_point(aes(fill = fill),shape=21, size = 4) +"
"0","  xlab(paste0(""PC1 - "",select.pca$percentVar[1],"" % of variability"")) +"
"0","  ylab(paste0(""PC2 - "",select.pca$percentVar[2],"" % of variability"")) +"
"0","  theme(legend.text = element_text(size = 8)) + ggtitle(plotTitle)"
"0",""
"0","PCAdata[[plotTitle]] <- data"
"0","PCAplots[[plotTitle]] <- plot"
"0",""
"0","# PCA of SP"
"0",""
"0","plotTitle <- ""SP Samples"""
"0","invitro.l2 <- validation.n.l2.reorder %>% dplyr::select(ends_with(""SP""))"
"0",""
"0","select.pca <- prcomp(t(invitro.l2))"
"0","var <- select.pca$sdev^2"
"0","variance <- var/sum(var)"
"0","percentVar <- select.pca$sdev^2 / sum(select.pca$sdev^2 )"
"0","percentVar <- round(100 * percentVar,2)"
"0","select.pca$percentVar <- percentVar"
"0",""
"0","meta_df <- AR.samps %>% dplyr::filter(tissue == ""SP"") %>% dplyr::select(treatment)"
"0","select.pca$treatment <- meta_df$treatment"
"0"," "
"0","select.pca$samps <- colnames(invitro.l2)"
"0",""
"0","data <- as.data.frame(select.pca$x)"
"0","data$fill <- factor(select.pca$treatment)"
"0","plot <- ggplot(data, aes(x=PC1, y=PC2)) + geom_point(aes(fill = fill),shape=21, size = 4) +"
"0","  xlab(paste0(""PC1 - "",select.pca$percentVar[1],"" % of variability"")) +"
"0","  ylab(paste0(""PC2 - "",select.pca$percentVar[2],"" % of variability"")) +"
"0","  theme(legend.text = element_text(size = 8)) + ggtitle(plotTitle)"
"0",""
"0","PCAdata[[plotTitle]] <- data"
"0","PCAplots[[plotTitle]] <- plot"
