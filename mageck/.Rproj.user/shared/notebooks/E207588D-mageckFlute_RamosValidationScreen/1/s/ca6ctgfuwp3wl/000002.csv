"0","# gene.l2 <- read.xlsx(""geneLevel_l2n_for_PCA.xlsx"")"
"0","# #gene.l2 <- gene.l2 %>% dplyr::filter(is.na(ControlGroup))"
"0","# cols <- grep('^Avg.AR', colnames(gene.l2))"
"0","# cols3 <- cols[c(2,4,6,8,10,12,14,16)]"
"0","# #geneAR <- gene.l2[cols]"
"0","# ARgene.pca <- prcomp(t(gene.l2[cols3]))"
"0","# "
"0","# var <- ARgene.pca$sdev^2"
"0","# variance <- var/sum(var)"
"0","# percentVar <- ARgene.pca$sdev^2 / sum(ARgene.pca$sdev^2 )"
"0","# percentVar <- round(100 * percentVar,2)"
"0","# ARgene.pca$percentVar <- percentVar"
"0","# ARgene.pca.samps <- read_xlsx(""AR_conditions.xlsx"")"
"0","# ARgeneSubset.pca.samps <- read_xlsx(""AR_conditions3.xlsx"")"
"0","# ARgene.pca$treatment <- ARgeneSubset.pca.samps$treatment"
"0","# ARgene.pca$tissue <-ARgeneSubset.pca.samps$tissue"
"0","# "
"0","# #write.xlsx(as.data.frame(ARgene.pca$x), file=""ARgene_PCA.xlsx"", rowNames=TRUE)"
"0","# "
"0","# arPCAplot4 <- ggplot(as.data.frame(ARgene.pca$x), aes(x=PC1, y=PC2)) + "
"0","#   geom_point(aes(fill = factor(ARgene.pca$treatment)),shape=21, size = 5) + "
"0","#   xlab(paste0(""PC1 - "",ARgene.pca$percentVar[1],"" % of variability"")) + "
"0","#   ylab(paste0(""PC2 - "",ARgene.pca$percentVar[2],"" % of variability""))"
"0","# "
"0","# arPCAplot4"
"0","# "
"0","# pdf('PCA_geneLevel.pdf',width=10, height=8)"
"0","# print(arPCAplot4)"
"0","# dev.off()"
