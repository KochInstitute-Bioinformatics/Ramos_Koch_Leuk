"0","sorted_df <- GeneMeans %>% dplyr::select(cd19_1to2_v_egfr_1to2.fc.Gene,Gene) %>% arrange(cd19_1to2_v_egfr_1to2.fc.Gene)"
"0","sorted_df$rank <- c(1:nrow(sorted_df))"
"0","colnames(sorted_df) <- c(""LFC"",""gene"",""rank"")"
"0","sorted_df_top <- sorted_df[sorted_df$rank <= 10 | sorted_df$rank >= (nrow(sorted_df)-9),]"
"0","sorted_df$color <- ""others"""
"0","sorted_df$color[match(c('Jak2','Stat1','Ifngr1','H2-T23','Cd19'),sorted_df$gene)] <- ""hits"""
"0","df_to_highlight <- sorted_df[match(c('Jak2','Stat1','Ifngr1','H2-T23','Cd19'),sorted_df$gene),]"
"0",""
"0","p1 <- ggplot(sorted_df, aes(x=rank, y=LFC)) +"
"0","  geom_point(aes(size=abs(LFC), fill = color),shape=21, color='grey50') +"
"0","  theme_bw() + "
"0","  geom_point(data = df_to_highlight, aes(size=abs(LFC), fill = color),shape=21, color='grey50') +"
"0","  theme(panel.border = element_blank(), panel.grid.major = element_blank(),"
"0","        panel.grid.minor = element_blank(), axis.line = element_line(colour = ""black"")) +"
"0","  theme(axis.text=element_text(size=20)) + ggtitle(""cd19_1to2_v_egfr_1to2"") +"
"0","  scale_y_continuous(breaks=seq(-6,6,2), limits=c(-7,7)) "
"0",""
"0",""
"0","sorted_df <- GeneMeans %>% dplyr::select(cd19_1to10_v_egfr_1to10.fc.Gene,Gene) %>% arrange(cd19_1to10_v_egfr_1to10.fc.Gene)"
"0","sorted_df$rank <- c(1:nrow(sorted_df))"
"0","colnames(sorted_df) <- c(""LFC"",""gene"",""rank"")"
"0","sorted_df_top <- sorted_df[sorted_df$rank <= 10 | sorted_df$rank >= (nrow(sorted_df)-9),]"
"0","sorted_df$color <- ""others"""
"0","sorted_df$color[match(c('Jak2','Stat1','Ifngr1','H2-T23','Cd19'),sorted_df$gene)] <- ""hits"""
"0","df_to_highlight <- sorted_df[match(c('Jak2','Stat1','Ifngr1','H2-T23','Cd19'),sorted_df$gene),]"
"0",""
"0","p2 <- ggplot(sorted_df, aes(x=rank, y=LFC)) +"
"0","  geom_point(aes(size=abs(LFC), fill = color),shape=21, color='grey50') +"
"0","  theme_bw() + "
"0","  geom_point(data = df_to_highlight, aes(size=abs(LFC), fill = color),shape=21, color='grey50') +"
"0","  theme(panel.border = element_blank(), panel.grid.major = element_blank(),"
"0","        panel.grid.minor = element_blank(), axis.line = element_line(colour = ""black"")) +"
"0","  theme(axis.text=element_text(size=20)) + ggtitle(""cd19_1to10_v_egfr_1to10"") +"
"0","  scale_y_continuous(breaks=seq(-6,6,2), limits=c(-7,7)) "
"0",""
"0",""
