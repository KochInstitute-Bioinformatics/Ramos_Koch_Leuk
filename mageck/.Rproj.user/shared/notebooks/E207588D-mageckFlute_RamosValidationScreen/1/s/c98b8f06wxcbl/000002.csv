"0","cw.geneLevel.FCs.columns <- colnames(cw.geneLevel.FCs[-1])"
"0","goi <- c(""Jak2"",""Stat1"",""Ifngr1"",""H2-T23"",""Cd19"")"
"0",""
"0","# GOI"
"0",""
"0","for (i in cw.geneLevel.FCs.columns){"
"0","  sorted_df <- cw.geneLevel.FCs %>% dplyr::select(all_of(i),id) %>% arrange(get(i))"
"0","  sorted_df$rank <- c(1:nrow(sorted_df))"
"0","  colnames(sorted_df) <- c(""LFC"",""gene"",""rank"")"
"0","  sorted_df <- sorted_df %>% drop_na(LFC)"
"0","  sorted_df <- sorted_df %>% mutate(top = if_else(rank <= 4 | rank >= max(rank) - 5, sorted_df$gene, """"))"
"0","  sorted_df <- sorted_df %>% mutate(color = if_else(sorted_df$gene %in% goi, ""hits"", ""all""))"
"0","  sorted_df <- sorted_df %>% mutate(highlight = if_else(sorted_df$gene %in% goi, sorted_df$gene, """"))"
"0","  sorted_df <- sorted_df %>% arrange(color)"
"0","  titleText <- str_replace(i, "".Score"", """")"
"0","  assign(paste0(i,"".GOIplot""),ggplot(sorted_df, aes(x=rank, y=LFC)) + geom_point(aes(size=abs(LFC), color=color)) +"
"0","           scale_color_manual(values = c(""grey50"", ""darkgoldenrod1"")) + "
"0","           # switching label = between highlight and top will switch which genes are labeled"
"0","           geom_text_repel(data = sorted_df, aes(x=rank, y=LFC, label = highlight), "
"0","                           force = 10, max.overlaps = 50000, size=5) +"
"0","           theme_bw() + geom_hline(yintercept=0, color=""grey50"") +"
"0","           theme(panel.border = element_blank(), "
"0","                 panel.grid.major = element_blank(), "
"0","                 panel.grid.minor = element_blank(), "
"0","                 axis.line = element_line(colour = ""black""),"
"0","                 legend.position=""none"") + "
"0","           theme(axis.text=element_text(size=10),axis.text.x = element_text(angle = 45,vjust = 0.5),"
"0","                 plot.title = element_text(size = 18)) + "
"0","           ggtitle(titleText) + "
"0","           scale_y_continuous(breaks=seq(-6,6,2), limits=c(-6,6)))"
"0","}"
"0",""
"0",""
"0","# top5"
"0",""
"0","for (i in cw.geneLevel.FCs.columns){"
"0","  sorted_df <- cw.geneLevel.FCs %>% dplyr::select(all_of(i),id) %>% arrange(get(i))"
"0","  sorted_df$rank <- c(1:nrow(sorted_df))"
"0","  colnames(sorted_df) <- c(""LFC"",""gene"",""rank"")"
"0","  sorted_df <- sorted_df %>% drop_na(LFC)"
"0","  sorted_df <- sorted_df %>% mutate(top = if_else(rank <= 5 | rank >= max(rank) - 4, sorted_df$gene, """"))"
"0","  sorted_df <- sorted_df %>% mutate(color = if_else(rank <= 5 | rank >= max(rank) -4, ""hits"", ""all""))"
"0","  sorted_df <- sorted_df %>% mutate(highlight = if_else(sorted_df$gene %in% goi, sorted_df$gene, """"))"
"0","  sorted_df <- sorted_df %>% arrange(color)"
"0","  titleText <- str_replace(i, "".Score"", """")"
"0","  assign(paste0(i,"".TOPplot""),ggplot(sorted_df, aes(x=rank, y=LFC)) + geom_point(aes(size=abs(LFC), color=color)) +"
"0","           scale_color_manual(values = c(""grey50"", ""firebrick4"")) + "
"0","           # switching label = between highlight and top will switch which genes are labeled"
"0","           geom_text_repel(data = sorted_df, aes(x=rank, y=LFC, label = top,), "
"0","                           force = 10, max.overlaps = 50000, size=5) +"
"0","           theme_bw() + geom_hline(yintercept=0, color=""grey50"") +"
"0","           theme(panel.border = element_blank(), "
"0","                 panel.grid.major = element_blank(), "
"0","                 panel.grid.minor = element_blank(), "
"0","                 axis.line = element_line(colour = ""black""),"
"0","                 legend.position=""none"") + "
"0","           theme(axis.text=element_text(size=12),axis.text.x = element_text(angle = 45,vjust = 0.5),"
"0","                 plot.title = element_text(size = 18)) + "
"0","           ggtitle(titleText) + "
"0","           scale_y_continuous(breaks=seq(-6,6,2), limits=c(-6,6)))"
"0","}"
