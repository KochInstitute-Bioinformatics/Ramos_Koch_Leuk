"0","Fccolumns <- colnames(GeneMeans[-1])"
"0",""
"0","for (i in Fccolumns){"
"0","  sorted_df <- GeneMeans %>% dplyr::select(all_of(i),Gene) %>% arrange(get(i))"
"0","  sorted_df$rank <- c(1:nrow(sorted_df))"
"0","  colnames(sorted_df) <- c(""LFC"",""gene"",""rank"")"
"0","  sorted_df_top <- sorted_df[sorted_df$rank <= 10 | sorted_df$rank >= (nrow(sorted_df)-9),]"
"0","  sorted_df$color <- ""others"""
"0","  sorted_df$color[match(c(""Jak1"",""Jak2"",""Stat1"",""Ifngr1"",""H2-T23"",""Cd19""),sorted_df$gene)] <- ""hits"""
"0","  df_to_highlight <- sorted_df[match(c('Jak2','Stat1','Ifngr1','H2-T23','Cd19'),sorted_df$gene),]"
"0","  assign(paste0(i,"".plot""),ggplot(sorted_df, aes(x=rank, y=LFC)) + geom_point(aes(size=abs(LFC), fill = color),shape=21, color='grey50') +"
"0","  theme_bw() + geom_point(data = df_to_highlight, aes(size=abs(LFC), fill = color),shape=21, color='grey50') + geom_label_repel(data=df_to_highlight, aes(label = gene)) +"
"0","  theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = ""black"")) +"
"0","  theme(axis.text=element_text(size=20)) + ggtitle(i) +"
"0","  scale_y_continuous(breaks=seq(-6,6,2), limits=c(-7,7)))"
"0","}"
