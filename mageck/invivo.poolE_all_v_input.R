pdf(file='invivo.poolE_all_v_input.pdf',width=4.5,height=4.5);
gstable=read.table('invivo.poolE_all_v_input.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Gm36327_Gm40363_Gm40364_Gm40365_Gm40367_Gm40369_Gm52861","Sys1","Sec63","Ebna1bp2","Mrpl41","Mrpl12","Lars2","Mecr","Nhlrc2","Noc2l")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27_vs_0 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(28.18187639313459,1.2520362308799766,0.0,0.0,20.530547245434626,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,43.79558406115569,0.0,5.816673601220603,0.0,0.0,5.1259178697496175,1.508034797073599,0.0,2.435813411002184,0.0,0.0,0.0,2.023837154236224,2.4027769449081764,0.0),c(21.965286012296076,3.1300905771999417,3.952842272598679,0.6181548273413366,0.0,0.0,60.5033893390692,0.0,0.0,0.0,0.0,0.0,0.0,0.0,46.18049945336357,0.0,0.0,13.03309395399985,2.5629589348748087,1.0053565313823993,0.48473289904201555,0.0,5.315983734138371,0.0,2.514536761523211,2.023837154236224,5.606479538119078,0.0),c(55.534874068824045,0.0,8.470376298425741,1.85446448202401,5.86587064155275,0.0,15.982027372584318,1.0971780187576292,0.0,0.0,5.525246983301809,0.0,0.0,2.856233743118849,0.7827203297180266,0.0,0.9960736165063554,1.6291367442499813,1.2814794674374044,27.14462634732478,5.816794788504186,15.832787171514195,1.0631967468276742,20.846394341912685,1.2572683807616054,4.047674308472448,2.4027769449081764,2.8155635397189402),c(3.31551486978054,0.0,0.0,1.85446448202401,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.6291367442499813,0.0,0.5026782656911997,11.633589577008372,0.0,0.0,3.158544597259498,0.0,0.0,0.8009256483027255,0.0),c(22.79416472974121,18.154525347759662,3.3881505193702965,2.4726193093653466,2.932935320776375,0.0,11.415733837560227,0.0,0.0,0.0,0.0,63.48075228680607,1.3064114345972313,36.17896074617209,5.4790423080261865,0.0,4.980368082531777,17.920504186749795,1.9222192011561066,15.080347970735989,5.332061889462171,13.396973760512012,1.0631967468276742,9.475633791778494,0.0,13.492247694908158,7.20833083472453,0.0),c(37.71398164375364,1.2520362308799766,5.082225779055444,82.8327468637391,4.399402981164562,32.41033928331868,6.849440302536136,0.0,86.0131508212633,53.21263347463874,8.287870474952713,39.90218715170668,10.45129147677785,26.658181602442593,53.22498242082581,6.647626972823546,0.0,24.43705116374972,32.67772641965381,59.81871361725276,35.38550163006713,37.75510787053385,64.85500155648812,33.480572730950676,18.230391521043277,26.984495389816317,4.805553889816353,50.680143714940925),c(5.387711663393377,0.0,41.787189738900324,11.12678689214406,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.9921472330127108,0.0,2.5629589348748087,1.0053565313823993,1.9389315961680622,0.0,0.0,12.634178389037992,0.0,0.0,0.0,0.0))
targetgene="Gm36327_Gm40363_Gm40364_Gm40365_Gm40367_Gm40369_Gm52861"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(88.27558340790688,0.0,3.952842272598679,0.0,0.0,0.0,27.397761210144544,13.16613622509155,0.0,3.4330731273960478,0.0,0.0,0.0,4.760389571864748,0.7827203297180266,0.8309533716029432,8.964662548557198,19.549640930999775,1.9222192011561066,9.048208782441595,6.301527687546202,0.0,23.390328430208832,3.158544597259498,0.6286341903808027,16.865309618635198,3.203702593210902,8.44669061915682),c(32.326269980360266,19.40656157863964,1.1293835064567654,19.162799647581437,2.932935320776375,28.088960712209524,0.0,0.0,10.751643852657912,0.0,0.0,12.696150457361215,7.838468607583388,3.808311657491799,0.7827203297180266,31.576228120911843,10.956809781569909,0.0,9.611096005780533,16.08570450211839,19.389315961680623,14.614880466013103,21.263934936553483,0.0,4.400439332665619,5.396899077963264,4.004628241513627,4.22334530957841),c(188.98434757749078,60.723757197678864,114.63242590536169,19.162799647581437,17.59761192465825,36.73171785442784,37.67192166394875,133.85571828843075,100.34867595814052,22.31497532807431,35.91410539146176,52.59833760906789,148.93090354408437,3.808311657491799,26.612491210412905,135.44539957127975,19.92147233012711,172.68849489049802,26.91106881618549,55.294609226031966,14.05725407221845,81.59974926857316,41.464673126279294,54.958675992315264,138.2995218837766,24.960658235580095,82.49534177518073,146.4093040653849),c(61.33702509093999,122.07353251079772,11.858526817796037,26.580657575677474,35.1952238493165,41.05309642553699,39.955068431460795,91.06577555688322,0.0,0.0,0.0,0.0,0.0,30.466493259934392,22.69888956182277,0.8309533716029432,0.9960736165063554,6.516546976999925,13.455534408092745,11.058921845206392,9.694657980840311,41.40882798703713,23.390328430208832,13.89759622794179,15.087220569139266,1.349224769490816,7.20833083472453,2.8155635397189402))
targetgene="Sys1"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(86.61782597301661,128.95973178063758,97.6916733085102,49.45238618730693,24.929950226599185,25.928271426654945,7.991013686292159,31.818162543971248,14.335525136877216,54.929170038336764,22.100987933207236,0.0,0.0,26.658181602442593,91.57827857700912,28.25241463450007,12.94895701458262,22.80791441949974,28.833288017341598,23.625878487486386,41.68702931761334,65.76696209705896,14.884754455587439,30.322028133691177,42.11849075551378,57.34205270335968,57.66664667779624,49.27236194508146),c(27.767437034412023,31.926923887439404,1.6940752596851483,0.0,1.4664676603881874,10.803446427772894,0.0,0.0,0.0,0.0,2.7626234916509045,0.0,18.289760084361237,1.9041558287458995,34.439694507593174,4.98572022961766,0.0,0.0,32.03698668593511,10.053565313823993,0.0,9.743253644008735,62.72860806283278,0.0,20.116294092185687,0.0,0.0,12.670035928735231),c(18.649771142515537,0.6260181154399883,10.164451558110889,24.726193093653464,0.0,118.83791070550183,0.0,13.16613622509155,0.0,0.0,0.0,0.0,0.0,0.9520779143729498,0.0,2.49286011480883,0.0,60.27805953724931,16.018493342967556,11.561600110897592,11.633589577008372,12.179067055010918,7.4423772277937195,17.68784974465319,0.0,13.492247694908158,14.41666166944906,29.563417167048872),c(184.8399539902651,50.08144923519907,468.12946342632927,17.926489992898762,98.25333324600855,28.088960712209524,58.22024257155716,234.79609601413264,86.0131508212633,29.181121582866407,27.626234916509045,18.137357796230308,198.57453805877915,66.64545400610648,45.39777912364554,88.91201076151492,181.28539820415668,79.82770046824909,129.42942621117786,79.92584424490074,85.31299023139474,32.88348104852948,37.211886138968595,49.27329571724817,27.031270186374517,40.476743084724475,68.87960575403439,35.19454424648675))
targetgene="Sec63"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(31.49739126291513,0.6260181154399883,3.952842272598679,0.0,7.332338301940937,43.213785711091575,0.0,21.943560375152586,12.543584494767565,6.8661462547920955,0.0,3.6274715592460614,0.0,1.9041558287458995,7.04448296746224,0.0,10.956809781569909,53.761512560249386,3.203698668593511,6.032139188294396,23.267179154016745,7.3074402330065515,25.516721923864182,7.580507033422794,7.543610284569633,5.396899077963264,0.8009256483027255,11.262254158875761),c(22.79416472974121,1.2520362308799766,1.1293835064567654,0.0,99.71980090639674,58.33861070997362,0.0,7.680246131303404,0.0,6.8661462547920955,35.91410539146176,0.0,0.0,7.616623314983598,10.175364286334347,0.8309533716029432,0.0,37.470145117749574,6.407397337187022,2.5133913284559983,0.48473289904201555,13.396973760512012,24.453525177036507,2.526835677807598,9.42951285571204,0.0,7.20833083472453,12.670035928735231),c(50.9760411228758,8.764253616159836,87.52722175039932,98.28661754727253,10.265273622717313,0.0,5.707866918780113,211.75535762022244,35.838812842193036,0.0,2.7626234916509045,67.10822384605214,69.23980603365325,0.9520779143729498,31.308813188721064,6.647626972823546,0.0,37.470145117749574,46.77400056146526,43.73300911513437,42.65649511569737,13.396973760512012,12.758360961932091,17.05614082520129,40.23258818437137,9.444573386435712,16.819438614357235,21.116726547892053),c(40.615057154811616,1.8780543463199648,3.3881505193702965,58.72470859742698,2.932935320776375,17.28551428443663,79.91013686292159,0.0,0.0,0.0,8.287870474952713,10.882414677738184,5.225645738388925,15.233246629967196,8.609923626898293,5.816673601220603,66.7369323059258,35.84100837349959,26.27032908246679,27.647304613015983,12.603055375092405,25.57604081552293,26.579918670691853,22.741521100268383,38.34668561322896,22.262208696598464,12.814810372843608,68.98130672311403))
targetgene="Ebna1bp2"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(19.89308921868324,0.0,36.704963959844875,9.890477237461386,0.0,19.44620356999121,10.274160453804203,8.777424150061034,0.0,0.0,0.0,7.254943118492123,0.0,5.712467486237698,73.5757109934945,65.64531635663252,47.81153359230506,11.40395720974987,7.0481370709057245,5.026782656911997,8.240459283714264,12.179067055010918,14.884754455587439,4.421962436163297,0.6286341903808027,3.3730619237270396,0.0,0.0),c(16.99201370762527,9.390271731599825,38.963730972758405,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.7626234916509045,39.90218715170668,5.225645738388925,4.760389571864748,0.0,1.6619067432058865,1.9921472330127108,6.516546976999925,18.581452277842363,10.053565313823993,3.3931302932941088,0.0,0.0,0.6317089194518996,2.514536761523211,12.817635310162752,0.0,7.038908849297351),c(56.77819214499175,23.162670271279566,2.258767012913531,0.0,21.997014905822812,10.803446427772894,14.840453988828294,35.109696600244135,331.5090187902856,3.4330731273960478,46.96459935806538,3.6274715592460614,22.20899438815293,2.856233743118849,1.5654406594360533,2.49286011480883,28.886134878684306,9.774820465499888,44.851781360309154,20.609808893339185,3.8778631923361244,12.179067055010918,38.27508288579627,68.22456330080516,108.75371493587886,17.539922003380607,25.629620745687216,66.1657431833951),c(14.090938196567295,1.2520362308799766,0.0,0.6181548273413366,0.0,0.0,0.0,0.0,0.0,554.4413100744617,0.0,0.0,0.0,9.520779143729497,115.05988846854991,14.957160688852978,0.9960736165063554,1.6291367442499813,6.407397337187022,6.032139188294396,20.84351465880667,2.435813411002184,5.315983734138371,5.685380275067096,44.63302751703699,1.349224769490816,16.01851296605451,0.0))
targetgene="Mrpl41"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(43.93057202459215,16.902489116879686,3.3881505193702965,1.2363096546826733,1.4664676603881874,133.96273570438387,2.2831467675120454,2.1943560375152584,102.14061660025017,63.511852856826884,0.0,206.7658788770255,84.91674324882004,3.808311657491799,40.701457145337386,0.0,14.94110424759533,21.17877767524976,16.018493342967556,16.08570450211839,4.36259609137814,20.704413993518564,31.895902404830224,13.89759622794179,11.944049617235251,8.095348616944896,30.435174635503568,56.31127079437881),c(82.47343238579093,23.788688386719556,0.0,7.41785792809604,49.85990045319837,168.53376427325713,78.76856347916556,34.0125185814865,28.67105027375443,0.0,13.813117458254522,0.0,52.256457383889256,2.856233743118849,6.261762637744213,18.280974175264753,46.8154599757987,35.84100837349959,12.174054940655342,34.18212206700158,26.17557654826884,54.80580174754914,62.72860806283278,49.27329571724817,3.1431709519040134,42.5005802389607,19.22221555926541,49.27236194508146),c(10.360983968064188,13.146380424239755,25.411128895277223,0.0,2.932935320776375,0.0,25.1146144426325,4.388712075030517,53.75821926328956,18.88190220067826,5.525246983301809,0.0,0.0,0.0,0.7827203297180266,0.0,0.0,24.43705116374972,21.785150946435873,0.5026782656911997,4.847328990420156,32.88348104852948,5.315983734138371,30.322028133691177,32.68897789980174,6.0715114627086715,12.013884724540883,5.6311270794378805),c(48.07496561181783,24.414706502159543,3.3881505193702965,16.690180338216088,0.0,0.0,218.04051629740033,14.26331424384918,215.03287705315824,6.8661462547920955,0.0,250.29553758797823,103.20650333318127,24.754025773696693,75.92387198264858,3.323813486411773,22.909693179646172,35.84100837349959,12.814794674374044,10.556243579515193,40.23283062048729,18.268600582516378,9.568770721449068,16.424431905749387,16.973123140281672,35.07984400676121,4.004628241513627,8.44669061915682))
targetgene="Mrpl12"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(150.441487216292,75.74819196823859,46.869415517955765,3.090774136706683,38.12815917009287,34.57102856887326,46.80450873399693,17.554848300122067,103.93255724235982,15.448829073282216,171.2826564823561,226.71697245287882,240.37970396589057,3.808311657491799,54.007702750543835,48.195295552970705,527.9190167483683,17.920504186749795,94.82948059036792,113.60528804621113,51.866420197495664,94.99672302908517,49.970247100900686,197.72489178844455,22.002196663328096,12.143022925417343,116.1342190038952,95.72916035044396),c(63.40922188455283,6.260181154399883,1.6940752596851483,54.397624806037626,11.7317412831055,19.44620356999121,103.88317792179807,2.1943560375152584,10.751643852657912,0.0,24.863611424858142,0.0,2.6128228691944626,3.808311657491799,6.261762637744213,9.140487087632376,34.862576577722436,43.98669209474949,30.114767484779,7.5401739853679945,12.11832247605039,8.525346938507644,13.821557708759764,16.424431905749387,14.458586378758461,31.032169698288765,20.824066855870864,61.94239787381669),c(47.246086894372695,14.398416655119732,1.6940752596851483,92.10506927385916,1.4664676603881874,19.44620356999121,35.3887748964367,46.08147678782043,1.791940642109652,10.299219382188143,2.7626234916509045,3.6274715592460614,0.0,102.82441475227857,4.69632197830816,7.478580344426489,14.94110424759533,14.662230698249832,23.066630413873277,9.048208782441595,34.90076873102512,21.922320699019654,20.200738189725808,29.05861029478738,10.686781236473646,14.841472464398976,34.43980287701719,1.4077817698594701),c(40.615057154811616,3.7561086926399296,24.84643714204884,17.926489992898762,123.18328347260774,15.124824998882051,84.47643039794568,18.652026318879695,0.0,1.7165365636980239,0.0,1.8137357796230307,6.532057172986157,16.185324544340144,180.80839616486415,0.0,31.874355728203373,55.39064930449936,8.970356272061832,34.18212206700158,47.01909120707551,29.229760932026206,9.568770721449068,11.370760550134191,61.606150657318665,23.611433466089277,15.217587317751784,7.038908849297351))
targetgene="Lars2"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(152.51368400990484,25.040724617599533,8.470376298425741,8.036012755437376,2.932935320776375,131.8020464188293,47.94608211775295,5.4858900937881465,14.335525136877216,10.299219382188143,0.0,7.254943118492123,6.532057172986157,261.8214264525612,147.93414231670704,22.435741033279466,92.63484633509105,73.31115349124916,24.348109881310684,1.0053565313823993,60.591612380251945,36.537201165032755,55.286230835039056,10.107342711230393,5.657707713427224,23.611433466089277,23.22684380077904,1.4077817698594701),c(406.5650109068387,251.0332642914353,119.71465168441713,147.12084890723813,98.25333324600855,58.33861070997362,238.58883720500873,50.47018886285095,204.28123320050034,164.7875101150103,861.9385293950822,174.11863484381095,28.741051561139088,260.8693485381882,129.1488544034744,58.16673601220603,151.403189708966,84.71511070099903,123.02202887399082,174.9320364605375,61.561078178335976,142.49508454362777,80.80295275890323,56.85380275067096,82.97971313026596,120.75561686942802,61.671274919309866,66.1657431833951),c(175.7222880983686,102.04095281671809,81.8803042181155,24.10803826631213,48.39343279281019,60.499299995528204,31.964054745168635,164.57670281364437,93.1809133897019,73.81107223901503,80.11608125787623,48.97086604982183,45.7244002109031,5.712467486237698,227.77161594794575,122.9810989972356,5.976441699038133,162.91367442499813,32.03698668593511,64.34281800847356,150.75193160206683,60.8953352750546,114.82524865738881,27.16348353643168,110.63961750702127,94.44573386435711,36.842579821925376,19.70894477803258),c(111.89862685509323,13.772398539679743,162.63122492977422,165.04733890013688,13.198208943493686,43.213785711091575,11.415733837560227,0.0,86.0131508212633,85.82682818490119,0.0,16.323622016607278,104.51291476777851,49.508051547393386,190.20104012148047,215.2169232451623,1.9921472330127108,27.69532465224968,12.174054940655342,52.781217897575964,47.98855700515954,15.832787171514195,23.390328430208832,31.58544597259498,23.888099234470502,40.476743084724475,93.70830085141888,0.0))
targetgene="Mecr"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(140.0805032482278,105.17104339391804,76.23338668583166,24.10803826631213,101.18626856678493,25.928271426654945,75.3438433278975,51.56736688160857,127.22778558978528,12.015755945886166,19.33836444155633,116.07908989587396,86.22315468341726,53.316363204885185,75.14115165293056,21.604787661676525,108.57202419919274,94.48993116649892,87.1406037857435,39.20890472391358,108.58016938541148,91.3430029125819,37.211886138968595,5.685380275067096,53.43390618236823,30.35755731354336,40.046282415136275,29.563417167048872),c(61.751464449662556,1.8780543463199648,27.669895908190753,0.0,0.0,0.0,0.0,18.652026318879695,0.0,5.149609691094072,33.151481899810854,14.509886236984245,0.0,0.0,0.0,1.6619067432058865,0.0,0.0,0.6407397337187022,4.524104391220797,30.053439740604965,20.704413993518564,10.631967468276741,38.53424408656587,16.973123140281672,23.611433466089277,16.819438614357235,11.262254158875761),c(48.07496561181783,23.788688386719556,36.140272206616494,9.272322410120049,87.98805962329125,0.0,0.0,0.0,7.167762568438608,0.0,0.0,0.0,18.289760084361237,0.0,19.568008242950665,57.335782640603085,16.933251480608043,11.40395720974987,18.581452277842363,12.566956642279992,1.4541986971260465,14.614880466013103,3.1895902404830228,0.6317089194518996,0.6286341903808027,16.190697233889793,8.009256483027254,0.0),c(59.26482829732715,0.0,6.21160928551221,6.799703100754703,4.399402981164562,8.642757142218315,3.424720151268068,4.388712075030517,0.0,41.19687752875257,41.439352374763565,1.8137357796230307,10.45129147677785,11.424934972475397,48.52866044251765,0.0,16.933251480608043,8.145683721249906,0.6407397337187022,14.57766970504479,3.8778631923361244,14.614880466013103,55.286230835039056,22.109812180816483,18.85902571142408,14.841472464398976,11.212959076238157,28.155635397189403))
targetgene="Nhlrc2"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(70.0402516241139,3.1300905771999417,13.552602077481186,21.017264129605447,10.265273622717313,10.803446427772894,122.14835206189443,5.4858900937881465,35.838812842193036,308.9765814656443,74.59083427457442,87.05931742190548,27.434640126541858,6.664545400610648,10.175364286334347,15.788114060455921,3.9842944660254216,102.63561488774883,44.21104162659045,40.716939520987175,39.26336482240326,69.42068221356224,20.200738189725808,54.958675992315264,44.63302751703699,62.73895178132294,12.013884724540883,21.116726547892053),c(85.3745078968489,61.349775313118855,15.811369090394717,6.181548273413366,29.32935320776375,2.1606892855545787,46.80450873399693,57.05325697539672,21.503287705315824,10.299219382188143,185.0957739406106,206.7658788770255,80.99750894502834,3.808311657491799,26.612491210412905,1.6619067432058865,26.893987645671597,21.17877767524976,80.73320644855647,26.139269815942384,15.026719870302482,15.832787171514195,12.758360961932091,80.22703277039125,82.35107893988516,49.92131647116019,60.870349271007136,115.43810512847655),c(70.45469098283647,78.87828254543852,18.070136103308247,70.46965031691238,1.4664676603881874,0.0,38.81349504770477,19.749204337637327,30.462990915864083,0.0,24.863611424858142,286.57025318043884,199.8809494933764,126.62636261160232,19.568008242950665,4.154766858014717,26.893987645671597,30.953598140749644,19.862931745279766,13.069634907971192,15.026719870302482,42.626734692538214,31.895902404830224,20.846394341912685,49.03346684970261,33.05600685252499,8.81018213132998,5.6311270794378805),c(129.30507992144106,14.398416655119732,165.45468369591615,42.65268308655223,24.929950226599185,77.78481427996483,272.8360387176894,39.49840867527465,73.46956632649574,0.0,281.78759614839225,7.254943118492123,2.6128228691944626,15.233246629967196,16.43712692407856,108.02393830838263,39.84294466025422,57.019786048749346,45.49252109402786,69.36960066538555,22.297713355932714,59.677428569553506,51.033443847728364,24.004938939172185,96.18103112826282,14.841472464398976,49.65739019476898,115.43810512847655))
targetgene="Noc2l"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Grk2","Atp2a2","Tmem14a","Xpr1","Mark2","Slitrk5","2410137M14Rik","C2cd5","Iqcf3","Fto")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27_vs_0 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(131.79171607377646,200.32579694079627,300.98070447072797,283.73306574967353,368.08338275743506,367.31717854427836,231.7393969024726,173.35412696370543,822.5007547283302,396.51994621424353,588.4388037216427,1238.78153748253,142.39884637109822,1237.7012886848347,493.1138077223568,742.0413608414283,99.60736165063554,219.9334604737475,353.6883330127236,436.3247346199613,447.40846581578035,360.5003848283232,309.3902533268532,483.25732338070316,778.2491276914337,590.9604490369774,535.8192587145234,306.8964258293645),c(127.23288312782822,928.3848651975027,622.2903120576777,524.1952935854534,146.64676603881875,1603.2314498814974,434.93945921104466,257.8368344080429,514.2869642854702,436.0002871792981,132.60592759924342,235.785651350994,986.3406331209096,258.9651927094423,970.573208850353,368.9432969917068,1184.3315300260565,405.65504931824535,500.4177320343064,455.9291869819181,400.8741075077469,246.01715451122058,452.9218141485892,543.2696707286336,928.4926991924456,786.5980406131457,648.7497751252076,522.2870366178635),c(192.71430180599387,71.99208327559866,406.57806232443556,441.36254672171435,2174.7715403556817,337.06752854651427,335.62257482427066,258.9340124268005,392.4350006220138,178.5198026245945,549.76207483853,384.5119852800825,122.80267485213975,286.5754522262579,567.4722390455693,83.92629053189727,484.0917776220887,806.4226884037407,318.44764765819497,530.3255703042156,516.2405374797465,669.8486880256006,649.6132123117089,794.6898206704897,1132.1701768758257,968.0687721096605,1137.3144205898702,926.3204045675313),c(209.29187615489658,718.0427784096665,172.23098473465674,743.640257291628,784.5601983076803,1322.3418427594022,609.6001869257161,505.79906664726707,1799.1084046780907,394.8034096505455,348.09055994801395,596.7190714959771,334.4413272568912,498.88882713142567,1390.1113055792152,858.3748328658404,1038.9047820161286,633.7341935132428,731.7247759067579,598.6898144382188,826.4695928666365,445.7538542133996,491.1968970343855,478.83536094453984,841.1125467295141,774.4550176877284,548.6340690873669,647.5796141353562))
targetgene="Grk2"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(98.2221280172485,97.65882600863817,2007.4791827269005,188.53722233910767,351.952238493165,220.39030712656702,256.8540113451051,1425.2342463661603,159.48271714775902,690.0476986066056,82.87870474952713,23.5785651350994,57.482103122278176,297.0483092843603,144.0205406681169,1034.5369476456644,90.64269910207834,158.0262641922482,105.72205606358587,541.384492149422,197.28628991010032,120.5727638446081,161.60590551780646,408.715670885379,200.53430673147605,355.52072676083,132.95365761825244,209.75948370906104),c(118.94409595337687,455.7411880403115,239.42930336883427,954.4310534150238,261.0312435490974,453.74474996646154,668.9620028810293,288.5578189332565,2555.3073556483637,2861.466451684606,1364.7360048755468,999.3684145722899,610.094139956907,295.1441534556144,648.8751533362441,629.031702303428,851.6429421129338,474.07879257674455,272.95512656416713,488.6032742518461,327.6794397524025,211.91576675719,176.49065997339392,283.005595914451,193.61933063728722,408.8151051557172,263.5045382915967,194.2738842406069),c(162.0457892605239,574.6846299739093,479.9879902441253,512.4503518659681,65.99104471746844,103.71308570661978,679.2361633348335,589.184596072847,159.48271714775902,2760.1907944264226,5074.939354162711,2691.5838969605775,981.1149873825207,380.8311657491799,183.93927748373625,2013.4000193939314,609.5970533018896,254.1453321029971,254.37367428632476,315.68195085407336,343.675625420789,319.0915568412861,292.3791053776104,281.7421780755472,436.90076231465787,532.2691715641269,249.08787662214763,280.14857220203453),c(105.68203647425472,209.0900505569561,92.60944752945477,43.8889927412349,211.17134309589898,123.15928927661099,20.548320907608407,77.89963933179168,120.06002302134668,96.12604756708933,41.439352374763565,165.04995594569579,111.04497194076465,6.664545400610648,160.45766759219546,40.71671520854422,56.77619614086226,198.75468279849773,180.68860490867402,149.2954449102863,113.42749837583163,186.33972594166707,202.00738189725809,63.80260086464185,89.26605503407399,149.76394941348056,104.12033427935431,132.3314863667902))
targetgene="Atp2a2"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(348.1290613269567,713.6606516015867,291.3809446658455,309.0774136706683,1061.7225861210477,760.5626285152117,703.20920439371,464.10630193447713,673.7696814332292,1021.3392554003242,1019.4080684191838,854.2695522024475,1192.7536397872723,619.8027222567903,669.2258819089128,695.5079720316635,761.0002430108556,593.0057749069932,505.54364990405605,316.68730738545577,433.8359446426039,587.0310320515263,409.33074752865457,360.70579300703463,528.681354110255,725.8829259860589,420.4859653589309,761.6099374939733),c(45.173890100759856,191.56154332463643,23.717053635592073,17.926489992898762,38.12815917009287,17.28551428443663,9.132587070048181,5.4858900937881465,0.0,242.03165548142135,2.7626234916509045,340.9823265691298,7.838468607583388,34.27480491742619,17.219847253796587,311.6075143511037,647.447850729131,26.0661879079997,95.47022032408663,111.09189671775512,32.961837134857056,70.63858891906334,71.23418203745418,66.96114546190135,22.630830853708897,33.730619237270396,23.22684380077904,43.641234865643575),c(39.78617843736648,65.73190212119877,18.070136103308247,14.217561028850742,168.64378094464155,17.28551428443663,19.406747523852385,78.9968173505493,0.0,6.8661462547920955,187.8583974322615,39.90218715170668,2.6128228691944626,19.041558287458994,242.64330221258825,93.89773099113259,127.49742291281349,43.98669209474949,29.4740277510603,37.198191661148776,23.751912053058764,37.75510787053385,21.263934936553483,29.05861029478738,55.94844294389144,72.18352516775865,57.66664667779624,45.049016635503044),c(20.721967936128376,2.5040724617599532,0.0,0.0,17.59761192465825,0.0,21.689894291364432,0.0,0.0,0.0,0.0,105.19667521813578,35.273108734125245,37.13103866054504,57.92130439913397,0.0,0.0,11.40395720974987,5.766657603468319,0.0,18.419850163596593,4.871626822004368,40.401476379451616,3.790253516711397,2.514536761523211,1.349224769490816,6.407405186421804,4.22334530957841))
targetgene="Tmem14a"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(123.08848954060254,193.43959767095637,147.94923934583628,47.59792170528292,123.18328347260774,166.37307498770255,31.964054745168635,229.31020592034452,68.09374440016677,6.8661462547920955,221.00987933207236,7.254943118492123,57.482103122278176,258.9651927094423,180.02567583514613,694.6770186600605,35.858650194228794,47.24496558324946,51.89991843121488,101.03833140393114,112.94276547678962,110.82951020059936,46.780656860417665,142.7662157961293,116.2973252204485,209.12983927107646,75.2870109404562,633.5017964367615),c(193.12874116471644,665.4572567127076,358.579263300023,1265.9810863950574,190.64079585046437,414.8523428264791,269.41131856642136,680.2503716297301,1542.8608928564104,307.2600449019463,1315.0087820258304,397.20813573744374,505.58122518912853,456.04532098464296,617.566340147523,1194.0799949934294,726.1376664331331,188.97986233299784,271.6736470967297,247.82038498576142,227.82446254974732,423.83153351438,141.40516732808067,576.7502434595843,306.7734849058317,390.6005707675912,438.1063296215909,342.09097007585126),c(271.4577799632817,458.24526050207146,376.6493994033313,1145.4408950634968,566.0565169098403,522.8868071042081,877.8699321083815,523.3539149473892,223.9925802637065,1526.0010051275433,165.75740949905426,243.0405944694861,715.9134661592827,233.2590890213727,1149.033444026063,840.9248120621786,767.9727583264,443.1251944359949,508.1066088389308,422.2497431806077,424.1412866617636,527.3536034819728,356.17091018727086,825.0118488041808,482.7910582124565,526.8722724861636,473.3470581469108,340.6831883059918),c(122.2596108231574,257.2934454458352,79.05684545197359,236.1351440443906,105.58567154794949,298.17512140653184,313.93268053290626,152.50774460731046,580.5887680435272,139.03946165953994,259.686608215185,674.7097100197674,318.7643900417244,182.79895955960635,158.8922269327594,672.2412776267811,95.62306718461012,265.54928931274696,292.1773185757282,90.48208782441594,168.2023159675794,142.49508454362777,211.57615261870717,168.66628149365718,221.90786920442335,406.791268001481,182.6110478130214,268.8863180431588))
targetgene="Xpr1"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(180.69556040303942,485.7900575814309,229.26485181072337,485.25153946294927,533.7942283813002,194.4620356999121,297.9506531603219,1480.0931473040418,279.5427401691057,2167.985679950604,933.7667401780058,2776.82947860286,296.5553956535715,497.9367492170527,331.09069947072527,372.2671104781186,303.8024530344384,482.2244762979945,256.2958934874809,444.8702651367117,395.0573127192427,310.56620990277844,296.6318923649211,442.1962436163297,390.3818322264785,296.8294492879795,389.2498650751246,477.23801998236036),c(172.82121258731064,296.73258671855444,210.06533220095838,244.17115679982797,614.4499497026505,38.89240713998242,399.55068431460796,129.46700621340025,603.8839963909527,169.93711980610436,535.9489573802755,458.87515224462675,262.5886983540435,676.9273971191673,407.01457145337383,251.7788715956918,1073.7673585938512,384.4762716429956,315.24394898960145,260.38734162804144,208.91987948710872,297.1692361422664,109.50926492325044,216.67615937200154,257.1113838657483,475.6017312455126,232.2684380077904,457.5290752043278),c(214.2651484595674,413.1719561903923,668.0303440691767,200.28216405859308,64.52457705708025,196.62272498546668,304.80009346285806,826.1750481244948,73.46956632649574,453.1656528162783,701.7063668793297,134.21644769210428,1348.2166005043428,633.1318130580116,171.41575220824782,1187.432368020606,380.5001215054278,347.00612652524603,495.2918141645568,349.3613946553838,259.8168338865203,244.7992478057195,345.5389427189941,333.54230947060296,756.8755652184865,279.9641396693443,365.2220956260428,336.4598429964134),c(163.2891073366916,155.87851074455708,85.2684547374858,249.7345502459,196.5066664920171,116.67722141994724,178.08544786593953,334.6392957210769,60.925981831728166,37.76380440135652,309.4138310649013,246.66806602873217,496.4363451469479,86.63909020793842,341.2660637570596,247.6241047376771,302.806379417932,130.3309395399985,126.22572754258434,179.95881911744948,237.0343876315456,126.66229737211356,169.0482827456002,322.80325783992066,198.64840416033365,360.24301345404785,113.73144205898703,140.778176985947))
targetgene="Mark2"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(124.33180761677025,208.4640324415161,210.06533220095838,100.75923685663787,96.78686558562038,41.05309642553699,175.8023010984275,181.03437309500882,277.75079952699605,115.0079497677676,85.64132824117804,321.03123299327643,181.59118940901516,74.26207732109008,113.49444780911386,317.4241879523243,92.63484633509105,81.45683721249907,142.8849606192706,152.3115145044335,127.48475244805009,124.22648396111137,141.40516732808067,126.34178389037992,257.1113838657483,167.30387141686117,144.16661669449059,56.31127079437881),c(247.00585779865023,279.2040794862348,136.65540428126863,322.0586650448364,180.37552222774704,522.8868071042081,300.23379992783396,210.6581796014648,28.67105027375443,1162.0952536235623,4826.30323991413,424.41417243178915,283.4912813075992,262.7735043669341,128.36613407375637,560.0625724603838,347.62969216071804,309.5359814074965,250.52923588401256,260.89001989373264,369.36646907001585,256.9783148607304,316.8326305546469,283.005595914451,500.39281554311896,236.7889470456382,370.0276495158592,344.9065336155702),c(17.406453066347833,363.09050695519323,250.7231384334019,2.4726193093653466,10.265273622717313,0.0,148.40453988828295,19.749204337637327,0.0,1407.5599822323795,85.64132824117804,88.8730532015285,32.660285864930785,27.610259516815542,86.09923626898293,13.295253945647092,84.6662574030402,107.52302512049877,70.48137070905724,57.80800055448796,16.965651466470543,64.54905539155787,0.0,57.48551167012286,27.659904376755318,11.468410540671936,38.44443111853082,67.57352495325456),c(45.173890100759856,31.926923887439404,82.44499597134387,80.9782823817151,63.05810939669206,21.606892855545787,33.10562812892466,6.583068112545775,7.167762568438608,18.88190220067826,2.7626234916509045,107.01041099775881,5.225645738388925,103.77649266665152,86.88195659870095,109.68584505158852,116.54061313124357,50.50323907174942,67.27767204046373,65.34817453985596,70.28627036109225,37.75510787053385,49.970247100900686,55.59038491176716,30.17444113827853,20.238371542362238,63.27312621591531,14.077817698594702))
targetgene="Slitrk5"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(95.73549186491309,382.4970685338329,146.8198558393795,106.94078513005124,30.795820868151935,151.2482499888205,132.42251251569863,19.749204337637327,69.88568504227642,17.16536563698024,85.64132824117804,348.2372696876219,66.62698316445879,273.2463614250366,83.75107527982885,85.58819727510316,192.2422079857266,149.8805804709983,207.5996737248595,129.18831428263832,133.7862801355963,274.0290087377457,131.8363966066316,161.71748337968629,157.78718178558148,122.77945402366424,166.5925348469669,278.74079043217506),c(344.39910709845356,498.9364380056707,394.1548437534111,228.71728611629456,310.89114400229573,671.974367807474,421.24057860597236,367.5546362838058,333.30095943239525,559.5909197655558,1093.9989026937583,865.1519668801857,1239.7844514327726,692.1606437491345,386.66384288070515,535.1339713122954,406.398035534593,566.9395869989935,442.1104162659045,338.8051510758686,275.8130195549069,407.9987463428658,508.20804498362827,281.7421780755472,362.09329365934235,408.14049277097183,511.7914892654416,747.5321197953787),c(114.38526300742862,192.8135795555164,273.31080856253726,362.2387288220233,124.64975113299593,66.98136785219194,110.7326182243342,130.56418423215788,19.711347063206173,46.346487219846644,85.64132824117804,457.06141646500373,150.2373149786816,139.9554534128236,90.79555824729108,34.900041607323615,372.5315325733769,172.68849489049802,120.459069939116,221.68111516981907,185.16796743404993,189.99344605817035,135.0259868471146,118.76127685695711,124.46956969539893,161.2323599541525,140.9629141012797,228.06064671723416),c(108.99755134403524,369.97670622503307,225.8767012913531,467.3250494700505,256.6318405679328,60.499299995528204,207.76635584359613,265.5170805393463,175.6101829267459,1836.6941231568856,82.87870474952713,1140.8398053828862,169.83348649764008,289.4316859693767,141.6723796789628,63.152456241823685,71.71730038845759,299.7611609419966,160.82567316339424,237.76681967193744,315.56111727635215,239.92762098371512,161.60590551780646,150.978431749004,196.76250158919126,258.37654335749124,99.31478038953796,242.13846441582885))
targetgene="2410137M14Rik"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(149.1981691401243,68.86199269839871,40.093114479215174,28.435122057701484,366.61691509704684,429.97716782536116,138.13037943447875,29.62380650645599,731.111781980738,379.3545805772633,135.36855109089433,241.2268586898631,1169.2382339645221,355.12506206111027,61.834906047724104,122.15014562563266,115.54453951473722,215.04605024099754,142.2442208855519,191.01774096265586,108.09543648636947,219.22320699019656,167.98508599877252,205.30539882186736,172.24576816433995,234.09049750665656,170.59716308848053,143.59374052566596),c(271.4577799632817,344.3099634919936,683.2770214063431,214.4997250874438,105.58567154794949,1168.932903485027,922.3912940748663,3001.8790593208737,516.0789049275797,676.3154060970214,560.8125688051337,658.3860880031601,237.7668810966961,659.7899946604542,457.8913928850456,2375.6956894128148,129.4895701458262,219.9334604737475,404.94751171021977,453.4157956534621,349.97715310833524,193.64716617467363,415.7099280096206,531.2672012590475,379.06641679962405,374.40987353370144,301.1480437618248,571.5593985629449),c(196.0298166757744,994.1167673187015,785.4862287406804,427.76314052020496,195.04019883162894,300.33581069208645,879.0115054921374,197.49204337637326,1130.7145451711904,1877.8910006856381,91.16657522447984,335.5411192302607,189.42965801659855,358.93337371860207,285.69292034707973,368.9432969917068,314.7592628160083,257.40360559149707,347.9216754092553,330.76229882480936,425.1107524598476,232.62018075070856,179.68025021387695,686.6675954442148,514.8514019218774,738.7005612962217,584.6757232609896,498.35474653025244),c(49.732723046708095,93.27669920055826,102.77389908756565,862.3259841411647,825.6212927985496,406.2095856842608,78.76856347916556,113.00933593203581,600.3001151067334,121.8740960225597,60.777716816319895,827.063515508102,269.12075552702964,34.27480491742619,705.231017075942,199.42880918470638,102.5955825001546,48.87410232749944,53.18139789865228,82.94191383904794,128.93895114517613,97.43253644008735,49.970247100900686,104.23197170956342,317.4602661423054,269.1703415134178,36.041654173622646,281.556353971894))
targetgene="C2cd5"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(60.92258573221742,147.11425712839724,193.12457960410688,561.2845832259337,4.399402981164562,86.42757142218315,361.8787626506592,470.6893700470229,137.9794294424432,27.464585019168382,80.11608125787623,206.7658788770255,158.07578358626498,921.6114211130154,97.84004121475333,105.53107819357379,34.862576577722436,141.73489674974837,104.44057659614846,183.47756697728786,135.24047883272235,73.07440233006551,32.9590991516579,195.82976503008885,204.30611187376087,113.33488063722854,148.17124493600423,170.3415941529959),c(325.749335955938,454.4891518094315,375.5200158968745,103.23185616600323,327.0222882665658,494.7978463919985,94.75059085174988,184.3259071512817,87.80509146337295,554.4413100744617,660.2670145045662,281.12904584156973,210.33224097015423,146.61999881343425,377.2711989240888,51.51910903938248,162.35999949053593,335.60216931549616,265.2662497595427,328.75158576204456,205.04201629477257,278.90063555975007,179.68025021387695,250.15673210295222,322.4893396653518,113.33488063722854,142.56476539788514,330.82871591697545),c(296.73858084535834,227.87059402015575,576.5502800461787,110.03155926675792,357.81810913471776,447.2626821097978,106.16632468931012,202.97793347016142,433.64963539053576,1079.7014985660571,801.1608125787623,217.64829355476368,479.4529964971839,185.6551933027252,214.4653703427393,86.4191506467061,375.519753422896,177.57590512324796,170.4367691691748,295.0721419607342,219.09927036699102,214.35158016819219,133.96279010028695,241.31280723062562,211.8497221583305,172.02615811007902,184.21289910962687,201.31279308990423),c(178.62336360942658,65.73190212119877,294.7690951852158,86.54167582778713,74.78985067979755,103.71308570661978,125.57307221316249,26.3322724501831,261.6233337480092,267.77970393689174,71.82821078292352,215.83455777514064,32.660285864930785,372.26246451982337,385.88112255098713,172.00734792180924,159.37177864101687,203.64209303124767,140.3220016843958,170.4079320693167,178.86643974650374,113.26532361160154,153.1003315431851,190.14438475502178,79.83654217836194,193.6137544219321,165.7916091986642,147.81708583524437))
targetgene="Iqcf3"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(249.49249395098562,339.30181856847366,197.64211362993396,256.5342533466547,551.3918403059585,462.38750710867987,503.433862236406,547.491831360057,154.10689522143008,595.6381876032143,397.8177827977303,168.67742750494185,394.53625324836383,434.1475289540651,262.99403078525694,427.94098637551576,314.7592628160083,327.45648559424626,349.2031548766927,298.5908898205726,337.8588306322848,216.78739357919437,305.13746633954247,358.81066624867896,316.8316319519246,385.87828407437337,241.07862013912037,287.18748105133193),c(125.98956505166052,205.33394186431616,139.47886304741053,338.74884538305247,266.8971141906501,239.83651069655824,284.25177255524966,103.13473376321714,240.12004604269336,49.77956034724269,102.21706919108347,83.43184586265942,300.4746299573632,49.508051547393386,115.84260879826795,183.64069512425047,109.56809781569909,102.63561488774883,158.90345396223813,159.8516884898015,168.6870488666214,169.28903206465176,133.96279010028695,123.81494821257232,182.9325494008136,170.67693334058822,208.24066855870862,150.6326493749633),c(154.58588080351768,207.21199621063613,339.379743690258,483.39707498092525,281.561790794532,177.17652141547546,257.9955847288611,710.9713561549437,227.5764615479258,1277.1032033913298,795.6355655954605,1289.566139311975,320.07080147632166,223.7383098776432,677.053085206093,237.65266427844176,434.28809679677096,384.4762716429956,292.1773185757282,231.23200221795184,201.16415310243644,107.17579008409609,145.65795431539135,315.85445972594977,309.28802166735494,266.4718919744361,188.2175273511405,475.8302382125009),c(101.12320352830646,276.0739889090348,152.46677337166332,25.344347920994803,10.265273622717313,494.7978463919985,57.07866918780113,50.47018886285095,44.7985160527413,1795.497245628133,121.55543363263979,638.4349944273068,167.2206636284456,109.48896015288922,93.9264395661632,282.5241463450007,157.37963140800414,47.24496558324946,148.6516182227389,131.19902734540312,63.500009774504036,103.52206996759281,212.63934936553483,78.96361493148744,165.33079207015112,93.77112147961171,64.87497751252077,133.73926813664966))
targetgene="Fto"
collabel=c("In.vivo.input.Pool.E..33.40._1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._BM_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1909_Pool.E..33.40._BM_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1896_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1897_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1898_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1899_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1902_Pool.E..33.40._BM_mCD19_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1895_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1890_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1891_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1892_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1893_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1894_Pool.E..33.40._SP_hEGFRv3_15m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1903_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1904_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1905_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1906_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438","In.vivo_AR1907_Pool.E..33.40._SP_mCD19_10m_1431..1432..1433..1434..1435..1436..1437..1438")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("invivo.poolE_all_v_input_summary.Rnw");
library(tools);

texi2dvi("invivo.poolE_all_v_input_summary.tex",pdf=TRUE);

