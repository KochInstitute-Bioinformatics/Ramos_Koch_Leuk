pdf(file='batch.pdf',width=4.5,height=4.5);
gstable=read.table('batch.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Rpl13a","Btbd35f4","Rack1","Aasdhppt","Rpl31","Rps10","Rpl37","Pes1","Rpl8","Vmn1r163")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='KA1.RPMI_5,KA2.RPMI_5,KA3.RPMI_5,KA4.MPM_5,KA5.MPM_5,KA6.MPM_5,KA7.RPMI_21,KA8.RPMI_21,KA9.RPMI_21,KA10.MPM_21,KA11.MPM_21,KA12.MPM_21,AR2466_BM,AR2466_SP,AR2467_BM,AR2467_SP,AR2468_BM,AR2468_SP,AR2469_BM,AR2469_SP,AR2473_BM,AR2473_SP,AR2474_BM,AR2474_SP,AR2475_BM,AR2475_SP,AR2476_BM,AR2476_SP,AR2480_BM,AR2480_SP,AR2481_BM,AR2481_SP,AR2482_BM,AR2482_SP,AR2483_BM,AR2483_SP,ahEGFRv3_1to10rep1,ahEGFRv3_1to10rep2,ahEGFRv3_1to10rep3,ahEGFRv3_1to2rep1,ahEGFRv3_1to2rep2,ahEGFRv3_1to2rep3,amCD19_1to10rep1,amCD19_1to10rep2,amCD19_1to10rep3,NoCAR_T_rep1,NoCAR_T_rep2,NoCAR_T_rep3,amCD19_1to2rep1,amCD19_1to2rep2,amCD19_1to2rep3,Input1_DOI_rep1,Input1_DOI_rep2,Input1_DOI_rep3,Input2_ACT_rep1,Input2_ACT_rep2,Input2_ACT_rep3_vs_pDNA_CP1704 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(492.08810413543284,83.28009755176328,56.44662158000607,69.76591407706663,83.11258265459423,64.37108150717225,65.54022237748174,59.79779715021537,70.62564047867292,100.37519719619742,90.29892741662164,76.49876795369671,96.50148949020002,36.1140080738919,11.231015513877459,30.834617753488182,58.88450906926491,34.45544679480773,31.322050455496782,59.85054503464857,74.61338095007926,255.25941429909238,70.04927768332989,92.77377297445209,120.12525444322345,9.247893638594729,438.3510512219661,6.071352071365914,23.14320549756373,30.43547767375932,106.03166489927585,5.667495356484729,0.0,19.20200698254601,5.624192181837055,63.261845820509954,97.20071127155697,67.62390885508782,87.45799114461175,108.70477607861856,64.57653619421677,71.9510962895145,54.47916657110475,42.71467941683944,36.459736834371036,67.1566062782438,72.05361799364344,63.81822704439999,88.43834544726336,48.39815388219106,42.52059356394556,58.67511812837953,238.30379316062795,259.7537258876671,248.91396913126994,116.47046615765849,119.55120897765396,112.81673805918585),c(595.3512637843874,147.5247442345521,147.38840079223806,177.79055522865366,34.54029409022098,44.10611140306247,19.385136196156573,178.459050870174,221.3842191927632,203.5646522577088,17.056464067584088,34.58163482838345,9.554602919821782,235.40983040759167,26.9544372333059,40.701695434604396,50.472436345084205,20.099010630304505,55.6836452542165,9.771517556677317,138.3739064892379,0.0,96.3177568145786,11.59672162180651,13.650597095820846,55.48736183156837,104.82307746612233,0.0,6.037357955886191,37.19891715681695,118.19923300247144,209.69732818993498,129.93762865744375,20.573578909870726,53.42982572745202,10.767973756682546,48.600355635778484,150.92872411135542,100.34653720802821,117.76350741850344,91.32967261753515,95.28658697800569,108.03495743761451,166.50007691053742,121.8796917034689,139.17963330128785,137.3822316412135,166.68939899656715,133.12298314693325,70.61868994131024,94.35226601050694,88.0126771925693,307.9286965840644,296.21648152697867,272.20416507337706,163.77794766112547,161.0407030958629,153.97182362669497),c(459.292079182546,28.553176303461697,90.94177921223199,51.76180721846879,104.70026646098235,79.8678233514915,85.84846029726482,152.29751461695477,105.9384607180094,122.88926011870899,94.31221307958259,76.49876795369671,91.72418803028911,62.865125165663684,316.7146374913443,75.23646731851116,338.88635831699395,40.19802126060901,109.04713862284065,32.978871753785945,180.4287212065553,34.22472593954311,159.79991471509632,0.0,128.31561270071595,90.1669629762986,257.2930083259366,71.6419544421178,130.80942237753413,13.526878966115254,146.01081723834707,30.226641901251888,3.8216949605130517,134.41404887782207,113.88989168220036,2.6919934391706364,83.02560754445491,113.68657140855342,124.2824084686588,138.59858950023866,102.39993596511518,98.20352331406708,92.33757045949957,102.86392186096029,127.08822553695047,108.0345405345661,109.52149935033803,120.01636727752835,107.05694448879248,69.09673541671303,81.0063862787576,75.84071119785227,231.84375057494827,218.42926949644735,231.15519472541325,113.70394677149083,127.23444862917412,109.36316444512914),c(451.7578572339098,103.50526410004865,197.56317553002123,110.27515450891177,197.52730682845123,194.3053015864644,167.08141197639713,116.79257255901439,175.20591580286168,108.81797079213925,210.69749730545047,171.86024581378442,175.8046937247208,77.57823956613817,53.9088744666118,291.07879159292844,129.78626488735938,358.91090411258045,270.29769467150925,92.82941678843451,81.39641558190465,39.928846929466964,21.89039927604059,124.66475743442,105.10959763782051,30.05565432543287,142.9405601810759,303.5676035682957,313.94261370608194,371.98917156816947,344.168354918961,498.73959137065617,189.17390054539607,785.9107143570618,302.3003297737417,104.98774412765482,115.42584463497391,87.22504185656254,96.66409547562351,95.11667906879124,179.89177939817532,120.56670189053781,152.3569912581743,127.27231009915425,123.96310523686152,112.90096127936638,148.91081052019646,123.82641068316416,156.39623194884467,132.71443454487613,119.18180969748245,121.7196599471703,332.3333019077432,304.550825673107,310.63298837785385,193.37970509311944,187.77837708315312,216.13614867971575),c(431.9620583884736,83.28009755176328,120.73305171279074,229.55236244712245,90.66827198683008,70.33136683191043,92.31017236265035,98.10576094957209,123.59487083767762,119.13691629829039,68.22585627033635,95.36147786008769,80.25866452650298,81.59090712990393,87.60192100824418,90.03708384018549,106.9534960645832,111.9802020831251,52.20341742582797,502.01171447429715,70.54356017098404,9.982211732366741,100.69583666978671,18.84467263543558,139.23609037737265,2.311973409648682,0.0,10.928433728458646,22.1369791715827,89.61557315051355,152.963713297316,79.3449349907862,89.80983157205671,829.8010160314526,130.7624682277115,0.0,0.0,130.34753445980695,104.02897894043292,125.01049249041135,99.63237012822017,67.08953572941216,77.56355918597964,80.19898992549446,83.33654133570522,106.087972236646,80.70005215288066,72.39082470708058,84.71462563895753,46.87619935759386,50.9005645582998,52.745185977107134,238.30379316062795,225.72182062430966,200.58681255139763,109.55416769223935,120.16586814977556,101.59262381350155),c(360.9040043238855,36.88118605863802,23.51942565833586,18.00410685859784,117.65287674481522,122.78187768960633,148.61937750386704,28.030217414163452,51.611044965184064,45.96621180012779,57.1893206971937,76.49876795369671,94.59056890623565,10.700446836708712,19.092726373591677,23.434309492651018,85.32245191668997,10.049505315152253,84.68554382412093,12.214396945846646,67.83034631825387,9.982211732366741,48.1588784072893,0.0,32.761433029970036,0.0,0.0,0.0,1.0062263259810318,11.836019095350848,88.64942475185359,149.2440443874312,55.41457692743925,83.66588756680763,43.58748940923717,98.25776052972823,83.02560754445491,63.70368225479287,59.83967815157646,63.41111937919416,50.73870700974175,56.39410249718704,61.866172207864714,91.53145589322737,88.5450751691868,98.30169904496556,76.857192526553,63.81822704439999,67.95788650158131,90.09970785615444,84.11007923962954,92.0699991908083,186.26456122043058,170.5067906562093,176.13210681218516,73.03611179482623,79.90569237580983,56.408369029592926))
targetgene="Rpl13a"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(381.43845237997226,80.90066619314148,363.76711684892797,153.03490829808163,131.6848712189675,97.74867932570601,189.2358533434332,124.26729720279131,134.46035398824267,98.49902528598813,162.53806934991894,89.0739078912907,90.76872773830694,56.17734589272074,74.12470239159123,210.90878543385915,231.93286225241076,30.14851594545676,147.3296447351145,85.50077862092652,78.6832017291745,48.48502841435274,50.34791833489336,313.1114837887758,81.90358257492508,693.5920228946046,323.9986030771054,55.85643905656641,83.51678505642563,32.12633754452373,50.40849642752459,9.445825594141215,116.56169629564808,9.601003491273005,150.4471408641412,201.89950793779772,60.75044454472311,172.4899704129776,154.6625527609976,133.16335069630773,164.20890632243695,150.70837736317225,156.0504940765543,212.70166893283314,222.9252480730115,250.13402628273414,188.30012169005488,141.92411685993432,140.5704227635449,197.24530638779754,182.8075153953572,212.22915067711745,258.0428121724269,245.5158879713645,238.43338095732173,187.84666632078412,165.0359877146534,200.59506741646055),c(418.81410243889286,97.55668570349414,26.65534907944731,92.27104765031393,112.25595579321819,101.32485052054892,140.31146199122853,85.02499282296247,57.04378654046659,129.45586180444153,62.2059277758949,73.35498296929822,85.99142627839605,42.80178734683485,31.44684343885688,186.24109123106862,32.446566221839845,91.8811914528206,24.361594798719718,6.107198472923323,32.55856623276186,8.556181484885778,24.07943920364465,37.68934527087116,20.47589564373127,0.0,47.64685339369197,25.49967869973684,29.18056345344992,128.50535017809491,31.28803226536009,300.37725389369064,309.5572918015572,1.3715719273247151,22.49676872734822,8.07598031751191,70.87551863551029,68.60396550516155,65.36334075018351,58.88175370925172,84.87201899811348,81.67421740971916,96.95444898247456,92.40318404459144,67.7109398352605,66.18332212928374,57.642894394914755,70.48580300426268,56.78672707666384,59.35622645929093,73.86789246875215,85.51586365519144,232.20264182970826,186.13368593019996,201.751322348503,98.4880901475687,101.41876340006634,86.05154255024635),c(507.45200771696545,45.209195813814354,28.223310790003033,74.2669407917161,24.82583637734633,11.920570649476343,29.53925515604811,40.17664496030095,42.10374720843963,62.85175899201147,46.15278512405106,39.8212764690476,20.064666131625746,42.80178734683485,73.00160084020348,75.23646731851116,98.5414233404025,34.45544679480773,46.403037711847084,1.2214396945846646,24.418924674571397,32.79869569206215,30.646558986456828,5.798360810903255,31.396373320387948,0.0,0.0,0.0,12.074715911772381,8.454299353822034,71.26718460443132,0.0,30.573559684104413,2.7431438546494302,74.52054640934098,6.729983597926591,18.225133363416933,96.04555170722617,92.9816537432188,92.39905966682578,98.7098481825885,92.36965064194429,105.26483032382951,45.32986387093165,37.50144360106735,31.14509276672176,74.93576271338918,93.34606343807759,81.92183578272815,42.00594487888281,35.07173045785291,29.025457372017534,269.88622357950635,242.39050891656638,212.81416542100388,109.00086381500581,85.43762492490437,72.8128436963623),c(477.61057960668103,22.604597906907177,205.40298408279983,31.50718700254622,65.84243560948374,40.529940208219564,67.38642582473476,26.16153625321922,28.521893270233296,29.080664608244113,56.18599928145346,24.10235154705513,65.9267601467703,30.76378465553755,81.98641325130545,108.5378544922784,100.94487269016841,47.37623934286062,20.881366970331186,26.871673280862623,47.48124242277771,37.07678643450504,32.83559891406089,21.743853040887206,113.29995589531303,18.495787277189457,57.17622407243036,13.35697455700501,65.40471118876707,10.14515922458644,36.50270430958677,11.334990712969457,53.50372944718272,122.06990153189965,151.85318890960048,71.33782613802187,95.17569645339954,52.92305910398177,59.83967815157646,48.01127610138987,91.32967261753515,98.20352331406708,99.72457609625954,67.12306765503341,71.87776690204576,70.07645872512396,47.07503042251372,63.81822704439999,85.64555559103398,96.18752595454325,86.90340290441429,73.34389766047441,216.41142662026905,230.23625703679585,209.0295085804115,100.42465371788606,100.80410422794472,110.22655784864332),c(365.63135927204934,132.05844040351036,134.84470710779226,40.50924043184514,144.63748150280037,81.05988041643913,101.54118959891538,46.717029023605754,51.611044965184064,79.73730618389514,64.21257060737538,71.25912631303257,93.63510861425347,40.12667563765767,59.524382223550525,86.3369297097669,34.85001557160576,182.32673928919087,183.29199896179597,169.7801175472684,81.39641558190465,65.5973913841243,50.34791833489336,79.72746114991976,173.36258311692475,62.42328206051442,123.88181882359912,26.71394911401002,39.24282671326024,431.1692670449237,41.71737635381345,18.89165118828243,95.54237401282629,35.660870110442595,82.95683468209656,30.95792455046232,14.175103727102059,104.8660615578898,86.53738071151056,91.49318653283729,77.49184343306013,69.0341599534531,97.87782468706955,88.04454328777109,79.16971426891996,88.568857555365,92.22863103186361,100.01363939794028,77.26718602234588,99.23143500373766,84.11007923962954,80.52223658043575,202.41466768462976,221.9019128906675,190.6884792760021,103.74447698128725,107.25802553522166,114.25572706504282),c(505.2360600850136,114.21270521384679,100.34954947556633,38.25872707452041,104.70026646098235,91.78839400096784,102.46429132254188,119.59559430043073,134.46035398824267,89.11816573494163,114.3786413943874,138.3265393135338,104.14517182605744,254.1356123718319,618.8289548146479,229.40955608595206,151.41730903525263,14.356436164503219,221.57450507406983,174.66587632560703,344.57815929672967,145.45508524305822,126.96431580103543,30.44139425724209,124.2204335719697,27.743680915784186,104.82307746612233,524.564818966015,179.10828602462365,20.29031844917288,95.60232081082249,24.55914654476716,17.197627322308733,58.97759287496275,320.5789543647121,10.767973756682546,93.15068163524211,66.64385220501407,77.3312763804988,94.21080593480275,87.63958483500848,93.34196275396475,102.49470321004452,140.34823236961532,134.38017290382467,114.8475295772865,103.75720991084656,81.91593322117014,99.60950487218084,97.40508957422101,112.97442377573857,114.22921933503675,282.4474174961057,283.71496530778614,269.0017631313373,99.318045963419,105.72137760491763,92.95868977835977))
targetgene="Btbd35f4"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(448.0646111806568,83.28009755176328,15.67961710555724,45.0102671464946,25.905220567665737,11.920570649476343,8.30791551263853,40.17664496030095,46.17830338990153,28.142578653139463,13.043178404623125,19.9106382345238,23.886507299554456,252.79805651724334,119.04876444710105,201.04170775274292,33.648290896722806,255.5445637281573,192.5726065041654,35.42175114295527,131.5908718574125,1.426030247480963,28.457519058852768,49.286066892677674,83.26864228450717,284.3727293867879,114.35244814486072,24.285408285463657,190.176775610415,257.01070035618983,24.33513620639118,0.0,0.0,9.601003491273005,150.4471408641412,47.109885185486135,70.87551863551029,26.461529551990886,35.90380689094587,19.929208947746737,28.598180314581715,46.670981376982375,39.70515529758482,57.534057990028636,48.96021803472682,47.690923299042694,45.153600609349894,46.673031719038796,41.89184784344054,30.134699587024624,27.00212875958587,26.21654214246745,197.74908137275,226.41634930315368,209.0295085804115,73.03611179482623,68.53449769155998,56.98396463193571),c(483.2243136076256,117.7818522517795,92.50974092278771,67.5154007197419,84.19196684491365,102.51690758549655,107.0797999406744,147.6258117145942,148.042207926449,123.82734607381363,139.46167678789342,151.9496075792606,210.20126423607923,442.730987868823,160.60352184844766,50.56877311572062,25.236218172542102,60.29703189091352,222.734581016866,68.40062289674123,58.33409783369833,25.668544454657333,291.1423103713399,33.34057466269372,215.67943411396936,67.04722887981178,38.117482714953574,33.999571599649116,89.55414301231183,145.413948885739,290.2834104619519,7.556660475312972,40.127797085387044,1440.1505236909509,275.5854169100157,161.51960635023818,38.475281544991304,118.5868546589221,151.90072146169408,127.72811189237682,99.63237012822017,126.40057456266061,119.11546589275446,81.94244622822261,80.21142103561628,91.48871000224517,94.15006084502744,115.25381302048356,104.2641546325631,69.40112632163247,76.0404775413625,74.59230442916333,272.7573536175862,304.203561333685,294.0387237691025,141.6457925717842,168.7239427473831,160.8789708548084),c(453.3828854973412,111.83327385522497,156.7961710555724,47.26078050381933,98.22396131906592,152.5833043132972,100.61808787528888,128.93900010515188,172.48954501522041,135.08437753506942,96.31885591106308,100.60111950075185,111.78885416191486,30.76378465553755,223.4972087261614,271.344636230696,149.0138596854867,83.26732975411868,112.52736645122918,180.77307479853036,101.74551947738081,31.372665444581184,483.77782400049705,7.247951013629069,92.82406025158176,46.239468192973646,57.17622407243036,49.78508698520049,94.58527464221699,8.454299353822034,33.02625628010232,7.556660475312972,135.67017109821333,68.57859636623576,101.23545927306698,203.24550465738304,83.02560754445491,147.00849751106045,138.09156496517645,130.44573129434227,101.4774140194835,140.01294413094712,118.19209018815945,101.99219370959622,107.29579696972048,117.76738202416665,148.91081052019646,138.11407345429848,131.26112324278034,68.79234451179359,52.14204174264857,64.2929485874797,306.13424031026454,294.1328954904466,299.2790178560766,214.40525242799367,204.6815043164975,196.27810039888968),c(565.2143759898428,186.78536165181194,249.30591197836011,193.54414872992677,181.33654397366016,194.3053015864644,189.2358533434332,301.79200749249316,357.20275857482653,241.08809046189472,257.85360384524176,249.40694209561397,237.9096127035624,61.5275693110751,115.67945979293782,71.53631318809258,63.691407768796736,50.24752657576126,222.734581016866,179.5516351039457,124.80783722558714,185.3839321725252,70.04927768332989,247.87992466611416,189.74329963190976,589.553219460414,257.2930083259366,282.9250065256516,120.74715911772381,23.672038190701695,73.00540861917354,49.11829308953432,137.58101857846987,12.344147345922437,53.42982572745202,203.24550465738304,117.45085945313134,283.2363718713098,351.67318544464933,294.4087685462586,353.3259051769289,356.8385451115111,324.1048723128435,259.7749891064929,289.59448114157567,281.2791190494559,353.54308562214385,313.37607011354623,320.239903514301,257.8190964667662,260.39983941715565,318.34372601567617,390.83257643362026,396.92313995936297,361.28916455193684,284.951496775269,267.68406945896294,314.8507944815034),c(421.9164291236254,21.414882227596273,48.606813027227446,65.26488736241717,83.11258265459423,89.40427987107257,105.23359649342139,102.77746385193267,50.25285957136343,129.45586180444153,106.35207006846548,130.99104101660396,150.00726584120198,46.81445491060062,33.69304654163238,193.6413994919058,56.481059719498994,24.40594147965547,67.28440468217828,87.94365801009585,104.45873333011097,7.130151237404815,39.402718696873066,13.046311824532324,9.555417967074593,97.10288320524465,152.4699308598143,3.6428112428195485,38.23660038727921,995.9164638802356,403.2679714201967,0.0,0.0,4.114715781974145,89.98707490939287,56.531862222583364,46.575340817621054,80.36464530604638,80.09310767980234,75.1874701210445,93.1747165087985,126.40057456266061,120.03884159734945,81.07071807685853,102.0872631362389,100.24826734288567,64.36789874098814,85.72597662680596,90.30020535141627,73.05381718066576,75.7301082452753,77.0891179665412,265.22063726762656,254.54476079633687,212.23191052245122,119.51363748244292,113.4046172564378,91.5197007725028),c(467.5649503418328,47.58862717243616,95.64566434389916,105.77412779426231,77.71566170299721,102.51690758549655,87.69466374451783,81.28763050107402,93.71479217362369,79.73730618389514,59.195963528674184,99.55319117261902,88.85780715434258,94.96646567578982,236.97442734281438,65.36938963739495,135.7948882617742,318.7128828519715,225.05473290245837,112.37245190178915,90.8926640664602,42.78090742442889,26.26847913124871,68.13073952811325,49.142149544955046,2.311973409648682,85.76433610864554,762.5618201635588,277.7184659707648,241.79296151931015,102.55521686979141,3.778330237656486,47.77118700641314,91.89531913075591,43.58748940923717,145.36764571521437,208.57652627021602,118.5868546589221,107.71142067283763,115.04588801653797,111.62515542143186,85.56346585780102,83.10381341354962,109.83774707187285,151.04748117096574,113.87424542832643,123.93222294906673,119.06385642611939,124.74461357824515,119.62562563334018,102.42186770877397,100.8088465716308,250.14720456770735,285.79855134431824,238.14225350804537,127.53654370232913,137.37632496918076,139.29413576695396))
targetgene="Rack1"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(424.42783643983745,291.4803414311715,355.92730829614936,288.06570973756544,392.8958452762637,416.02791566672437,456.9353531951192,287.77689878541145,301.51715742818055,314.25879496005734,435.44149443126435,386.6855530810149,464.3537019033387,160.50670255063068,604.2286346466072,278.74494449153315,304.0363427453882,2197.970376785443,634.5615407095089,431.16821218838663,687.7997116670942,439.2173162241366,302.08751000936013,553.743457441261,678.4346756622961,864.6780552086071,609.8797234392572,157.85515385551378,495.06335238266763,1143.021272636739,370.2417151400944,700.8802590852781,1192.3688276800722,308.6036836480609,639.751860683965,730.8762187348278,522.4538230846188,335.17937432521785,324.97548288471523,318.8673431639478,407.75469996919736,347.11542399130644,405.3619343172031,325.1546004587982,369.80590217719197,340.64945213601925,290.1359017877376,280.9907011656417,303.4831643769248,449.28097566109443,339.2336406233029,431.324538582024,417.0316380310989,395.5340826016749,401.4647525520716,412.21138853898134,352.5070352117457,387.95143597903706),c(576.589573833862,140.38645015868667,186.58744355613115,220.55030901782354,127.36733445768988,106.09307878033945,146.77317405661404,118.66125371995862,112.72938768711255,121.95117416360434,115.38196281012765,128.8951843603383,128.98713941759408,187.25781964240247,147.1263032317947,41.93508014474393,61.28795841903082,97.62376591862188,98.60645513767506,130.69404732055912,134.3040857101427,52.76311915679563,35.024638841664945,176.85000473254928,34.12649273955212,99.41485661489334,57.17622407243036,155.4266130269674,93.57904831623595,47.34407638140339,66.05251256020463,3.778330237656486,64.96881432872188,42.51872974706617,21.090720681888953,200.5535112182124,30.375222272361555,126.427307859512,131.6472919334682,123.19874622243437,94.09723845443015,93.34196275396475,104.34145461923453,122.9136693423339,87.5033684024905,106.087972236646,90.30720121869979,100.01363939794028,89.36927539933981,139.4110344531038,109.56036151877944,129.5222022514761,392.9859239621801,384.0743594007484,345.85940974029086,146.07222358965245,165.650646886775,148.79146320560992),c(473.91733355342797,40.45033309657074,45.470889606115996,112.5256678662365,79.87443008363601,48.874339662853004,44.308882734072164,33.63626089699614,48.8946741775428,38.4615241592906,92.30557024810211,46.1088464378446,57.3276175189307,353.1147456113875,122.4180691012643,148.00616521674326,99.74314801528546,137.8217871792309,85.84561976691711,244.28793891693292,103.10212640374588,221.03468835954925,91.93967695937049,14.495902027258138,113.29995589531303,180.3339259525972,28.58811203621518,15.785515385551378,106.65999055398937,108.21503172892203,90.38764876659582,37.78330237656486,22.93016976307831,8.22943156394829,43.58748940923717,92.87377365138695,85.05062236261236,72.52419210545649,67.20456161638587,60.6934999772287,69.18914592237512,75.84034473759637,69.25317784462467,80.19898992549446,84.37824810240154,81.75586851264462,52.83931986200519,82.8684440725791,49.339287460052184,67.27038998719638,81.627124870932,69.2865756622354,319.41321673638384,284.06222964720814,288.2161747835757,110.10747156947288,113.097287670377,142.74770938101068),c(592.2489370996549,337.87925292429674,279.09718447891885,279.0636563082665,352.95863023444565,303.97455156164676,353.54796014895084,315.8071161995749,450.9175507484502,365.853522490813,333.1027100257598,257.7903687206766,253.19697737527724,244.7727213897118,268.42127078167124,1445.526880283526,454.2519271057579,396.2376381402888,194.89275838975774,410.4037373804473,242.83263981934888,289.48414023863546,87.56159710416236,39.13893547359697,116.0300753144772,2.311973409648682,38.117482714953574,335.13863433939844,446.76448873557814,121.74191069503728,208.58688176906728,419.39465637986996,231.21254511103962,700.8732548629295,352.9180594102752,297.46527502835534,409.05299326780226,376.3417536283148,357.1968480432564,415.795768500716,397.606958567249,311.13987584654916,339.80225929095843,374.8431050865502,377.09784954406615,389.313659584022,387.1681073525108,340.9988848044059,405.885459105335,384.750103818173,357.85579838853454,365.7831832258554,576.3793551445308,573.6806887251686,546.1550948424122,375.69333264156825,348.5117505929552,394.8585832071505),c(457.96251060337494,47.58862717243616,40.767004474448825,90.0205342929892,65.84243560948374,34.5696548834814,48.00128962857818,99.0401015300442,43.46193260226026,85.36582191452304,66.21921343885586,50.300559750375925,85.99142627839605,65.54023687484086,22.462031027754918,14.800616521674327,31.24484154695689,48.81188295931094,40.602657997866196,18.32159541876997,33.91517315912694,14.26030247480963,96.3177568145786,7.247951013629069,46.41203012579088,83.23104274735256,0.0,14.571244971278194,14.087168563734444,231.6478022947237,78.22008066340022,86.90159546609918,70.70135676949145,32.91772625579316,63.27216204566687,176.32557026567667,52.65038527209336,54.88317240412924,52.47479468676705,63.41111937919416,65.49905813984844,66.1172236173917,95.10769757328455,81.07071807685853,83.33654133570522,81.75586851264462,48.996460235677546,56.19814023312835,78.19811597442234,133.32321635471502,115.45737814443612,117.6623379489313,244.76383574630762,270.1716560703276,251.53411617475697,93.78500719108368,121.7025160800796,96.98785899475926),c(490.9062653983919,123.73043064833402,64.28643013278469,258.80903609234394,64.76305141916434,63.179024442224616,88.61776546814433,68.20686237446441,31.238264057874563,45.02812584502314,53.17603503423274,61.82777135983707,87.9023468623604,24.0760053825946,74.12470239159123,67.836159057674,60.08623374414787,4.306930849350966,25.521670741515898,12.214396945846646,10.85285541092062,129.76875252076763,91.93967695937049,0.0,32.761433029970036,11.559867048243412,1000.5839212675313,84.9989289991228,28.17433712746889,13.526878966115254,93.86409679608028,11.334990712969457,11.465084881539156,61.72073672961218,8.436288272755583,53.839868783412726,32.40023709051899,83.3048152562676,56.15723641917175,79.71683579098695,48.893663118478415,63.200287281330304,51.70903945731976,68.86652395776154,57.29387216829734,78.83601606576445,37.46788135669459,25.717792988041786,53.99393722043447,119.93001653825962,82.86860205528076,107.05088041507543,276.346266165186,263.22636928188723,248.04058678344092,78.01584668992801,71.30046396610724,85.18814914673217))
targetgene="Aasdhppt"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(503.315572137322,29.7428919827726,40.767004474448825,81.01848086369029,69.08058818044196,83.4439945463344,73.84813789012027,49.5200507650221,46.17830338990153,27.204492698034812,51.169392202752256,59.73191470357141,47.77301459910891,30.76378465553755,61.77058532632602,457.5857274617646,212.70526745428344,25.841585096105796,32.48212639829296,43.97182900504792,35.27178008549202,45.632967919390815,207.9587931223856,217.43853040887208,260.7264045301782,215.01352709732743,0.0,155.4266130269674,125.77829074762897,79.47041392592712,66.05251256020463,39.6724674953931,61.14711936820883,5.4862877092988604,33.74515309102233,173.63357682650604,174.15127436153958,100.94583495759485,90.21982244391528,87.86969399688334,99.63237012822017,99.17583542608754,113.57521166518447,68.86652395776154,70.83606013534944,57.42376478864325,90.30720121869979,93.34606343807759,73.54346621404005,67.27038998719638,46.24502511699189,60.85982997358515,300.0330889793448,317.3996062317216,301.6080374502873,138.325969308383,153.05013385828192,152.2450368196666),c(439.2008206528496,22.604597906907177,59.58254500111751,130.52977472483434,52.889825325650875,27.41731249379559,108.00290166430091,30.833239155579797,28.521893270233296,28.142578653139463,62.2059277758949,130.99104101660396,70.7040616066812,109.6795800762643,53.9088744666118,0.0,0.0,97.62376591862188,98.60645513767506,15.878716029600639,162.7928311638093,0.0,0.0,114.51762601533929,24.571074772477523,605.7370333279547,57.17622407243036,108.07006687031327,70.43584281867223,0.0,12.16756810319559,1.889165118828243,0.0,13.715719273247151,7.030240227296318,188.43954074194454,32.40023709051899,39.20226600294946,27.61831299303529,45.2936566994244,19.37296085826503,22.363178576470723,40.62853100217981,56.66232983866456,45.83509773463788,65.21003798032369,27.860732290875465,27.6228146908597,30.72068841852306,68.18356270195471,65.17755217831072,59.61142320489623,230.04929430114836,223.63823458777756,192.1441165223838,53.67047609165261,52.55335921639801,50.94021080733647),c(364.4495205350084,29.7428919827726,119.16509000223502,56.26283393311825,130.6054870286481,104.90102171539182,159.6965981873851,81.28763050107402,78.77475284159672,55.34707135117428,177.58789058602255,111.08040278208017,142.36358350534456,124.39269447673878,94.34053031657065,88.80369913004596,88.92762594133885,160.79208504243604,141.5292650211336,20.764474807939298,246.9024605984441,8.556181484885778,210.14783304998969,120.31598682624255,135.1409112486264,32.36762773508155,0.0,3.6428112428195485,68.42339016671016,74.3978343136339,140.7961451941204,58.56411868367553,57.32542440769578,26.059866619169586,19.684672636429692,189.78553746152986,87.07563718076979,133.28770441002814,134.40912323277175,118.66938055249193,107.93506763890518,120.56670189053781,119.11546589275446,142.96341682370752,134.38017290382467,126.52693936480715,127.77508257539438,116.20632387189252,109.84973434502184,70.00990813147135,81.93749416701918,64.91715197182417,212.46362281790925,201.0660525253466,190.10622437744942,131.1330189043471,113.097287670377,121.73846989549902),c(295.90287378663226,57.106352606923394,54.87865986945034,4.50102671464946,55.048593706289694,33.37759781853376,24.00064481428909,50.454391345494216,111.37120229329192,107.87988483703461,53.17603503423274,61.82777135983707,67.83768073073466,10.700446836708712,51.66267136383631,22.20092478251149,50.472436345084205,0.0,6.960455656777063,0.0,5.42642770546031,12.834272227328666,100.69583666978671,7.247951013629069,9.555417967074593,0.0,0.0,299.9247923254762,62.38603221082397,45.653216510638984,19.1204641621645,0.0,0.0,6.857859636623576,11.24838436367411,13.459967195853181,54.6754000902508,59.78345565449792,28.538923426136463,39.858417895493474,87.63958483500848,113.76051710639454,87.72069193652459,65.37961135230526,36.459736834371036,58.3970489376033,51.87860495542328,62.86571619299104,56.78672707666384,52.96401745598267,61.45312062526439,41.509525058906796,164.3721946800717,168.0759402802552,136.53877371060304,59.20351486398793,74.37375982671531,69.64706788347698),c(539.5093834592017,49.96805853105797,18.815540526668688,117.02669458088596,46.41352018373445,83.4439945463344,108.92600338792741,74.7472464377692,51.611044965184064,29.080664608244113,79.262391843479,101.64904782888468,34.39657051135842,13.375558545885891,104.44844427906035,108.5378544922784,67.29658179344561,58.861388274463195,126.4482777647833,18.32159541876997,28.488745453666628,79.85769385893393,48.1588784072893,10.147131419080697,91.45900054199967,0.0,9.529370678738394,342.42425682503756,165.0211174608892,365.2257320851119,173.82240147422272,13.2241558317977,107.00745889436544,10.972575418597721,70.30240227296318,39.03390486797423,129.60094836207597,98.00566500737364,59.83967815157646,78.81096265699846,76.56932148742847,86.5357779698215,79.41031059516963,73.2251647145819,97.92043606945364,88.568857555365,86.46434159237214,79.05840066694327,79.12904592649879,50.52889021662715,50.9005645582998,60.54772828141292,279.57628745802583,249.33579570500666,250.36960637765162,109.55416769223935,111.86796932613377,102.74381501818712),c(420.4391307023242,139.19673447937578,40.767004474448825,157.5359350127311,174.86023883174371,299.20632330185623,211.39029471046928,374.67057276931814,404.7392473585487,408.0673904705222,285.9466034859685,328.00156670557635,284.72716701068913,881.4493081738802,584.0128067216278,140.6058569559061,394.16569336161,1518.9109462044405,411.82695969264284,1153.0390716879233,877.7246813582052,474.86807241116065,238.60535210884245,1091.541422652538,439.5492264854313,379.16363918238386,1143.5244814486073,369.13820593904757,345.1356298114939,583.3466554137203,217.2780018427784,68.00994427781674,149.04610346000902,172.81806284291412,359.9482996375715,193.82352762028583,680.4049789008989,252.854615719024,262.37397343383526,241.8681267749263,202.03230609333534,200.29629507621604,222.53354480739398,215.31685338692535,226.05036837310044,195.63011394097106,319.9180638917769,324.8062003304537,341.6512924120595,93.75239871518772,102.42186770877397,99.87254149511409,288.5485688270254,265.6572196578414,263.76146904436325,200.57265549715535,205.91082266074073,248.9450980132545))
targetgene="Rpl31"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(434.0302761782953,80.90066619314148,64.28643013278469,177.79055522865366,102.54149808034354,103.70896465044419,105.23359649342139,150.42883345601052,145.32583713880774,100.37519719619742,115.38196281012765,101.64904782888468,76.43682335857426,73.56557200237239,288.63709870665065,249.1437114481845,231.93286225241076,341.6831807151766,375.8646054659614,28.093112975447287,196.70800432293623,89.83990559130066,146.66567514947195,43.48770608177441,297.5830166888945,490.1383628455206,247.76363764719824,47.35654615665413,144.89659094126858,86.23385340898474,66.05251256020463,421.2838214986982,166.24373078231775,2219.203378411389,178.56810177332648,109.02573428641077,174.15127436153958,146.02844086098673,197.9312431167529,186.60986560162854,107.93506763890518,114.732829218415,107.1115817330195,130.75922270461052,178.1318571050699,145.99262234400825,138.3429465477954,114.3013021690746,126.60647348239806,65.1396536527603,84.42044853571673,68.97447397006317,276.346266165186,287.1876087020063,251.24298872548064,168.20437867899375,166.57263564495744,155.98640823489472),c(474.9514424483388,327.17181181049864,241.46610342558148,753.9219747037846,185.6540807349378,177.6165026771975,234.46783780113188,228.9134422156682,201.01143828545372,227.016801135325,240.7971397776577,209.58566562656637,311.4800551861901,256.8107240810091,139.26459237208047,240.5100184772078,157.4259324096674,254.10892011170696,229.69503667364307,409.18229768586264,259.1119229357298,924.067600367664,186.06839384634503,78.27787094719395,110.56983647614886,25.431707506135503,9.529370678738394,231.92564912617792,88.5479166863308,128.50535017809491,192.9428656363872,120.90656760500755,202.54983290719173,161.8454874243164,143.4169006368449,125.1776949214346,70.87551863551029,230.31331276732806,213.5816204794729,207.44494768336375,175.27916967001696,183.76698917186812,168.9777539408842,184.80636808918288,183.3403909385515,188.81712489825068,185.41797697030913,167.64190984797608,196.4262198881323,224.94487873546663,177.2208680657877,206.61132021801728,414.16050799301905,439.2893893688488,422.13480145069167,311.5100828824785,328.53532749900273,303.33888243464764),c(651.045414267443,90.41839162762871,111.3252814494564,22.5051335732473,379.9432349924308,293.246037977118,415.39577563192654,122.39861604184708,146.68402253262838,142.58906517590663,182.60449766472374,236.83180215801997,187.27021722850694,147.13114400474478,190.9272637359168,77.70323673879021,73.3052051678604,31.584159561907082,204.17336593212718,80.61501984258787,200.77782510203147,57.04120989923852,74.427357538538,102.92090439353278,188.37823992232768,53.17538842191969,28.58811203621518,58.284979885112776,168.0397964388323,72.7069744428695,111.24633694350254,109.5715768920381,24.841017243334836,9.601003491273005,122.32617995495593,127.86968836060522,87.07563718076979,173.47002706305136,156.50377362719996,163.96303725191632,159.5962965942786,142.92988046700853,194.8322736695441,142.96341682370752,160.42284207123257,153.7788955356887,215.2001390743484,200.02727879588056,169.42925127791506,106.23242581688478,82.55823275919357,88.63688057691375,420.6205505786987,422.2734367371701,402.33813489990064,271.67220372166423,293.49975468807077,299.3097132182482),c(682.2164109568985,78.52123483451967,120.73305171279074,171.03901515667948,131.6848712189675,112.05336410507762,81.2329516791323,118.66125371995862,99.14753374890623,94.74668146556952,155.51481943973727,83.83426625062654,127.07621883362971,140.44336473180186,171.8345373623251,259.0107891293007,145.40868566083785,54.55445742511223,114.84751833682154,52.52190686714058,86.82284328736496,28.52060494961926,94.12871688697454,40.58852567632279,141.96620979653682,30.05565432543287,76.23496542990715,286.5678177684712,160.9962121569651,187.68544565484913,139.05792117937818,0.0,22.93016976307831,115.21204189527607,226.37373531894144,458.9848813785935,153.90112617996522,144.06832756083926,143.6152275637835,125.01049249041135,176.20169161564863,221.6871615406663,192.98552226035412,221.41895044647384,191.67404507212203,222.88207011185258,242.10015645864198,213.36243071560594,209.45923921720268,84.31628066268506,76.66121613353688,83.33115180998583,393.3448152169401,394.1450252439868,365.94720374035825,185.08014693461647,209.29144810740962,233.4040167499993),c(517.0544474554233,147.5247442345521,73.69420039611903,150.7843949407569,185.6540807349378,108.47719291023472,125.54183441320447,84.09065224249036,62.476528115749126,45.96621180012779,110.36535573142643,117.36797275087716,160.51732905300597,52.16467832895497,33.69304654163238,37.001541304185814,127.38281553759347,61.732675507363844,45.24296176905091,26.871673280862623,99.03230562465066,82.70975435389585,19.701359348436533,60.88278851448418,99.64935879949218,16.183813867540774,0.0,77.7133065134837,138.8592329853824,30.43547767375932,557.9699087322549,1.889165118828243,32.48440716436094,116.58361382260078,77.3326425002595,22.88194423295041,153.90112617996522,71.54413545538276,112.3144728383435,87.86969399688334,63.654014248585106,69.0341599534531,83.10381341354962,99.377009255504,88.5450751691868,84.67572095952478,83.5821968726264,83.82095492398804,83.78369568688107,52.35523564614379,46.555394413079085,56.49040628317391,284.60076502466563,277.46420719818985,243.38254759501947,118.68368166659262,125.39047111280928,102.16821941584433),c(407.88209412126395,59.4857839655452,54.87865986945034,74.2669407917161,90.66827198683008,123.97393475455397,75.69434133737329,50.454391345494216,93.71479217362369,81.61347809410444,145.48160528233484,120.51175773527565,162.42824963697032,349.1020780476217,177.45004511926385,336.7140258680909,55.27933504461603,200.99010630304505,99.76653108047122,83.05789923175719,70.54356017098404,19.964423464733482,59.10407804530959,11.59672162180651,34.12649273955212,11.559867048243412,114.35244814486072,42.4994644995614,31.193016105411985,196.13974500867118,95.60232081082249,109.5715768920381,120.38339125616113,52.11973323833917,59.05401790928907,26.919934391706363,22.27516299973181,92.12532510693123,112.3144728383435,61.59937311121718,75.6467995417968,73.89572051355543,67.4064264354347,68.86652395776154,71.87776690204576,48.66420744800275,75.8964776199711,85.72597662680596,76.33625607026941,55.3991446953382,57.418319776130865,45.878948749318035,296.444176431745,249.33579570500666,273.0775474212061,134.17619022913152,143.5229166903969,139.58193356812535))
targetgene="Rps10"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(388.6772146443482,13.086872472419945,92.50974092278771,24.75564693057203,60.44551465788672,39.33788314327193,53.5398999703372,48.58571018454999,44.820117996080896,31.894922473558058,66.21921343885586,81.73840959436087,51.59485576703763,219.3591601525286,236.97442734281438,64.13600492725541,258.3708050998358,163.66337227533668,47.56311365464326,57.407665645479234,156.0097965319839,416.4008322644412,404.97238660675094,7.247951013629069,141.96620979653682,321.36430394116684,0.0,173.64066924106515,112.69734850987555,6.763439483057627,248.5660341081385,638.5378101639461,55.41457692743925,172.81806284291412,125.13827604587446,36.34191142880359,670.2799048101117,76.44441870575145,92.06104331011763,84.24620146092938,62.73149230295344,47.64329348900284,63.712923617054706,83.68590253095074,88.5450751691868,81.75586851264462,64.36789874098814,67.62827045003581,59.579516932893206,88.27336242663779,114.21590096008735,100.49674487945856,233.2793155939882,203.4969029013007,197.9666655079106,96.55152657725134,88.20359119945162,91.8074985736742),c(449.3941797598279,64.24464668278881,166.20394131890674,74.2669407917161,73.39812494171959,51.25845379274828,86.77156202089132,97.17142036909998,73.34201126631419,66.60410281243006,75.24910618051803,28.294064859586456,85.03596598641387,73.56557200237239,78.6171085971422,46.868618985302035,40.85863894602055,21.53465424675483,42.922809883458555,105.04381373428116,122.09462337285697,105.52623831359126,83.18351724895425,142.05983986712977,57.33250780244756,4.623946819297364,57.17622407243036,3.6428112428195485,61.37980588484294,25.3628980614661,48.67027241278236,0.0,1.9108474802565258,2.7431438546494302,18.278624590970427,30.95792455046232,83.02560754445491,72.52419210545649,69.04578248258822,100.55191787272217,66.42158008548012,92.36965064194429,74.79343207219466,95.89009665004772,81.25312780231259,94.40856244912534,72.05361799364344,87.63099832962386,80.05997587857524,96.49191685946269,112.35368518356418,89.57318565343046,259.83726844622686,258.71193286940104,230.57293982686056,111.49073126255671,107.56535512128248,112.52894025801446),c(509.9634150331775,51.15777421036887,59.58254500111751,54.012320575793524,148.95501826407798,83.4439945463344,120.00322407144544,96.23707978862785,133.10216859442204,98.49902528598813,132.43842687771172,117.36797275087716,118.47707620579011,46.81445491060062,35.939249644407866,18.500770652092907,14.420696098595489,109.10891485022447,118.32774616521006,213.7519465523163,66.4737393918888,69.87548212656719,59.10407804530959,5.798360810903255,185.6481205031635,0.0,0.0,14.571244971278194,78.48565342652049,3.3817197415288134,12.16756810319559,9.445825594141215,0.0,37.03244203776731,115.29593972765961,64.60784254009528,81.00059272629748,70.56407880530902,87.45799114461175,65.22286564717113,105.16750180201018,86.5357779698215,104.34145461923453,90.6597277418633,86.46166163579417,89.54214170432506,57.642894394914755,75.24835726130745,88.43834544726336,56.61670831501596,66.72939865874669,45.56684705714581,259.47837719146685,295.5219528481346,234.35759666745298,91.57179168214955,99.26745629764068,101.88042161467294),c(533.3047300897366,260.547733769088,346.519538032815,472.6078050381933,183.49531235429896,201.4576439761502,168.92761542365014,328.8878843261845,287.9353034899742,378.9867258622781,241.80046119339792,221.11287723602751,230.26593036770498,125.73025033132737,331.314957659385,72.76969789823211,175.45180253291176,221.08911693334957,452.4296176905091,284.59544883822684,481.5954588596025,115.508450045958,151.04375500468007,111.61844560988767,443.6444056141775,20.80776068683814,104.82307746612233,282.9250065256516,157.977533179022,114.97847121197965,225.96912191648954,45.33996285187783,47.77118700641314,39.775585892416736,240.43421577353408,492.6347993682265,352.35257835939404,276.37597532079366,295.5159490254776,284.44416407238526,216.79265722344203,232.38259477289142,214.223163466039,270.2357269228618,225.0086616064041,219.96221766497243,248.82516080471535,261.94048413746265,283.0027054312427,212.769242538689,234.01844924974418,223.15270990314556,299.6741977245848,353.1678331921891,360.4157822041078,241.7937943510535,246.78565760682807,250.95968262145425),c(501.24735434750033,76.14180347589786,37.631081053337375,99.02258772228812,100.38272969970473,87.02016574117731,102.46429132254188,157.90355809978746,111.37120229329192,146.3414089963252,114.3786413943874,76.49876795369671,100.32333065812873,42.80178734683485,70.75539773742798,14.800616521674327,141.80351163618897,146.43564887793283,55.6836452542165,26.871673280862623,46.12463549641264,7.130151237404815,2.189039927604059,4.348770608177442,16.380716514985018,0.0,0.0,49.78508698520049,13.080942237753414,1.6908598707644067,46.93204839804014,0.0,15.286779842052207,1.3715719273247151,7.030240227296318,13.459967195853181,52.65038527209336,99.96577830752112,84.69615984530822,96.92842533676821,72.8792337049018,56.39410249718704,76.64018348138464,99.377009255504,118.75457140337996,109.00782468352617,71.09290308706153,58.10316193594626,81.92183578272815,33.48299954113847,28.243605943934643,28.40125398767307,302.1864365079047,267.7408056943734,232.3197045225186,96.55152657725134,90.66222788793809,80.2955865268185),c(648.6817367933611,305.75692958290233,315.1603038217005,389.3388108171783,175.93962302206313,146.623018988559,151.38868267474658,239.19118860086147,275.7116349455885,273.92109889055746,236.78385411469674,254.64658373627813,271.35072292293864,390.56630953986803,231.35891958587564,108.5378544922784,96.13797399063658,53.11881380866191,160.09048010587244,75.7292610642492,291.67048916849166,181.1058414300823,212.33687297759374,5.798360810903255,137.87103066779056,134.09445775962357,200.11678425350627,229.49710829763154,359.22279837522836,725.3788845579305,424.1266595971034,179.47068628868308,458.6033952615662,63.09230865693689,275.5854169100157,106.33374084724014,105.30077054418672,217.5725763163695,232.9144395745976,166.68065665388178,209.41248165838869,232.38259477289142,270.54908144633373,252.80116389558037,279.17741347461254,261.8134360702548,189.26083659663678,182.88208347051938,166.63646142168568,165.28426137125626,153.32243226707376,166.03810023562718,410.93048670017924,378.17086563057416,411.0719583781908,211.36208110320922,206.52548183286234,229.3748475335998))
targetgene="Rpl37"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(427.3824332824399,155.85275398972843,180.31559671390826,243.05544259107083,99.30334550938532,89.40427987107257,56.30920514121671,69.14120295493652,61.11834272192849,90.99433764515094,73.24246334903755,88.02597956315788,111.78885416191486,88.27868640284687,61.77058532632602,46.868618985302035,141.80351163618897,15.792079780953541,53.36349336862415,23.20735419710863,84.10962943463481,38.502816681986,179.50127406353283,69.58032973083907,195.2035384702381,443.89889465254697,304.9398617196286,4.857081657092731,25.155658149525795,502.1853816170288,222.49267388700508,321.1580702008013,250.32101991360489,69.95016829356047,97.01731513668919,64.60784254009528,135.67599281654827,101.92589160766859,92.9816537432188,77.90508952300996,91.32967261753515,93.34196275396475,90.49081905030958,67.99479580639748,96.87872930275732,82.72915266160467,97.03220556477318,117.15883472330148,84.71462563895753,106.23242581688478,80.38564768658321,94.56681272818616,225.74259924402858,255.93381815402495,205.24485173981907,107.06430024468845,124.77581194068767,109.07536664395775),c(461.50802681449784,69.00350940003244,20.383502237224413,139.53182815413325,68.00120399012256,79.8678233514915,79.3867482318793,91.56537688626727,84.20749441687926,58.16132921648823,49.16274937127178,67.06741300050123,62.10491897884159,2.675111709177178,35.939249644407866,167.7403205789757,99.74314801528546,89.00990421991996,125.28820182198713,68.40062289674123,43.41142164368248,68.44945187908623,43.78079855208118,52.1852472981293,62.792746640775896,233.5093143745169,95.29370678738394,60.71352071365914,135.8405540074393,87.92471327974914,97.34054482556472,56.67495356484729,91.72067905231324,26.059866619169586,59.05401790928907,115.75571788433736,60.75044454472311,97.0256083572999,131.6472919334682,107.79890294463007,54.42879479226843,80.70190529769869,85.87394052733461,97.63355295277586,72.91947366874207,102.19483564080578,86.46434159237214,92.39355258666865,114.50438410540413,63.31330822324365,70.14346091570582,76.15281289002449,222.87146920594873,224.33276326662158,222.13024379784673,104.85108473575431,125.39047111280928,104.47060182521547),c(520.5999636665462,1183.7671009143496,1150.8838955479014,949.7166367910361,279.5605052927261,349.27272002965685,304.62356879674616,272.82744949785763,220.02603379894256,190.4314488862437,238.7904969461772,195.96259736083954,260.84065971113466,218.02160429794003,206.65068545534524,393.4497225345092,286.0104726221438,81.83168613766834,185.61215084738834,254.05945647361023,230.62317748206317,426.38304399680794,201.39167333957343,233.38402263885604,608.8166304736097,1428.7995671628855,381.17482714953576,126.28412308441102,219.35733906386494,158.94082785185424,76.481856648658,1430.09799495298,431.85153053797484,176.93277862488824,156.07133304597826,121.13970476267863,431.3281562675341,174.45008371312508,189.64574921884233,202.91558201342133,171.5890818874903,166.2653711554997,183.75176521440414,312.9504063397012,256.2598646072936,271.54627755985535,214.23942416776651,210.50489816137906,233.66341797119054,278.8220689062076,315.33520482458897,271.21637049766923,410.57159544541923,340.31905263357453,396.8067133636502,267.7990765810295,228.65321202924045,261.32040346362436),c(506.861088348445,77.33151915520877,36.063119342781654,42.75975378916987,171.6220862607855,180.00061680709277,131.08044475496348,64.46950005257594,120.87850005003635,61.913673036906815,156.5181408554775,143.56618095419796,150.96272613318416,246.1102772443004,179.69624822203934,222.0092478251149,138.1983376115401,147.87129249438317,175.17146736222273,72.0649419804952,97.67569869828559,404.99259028459346,146.66567514947195,291.3676307478886,60.06262722161173,78.60709592805519,76.23496542990715,27.928219528283204,117.72848013978071,67.63439483057627,106.03166489927585,73.67743963430148,21.019322282821783,21.945150837195442,87.17497881847434,87.48978677304568,87.07563718076979,116.62674135877464,113.23508327144468,133.16335069630773,101.4774140194835,123.48363822659921,97.87782468706955,110.70947522323692,136.46358643721732,117.76738202416665,109.52149935033803,111.44376961484774,78.19811597442234,122.36514377761515,102.42186770877397,123.59227010020369,282.8063087508657,297.9528032240887,280.6468611023909,143.58235614210156,152.43547468616032,130.3724039306408),c(645.7271399507587,64.24464668278881,36.063119342781654,58.51334729044298,64.76305141916434,60.79491031232935,66.46332410110824,69.14120295493652,55.68560114664596,90.99433764515094,83.27567750643995,114.22418776647866,45.86209401514456,69.55290443860663,97.70983497073388,3.7001541304185817,92.5327999659877,170.8415903575883,283.0585300422672,651.0273572136263,571.1315159996976,98.39608707618645,102.88487659739077,189.8963165570816,343.99504681468534,252.00510165170635,219.17552561098304,173.64066924106515,391.42204080662134,745.6692030071033,64.3142885454624,7.556660475312972,9.554237401282629,165.96020320629052,496.3349600471201,367.45710444679185,635.8546529014352,115.6466847087009,124.2824084686588,107.79890294463007,101.4774140194835,82.64652952173962,92.33757045949957,101.99219370959622,107.29579696972048,102.19483564080578,106.6393546305923,90.48853088385073,105.19508458463957,72.14064446590743,90.93820375354781,85.82796534736367,392.2681414526602,368.1001997873357,291.4185767256154,155.4783895026225,142.9082575182753,158.28879064426587),c(459.58753886680626,242.7019985794244,177.17967329279682,276.81314295094177,249.3377479637827,329.00774992554705,302.77736534949315,345.7060147746826,298.8007866405393,260.78789551909233,247.82038968783937,337.4329216587718,270.39526263095644,429.3554293229371,360.5155979954664,214.60893956427773,168.24145448361404,327.32674455067337,255.21670741515896,249.17369769527158,348.64798007582493,372.1938945925313,396.2162268963347,46.38688648722604,346.7251662338495,282.0607559771392,743.2909129415947,190.6404550408897,228.4133759976942,98.06987250433559,269.4247222850452,13.2241558317977,307.64644432130063,226.309368008578,341.66967504660107,228.81944232950408,741.155423445622,289.11671177175225,299.1983907578823,279.00892526845433,261.9962325593938,269.3304550296691,223.45692051198898,292.9006588583276,255.21815784059726,245.26760553793386,297.8216210403929,317.186113519182,290.4501450478544,459.0214846185165,450.03547932643113,450.9869451888746,466.1997399332164,445.540147478445,438.14681116089037,372.09685743955026,393.0745405717722,353.12790203729855))
targetgene="Pes1"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(611.1583568923103,93.98753866556142,112.89324316001213,42.75975378916987,251.49651634442154,230.06701353489342,215.0827016049753,214.89833350858646,258.05522482592033,144.4652370861159,180.59785483324328,179.19574411071423,185.35929664454258,108.34202422167571,112.31015513877458,46.868618985302035,103.34832203993433,142.12871802858186,81.20531599573239,28.093112975447287,46.12463549641264,346.525350137874,100.69583666978671,42.038115879048604,77.80840344617883,34.679601144730235,133.41118950233752,3.6428112428195485,143.89036461528755,104.83331198739322,130.36680110566704,98.23658617906864,363.0610212487399,87.78060334878177,70.30240227296318,28.265931111291682,28.350207454204117,165.62957386246146,191.48697008504467,148.56319397411204,195.57465247391366,180.8500528358067,164.36087541790926,194.39537775418765,173.96503003828465,181.03085170657022,158.5179595860156,158.11680133388654,138.708562859392,155.54375241383417,140.907660423586,160.42026977652702,413.4427254834991,383.7270950613264,389.819654581018,270.2889440285804,271.0646949056318,242.03795078514108),c(585.4533643616693,15.466303831041753,10.975731973890067,123.77823465286015,22.66706799670752,10.72851358452871,10.154118959891537,21.489833350858646,21.73096630113013,33.771094383767355,17.056464067584088,28.294064859586456,33.44111021937624,18.725781964240248,29.200640336081392,53.03554253599967,127.38281553759347,31.584159561907082,15.080987256350301,1.2214396945846646,32.55856623276186,0.0,8.756159710416236,56.53401790630674,2.7301194191641693,0.0,0.0,3.6428112428195485,8.049810607848254,260.3924200977186,20.858688176906725,0.0,9.554237401282629,5.4862877092988604,61.8661140002076,102.29575068848418,48.600355635778484,11.760679800884837,15.650377362719997,18.11746267976976,40.5909656077934,38.892484480818645,35.08827677460984,24.408388238193965,11.45877443365947,11.67940978752066,22.09644285138399,28.57532554226865,15.825809185299757,36.52690859033288,22.967327910452347,30.585965832878692,249.42942205818738,230.93078571563987,236.97774371094002,33.751536511245455,46.71409708124268,37.413714152281024),c(641.8861640553755,58.2960682862343,14.111655395001517,65.26488736241717,98.22396131906592,97.74867932570601,149.54247922749354,85.95933340343458,92.35660677980306,131.33203371465083,170.56464067584085,149.85375092299495,146.18542467327327,109.6795800762643,65.13988998048926,7.400308260837163,62.48968309391378,41.63366487705934,37.12243016947767,30.535992364616614,46.12463549641264,362.2116828601646,113.83007623541107,342.1032878432921,126.95055299113388,11.559867048243412,0.0,177.2834804838847,50.31131629905159,125.12363043656609,111.24633694350254,151.13320950625945,55.41457692743925,4.114715781974145,22.49676872734822,134.59967195853181,72.90053345366773,114.66662805862717,147.29766929618822,105.08128354266461,143.91342351854024,158.486874259336,143.12323421222433,160.39797985098892,141.67212027069888,115.82081372624654,121.05007822932099,139.06658430570744,126.60647348239806,161.631570512223,138.11433675880127,174.1527442321052,310.4409353673843,347.26433942201487,293.16534142127347,152.9885220550716,152.43547468616032,144.18669838686762),c(421.6209694393652,39.26061741725984,29.791272500558755,117.02669458088596,74.47750913203899,88.21222280612494,80.3098499555058,93.43405804721151,127.66942701913952,114.44648652276715,81.26903467495947,110.03247445394733,137.58628204543368,191.27048720616824,55.03197601799955,310.81294695516084,263.17770379936763,244.05941479655473,212.2938975317004,96.49373587218851,89.53605714009511,64.17136113664333,142.28759529426384,13.046311824532324,106.4746573474026,13.871840457892093,0.0,23.071137871190473,56.34867425493778,1.6908598707644067,6.952896058968909,156.80070486274417,271.34034219642666,215.33679258998026,104.04755536398551,166.90359322857947,91.12566681708466,78.40453200589891,116.91752500384939,105.9871566766531,138.37829184475024,106.95433232225128,112.65183596058948,185.67809624054695,189.59063153872938,148.9124747908884,103.75720991084656,140.0190951571164,108.91880439294539,136.9759072137483,150.83947789837623,151.05721901136008,232.56153308446824,219.8183268541354,246.00269463850654,115.91716228042496,133.99569952251187,129.796808328298),c(432.84843744125436,86.849244589696,142.6845156605709,148.5338815834322,180.25715978334074,150.19919018340192,153.23488612199958,155.1005363583711,157.54950568319344,156.66035450247634,151.50153377677628,137.27861098540097,135.67536146146932,814.5715154444507,217.8817009692227,32.06800246362771,170.64490383337994,33.01980317835741,147.3296447351145,81.83645953717253,187.2117558383807,158.28935747038688,120.39719601822326,265.27500709882395,103.74453792823843,122.53459071138015,85.76433610864554,570.707094708396,307.90525575019575,86.23385340898474,191.20464162164498,253.14812592298458,110.8291538548785,21.945150837195442,60.46006595474834,569.3566123845895,93.15068163524211,143.08827091076552,169.39231969061643,153.99843277804297,154.98368686612025,172.0992438276225,158.82062119033927,156.03933909416858,152.08918793766205,158.64531628048897,146.98938070703264,140.97160600852536,130.33019329070387,212.46485163376957,191.4978556857986,204.11450668063944,249.78831331294737,308.3707334067492,280.35573365311456,189.50657795248472,195.7689463207341,195.99030259771828),c(461.50802681449784,118.9715679310904,92.50974092278771,72.01642743439136,98.22396131906592,131.12627714423976,96.00257925715636,97.17142036909998,99.14753374890623,91.93242360025558,124.4118555517898,128.8951843603383,117.52161591380793,468.1445491060062,103.32534272767262,23.434309492651018,62.48968309391378,93.31683506927092,46.403037711847084,3.664319083753994,9.496248484555542,112.65638955099607,10.945199638020295,21.743853040887206,20.47589564373127,0.0,0.0,115.35568935595236,78.48565342652049,60.87095534751864,41.71737635381345,279.59643758657995,22.93016976307831,94.63846298540534,57.64796986382981,110.3717310059961,139.72602245286316,132.30764775995442,93.90226417631999,105.9871566766531,107.93506763890518,102.09277176214896,92.33757045949957,100.24873740686807,78.12800750222365,96.35513074704545,106.6393546305923,94.29857428948655,107.05694448879248,115.364152964468,87.83451079267587,104.55406687769757,279.2173962032659,270.51892040974957,213.1052928702802,94.89161494555074,118.62922021947153,100.15363480764458))
targetgene="Rpl8"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(391.3363518026904,46.398911493125254,56.44662158000607,81.01848086369029,28.063988948304548,50.066396727800644,55.386103417590206,94.36839862768363,92.35660677980306,82.55156404920909,30.09964247220721,34.58163482838345,65.9267601467703,2.675111709177178,20.215827924979425,2.4667694202790544,60.08623374414787,53.11881380866191,42.922809883458555,83.05789923175719,149.22676190015852,166.84553895527267,24.07943920364465,343.5528780460179,55.967448092865475,0.0,0.0,114.14141894167919,66.4109375147481,18.599458578408473,64.3142885454624,0.0,7.643389921026103,64.46388058426162,36.557249181940854,68.64583269885122,174.15127436153958,53.903115754055506,67.20456161638587,59.78762684324021,58.1188825747951,54.449478273146106,63.712923617054706,99.377009255504,79.16971426891996,85.64900510848484,69.1714732738977,62.86571619299104,61.44137683704612,104.40608038736815,116.3884860326977,97.9999313420807,192.72460380611025,190.99538668210818,161.28460689909187,60.033470679838224,70.68580479398562,82.88576673736104),c(507.74746740122566,128.48929336557762,159.93209447668386,189.04312201527733,219.11499063483936,169.27210322256408,220.62131194673432,93.43405804721151,69.26745508485229,88.18007977983699,164.54471218139943,149.85375092299495,113.69977474587922,61.5275693110751,42.67785895273434,161.57339702827807,126.18109086271052,101.93069676797286,168.21101170544569,157.56572060142173,128.87765800468236,15.686332722290592,291.1423103713399,101.47131419080696,53.2373286737013,774.5110922323086,476.4685339369197,142.0696384699624,158.98375950500304,42.271496769110165,79.95830467814245,52.8966233271908,112.74000133513502,167.33177513361525,111.07779559128183,75.37581629677781,123.52590390760366,87.22504185656254,90.21982244391528,118.66938055249193,73.80175565053347,89.45271430588289,96.03107327787956,96.76182480141179,117.71286463668363,102.19483564080578,111.44292916350186,136.2090517514806,104.2641546325631,123.5827073972929,124.14771843487755,137.01264286360964,262.3495072295467,286.49308002316224,262.88808669653423,139.43257706285007,158.58206640737646,141.3087203751537),c(664.6365597434141,89.2286759483178,178.74763500335254,191.29363537260204,97.1445771287465,101.32485052054892,101.54118959891538,48.58571018454999,123.59487083767762,81.61347809410444,83.27567750643995,70.21119798489973,93.63510861425347,21.400893673417425,117.92566289571332,8.633692970976691,54.07761036973308,215.3465424675483,126.4482777647833,61.07198472923323,157.366403458349,118.36051054091993,26.26847913124871,72.4795101362907,107.83971705698468,46.239468192973646,0.0,210.06878166926063,128.79696972557207,15.21773883687966,36.50270430958677,77.45576987195797,11.465084881539156,43.890301674390884,37.96329722740012,37.68790814838891,42.52531118130618,60.76351230457166,106.79081023973644,105.9871566766531,89.48462872627182,111.81589288235361,133.8894771662744,109.83774707187285,106.25409020302416,160.59188457840906,104.71792481742847,116.20632387189252,109.84973434502184,96.49191685946269,74.48863106092654,112.04450748983112,340.2289095124628,321.91404264420777,278.90009640673287,141.09248869455067,150.28416758373464,132.67478634001193),c(503.0201124530618,212.95910659665182,432.7574321133798,301.5687898815138,460.8970492663862,408.87557327703854,480.0128962857818,361.58980464270854,385.72465184505984,345.2156314785108,404.3385305433169,475.75946097230565,450.97725781558813,415.9798707770512,370.6235119579561,483.48680637469465,584.0381919931173,538.3663561688708,925.7406023513494,575.298096149377,758.3432718380783,541.8914940427659,2869.8313450889214,437.77624122319577,451.83476387167,113.28669707278543,219.17552561098304,638.7062379076941,597.6984376327329,118.36019095350846,385.8857312727744,166.24653045688538,313.3789867620702,355.2371291771012,608.8188036838611,423.9889666693752,1235.2590390760365,453.76622898413996,429.9250722582493,452.936566994244,509.23211398868085,476.43293489002843,480.1553663893978,441.9661727415836,440.6419623125414,420.45875235074374,532.2360582463796,493.40062102983876,472.91241565483983,324.1763137392043,301.05821720457806,318.96792940002064,527.5701444971733,533.7452896916368,558.0913202627421,577.6492478318074,575.6283146918917,579.0491759568416),c(573.6349769912596,168.93962646214837,79.96604723834193,173.28952851400422,263.369742437935,181.19267387204042,285.2384326005896,234.5194856985009,234.96607313096953,337.71094383767354,232.77056845173576,237.87973048615282,241.7314538714911,298.27495557325534,220.1279040719982,165.27355115869665,216.31044147893232,581.4356646623804,415.3071875210314,45.19326869963259,421.9047540995391,213.90453712214443,400.59430675154283,184.09795574617837,296.21795697931236,628.8567674244415,543.1741286880884,110.49860769885964,38.23660038727921,27.053757932230507,271.16294629978745,20.780816307110673,85.98813661154367,1076.6839629499013,113.88989168220036,399.7610257168395,121.50088908944622,241.09393591813915,286.3098446944658,305.2792461541205,285.05928120018547,246.96727645319842,278.8594627876887,303.36139667469644,248.96791724041935,302.6913703265771,344.8966514629066,299.08840734241187,304.4140943290012,192.3750519090865,165.73720411056152,195.37565929981696,338.0755619839029,368.7947284661798,364.2004390447002,245.6669214916882,239.71707712742952,282.32964294913603),c(551.9186901981318,48.77834285174707,83.10197065945337,83.268994221015,44.25475180309563,41.7219972731672,64.61712065385524,54.19175366738268,61.11834272192849,63.789844947116116,70.23249910181683,89.0739078912907,76.43682335857426,33.43889636471473,133.64908461514176,24.667694202790543,72.10348049297744,143.5643616450322,331.78171963970664,20.764474807939298,52.907670128238024,209.62644637970155,137.90951543905572,207.2913989897914,95.55417967074592,265.8769421095985,0.0,47.35654615665413,59.36735323288087,33.817197415288135,60.83784051597795,15.113320950625944,11.465084881539156,1.3715719273247151,18.278624590970427,10.767973756682546,66.82548899919541,91.1452684568575,76.41066594739763,83.34032832694089,106.09002374764185,85.56346585780102,70.17655354921968,80.19898992549446,70.83606013534944,65.21003798032369,90.30720121869979,95.25108514089551,94.95485511179855,50.52889021662715,63.93607499396194,55.86620289882945,274.19291863662613,283.3677009683641,251.24298872548064,111.21407932393994,121.7025160800796,117.42150287792813))
targetgene="Vmn1r163"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Zfp36l2","Tacstd2","Arl15","Nprl3","Tmem121b","G3bp1","Dennd2d","Tacc2","Prkab1","Klf15")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='KA1.RPMI_5,KA2.RPMI_5,KA3.RPMI_5,KA4.MPM_5,KA5.MPM_5,KA6.MPM_5,KA7.RPMI_21,KA8.RPMI_21,KA9.RPMI_21,KA10.MPM_21,KA11.MPM_21,KA12.MPM_21,AR2466_BM,AR2466_SP,AR2467_BM,AR2467_SP,AR2468_BM,AR2468_SP,AR2469_BM,AR2469_SP,AR2473_BM,AR2473_SP,AR2474_BM,AR2474_SP,AR2475_BM,AR2475_SP,AR2476_BM,AR2476_SP,AR2480_BM,AR2480_SP,AR2481_BM,AR2481_SP,AR2482_BM,AR2482_SP,AR2483_BM,AR2483_SP,ahEGFRv3_1to10rep1,ahEGFRv3_1to10rep2,ahEGFRv3_1to10rep3,ahEGFRv3_1to2rep1,ahEGFRv3_1to2rep2,ahEGFRv3_1to2rep3,amCD19_1to10rep1,amCD19_1to10rep2,amCD19_1to10rep3,NoCAR_T_rep1,NoCAR_T_rep2,NoCAR_T_rep3,amCD19_1to2rep1,amCD19_1to2rep2,amCD19_1to2rep3,Input1_DOI_rep1,Input1_DOI_rep2,Input1_DOI_rep3,Input2_ACT_rep1,Input2_ACT_rep2,Input2_ACT_rep3_vs_pDNA_CP1704 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(371.0973634308638,640.0670354692663,722.8303485661887,400.59137760380196,316.2595677635859,379.0741466533477,342.47073946543276,459.6955655922806,516.1104496518407,424.9529376624059,255.8469610137613,206.44188064216786,187.27021722850694,1918.0550954800367,895.1119364560334,1119.9133168066908,677.7727166339879,5135.297216042802,1115.9930569699225,100.1580549559425,425.9745748786343,606.0628551794092,1392.2293939561816,804.5225625128267,754.8780193988928,8380.903609976473,1238.818188235991,2857.1782847847994,1221.5587597409726,201.2123246209644,632.7135413661707,6086.890012864599,770.0715345433799,1972.3204314929403,1469.3202075049305,913.931772598431,1215.0088908944622,542.95138414085,572.6196893889316,583.3822982885863,585.8014354761093,557.1348401877271,506.93326182265264,502.1154151857045,565.6467743160993,475.9359488414669,575.4682290425657,578.1740868052358,544.594021964727,802.678816272565,828.0652819606332,778.0695185853732,492.7576927854551,406.29927712375735,441.6403405522064,525.9153353104722,531.3728542991354,512.8556816874213),c(577.0327633602524,1386.0187663972033,1627.5442555568416,929.4620165751135,854.8722787329693,936.9568530488406,815.0988219622026,1560.3487693884322,1633.8970287662216,1799.2488618907164,655.168884478377,599.4150036919798,571.3652546053427,4488.8374479993045,1139.948074658562,1563.9318124569206,1285.8454021247644,3533.1189400842422,1238.9611069063171,1107.8458029882909,1216.8764129494746,5180.767889098339,2738.488949432678,1555.4102875247982,1868.766742417874,1040.3880343419069,1257.876929593468,1028.4870408893858,2064.7764209130773,1778.7845840441557,1326.2649232483193,715.9935800359041,693.6376353331189,5120.078004703161,1584.61614723259,1635.3860142961616,1437.7605208917803,1185.868546589221,1221.6500447252608,1163.1411040412186,1114.4065103230553,1067.598698998472,1166.2235149034796,1336.3592560411196,1340.676608738158,1258.456404605351,1127.8793003271653,1218.2613789520535,1199.9687082265523,1751.4652669064615,1813.798166333561,1844.5210007378885,643.4920197846475,633.410155105755,638.1513688137353,811.6967879015915,821.4919835405373,793.1707400283576),c(519.122665245245,543.7000654450832,363.76711684892797,607.6386064776771,1533.8049344438755,1161.0635812589958,1379.1139750979962,890.4265731899256,930.3569947671338,936.2097831944394,781.5873828616473,829.9592358812027,761.5018527097961,1873.9157522786134,1606.0352184844764,1454.1605732545027,775.1124152995075,2098.9109672503705,1435.013941238871,5136.153915728515,1892.4666622792831,17410.403291495077,1924.1660963639679,210.19057939524302,839.511721392982,19150.075752120036,1905.8741357476788,645.9918603933332,2946.230682472461,1569.1179600693695,1781.6796151107828,6052.8850407256905,1830.5918860857519,1628.0558777344368,1605.706867914479,1218.127031224713,11036.33075895803,1153.5266771367878,1171.0164709046962,1204.811268204689,1416.0711865446108,1267.894994074688,1391.5271868246587,1746.9432153335968,1682.3564282145492,1640.9570751466526,1024.1220904163188,1166.82579297597,1080.8096743607657,1585.5722237253663,1565.1923601677188,1562.6931727063634,659.2832349940867,704.9466090266901,623.303868900642,836.3188104384836,897.0950617114959,789.4293686131296),c(502.57692292667144,563.9252319933685,308.8884569794776,542.37371911526,729.6637126559183,772.452978086067,701.5573099561426,647.4980222671758,878.7459498019497,785.177944422591,406.34517337479735,421.2671879093984,419.4470681801763,591.1996877281564,677.2302354868107,1144.5810110094812,835.1986490436553,802.5247815957299,578.8778954552923,957.6087205543771,672.8770354770785,412.1227415219983,1718.3963431691864,2099.0066135469783,1176.6814696597569,4244.7831801149805,1324.5825243446368,1793.477401881491,1094.7742426673626,1117.6583745752728,2558.6657497005585,5210.317397728294,1618.4878157772773,954.6140614180017,1081.2509469581737,901.8178021221632,2689.2196785130764,866.370078665183,801.8516872311245,850.6148728151902,847.7976680355031,778.8220017283934,794.1031059516963,889.1627143913516,894.8261125921349,888.6084280005302,670.579004794175,722.003225367988,740.0893119007828,1042.2344584441648,1067.0496399477724,1060.2094483090705,507.47223423061433,568.8189879732603,530.1430851322135,647.0888844246157,663.2172467192216,623.6578351384074),c(494.74724129377506,761.4180347589786,562.8982540895049,717.9137609865888,874.3011941587187,781.9894346056481,719.0962427050462,998.810080524691,973.818927369394,746.7164202633004,779.5807400301668,811.0965259748118,750.9917894979922,3157.9693726836585,1772.2542480898628,3685.3535138969073,1729.2818071565755,5683.713077526824,1394.4112832410049,1939.6462350004474,1290.1331869731887,1547.2428185168449,1468.8457914223236,1200.2606878569738,1479.7247251869799,263.56496869994976,1210.230076199776,655.7060237075187,1215.5214017850865,2069.6124818156336,1347.123611425226,315.4905748443166,3219.778004232246,4151.7482240119125,1990.9640323703172,2844.0910684837772,1854.9135734322124,797.7661131600214,916.9279913687716,890.4732907106837,1108.8713786492651,1083.1556927907993,1045.2612976015353,1039.0999564259716,1041.7067666963153,1063.79957481334,879.05413952245,887.7401135131462,937.4464617409916,1257.4388282222094,1247.9949395666065,1239.0437179237592,627.3419133204483,668.4838533873785,652.1254863789995,843.7884127811363,824.8726089872061,859.0764364966066),c(409.211662700435,298.6186355070369,395.12635106004245,418.5954844623998,459.8176650760668,528.081279771802,476.32048939127577,646.5636816867036,559.5723822541008,528.1423927239173,332.09938861001956,324.85778172117784,302.88091255835053,1865.8904171510817,1208.4572692932145,478.5532675341366,594.8537140670638,330.19803178357404,441.98893420534347,559.4193801197764,675.5902493298086,1818.1885655382277,873.4269311140196,816.1192841346332,1687.2138010434567,161.83813867540775,4526.451072400737,132.35547515577693,692.2837122749498,282.3735984176559,1082.9135611844076,35.89413725773662,747.1413647803016,4908.855927895155,764.8901367298395,553.2046517495658,407.0279784496448,540.9912708407026,568.937247656527,470.1481565400253,633.772576648956,578.5257066521774,542.9449143018575,741.8406568108238,771.9047141219696,729.9631117200413,474.59316385146485,499.11568613829246,525.0444929711214,579.560282966615,564.5617495826057,563.9677577552225,451.1263072332972,431.64957390156445,417.7678897115466,452.6025715770292,454.2331281978729,434.86247756997403))
targetgene="Zfp36l2"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(449.09872007556766,494.9217225933361,318.296227242812,285.8151963802407,454.4207441244698,442.2531710955723,545.5531186632635,419.51892063197965,509.31952268273744,443.71465676449884,415.3750661164595,478.9032459567041,477.73014599108916,605.9128021286308,490.7953779564449,267.6444821002774,355.7105037653554,650.3465582519958,593.9588827116427,1050.4381373428116,525.006880503285,854.1921182410969,501.2901434213295,173.95082432709765,543.2937644136697,2175.56697847941,1219.7594468785144,201.56888876934835,528.2688211400417,233.33866216548813,514.5143083636992,128.46322808032053,655.4206857279884,525.3120481653659,514.6135846380905,282.65931111291684,224.77664481547552,447.8858890836976,424.4014096596423,416.70164163470446,530.4501187382092,468.6544379938647,505.0865104134627,415.8143282006615,404.1822254781704,463.28325490498617,548.568211658272,455.30018697348055,502.7021741212864,605.129118979848,630.9807789452651,565.2161645239113,432.8228532405381,464.29242180723384,448.3362718855622,431.0237203649215,440.4032968251365,445.79879401448693),c(579.5441706764644,698.3631037555007,741.6458890928575,666.15195376812,433.9124445084011,485.1672254336872,548.322423834143,696.0837324517257,548.7068991035358,533.7709084545452,486.6108866340166,517.6765940976189,551.3005884737169,1202.4627132751416,523.3653229466895,690.6954376781352,503.52263877595914,452.2277391818514,446.6292379765282,955.1658411652078,705.4356017098403,342.2472593954311,575.7175009598675,488.51189831859926,346.7251662338495,332.92417098941024,1114.936369412392,681.2057024072556,287.7807292305751,997.607323751,321.57144272731205,56.67495356484729,166.24373078231775,689.9006794443317,423.22046168323834,818.3660055078734,483.97854153962743,478.26764523598337,512.7800112373552,498.2302236936684,535.9852504119992,468.6544379938647,532.7877815513125,611.9531622575773,547.9377592822618,556.7185332051514,464.9860147856457,493.40062102983876,459.87939632576945,800.5480799381289,831.7897135136795,790.5535862722625,616.5751756776488,603.8926862548839,533.6366145235296,546.6642307067297,555.0372324258176,610.4191362845235),c(352.6311331645987,693.6042410382571,391.990427638931,812.4353219942275,1195.9576828739016,1341.0641980660887,1061.566982170479,653.1040657500084,622.04891036985,621.9509882343822,797.6405255134911,829.9592358812027,913.4200391349625,2515.942562481136,1147.8097855182762,641.3600492725542,949.3624931575363,1026.4851857619801,883.9778684106869,1094.4099663478596,1014.7419809210779,2384.3225737881703,1179.8925209785878,1791.693490569106,765.7984970755494,1384.8720723795607,1276.9356709509448,507.5650331661904,1457.015720020534,1352.6878966115253,969.9290002261628,708.4369195605912,653.5098382477319,920.3247632348838,1155.7714933675147,1134.6752346104233,846.4561939898086,698.780391502574,773.3127638049881,718.357395252871,809.9742682646047,830.3545436654781,795.9498573608863,915.3145589322737,884.4090449251718,843.8373571483677,733.0254737219993,745.8159966532119,727.0562925717124,873.9062880237141,840.1696845080338,873.8847380822483,591.4527878444501,624.3812822807827,577.3057319149805,690.2465868488312,730.5224260665384,736.4745731975934),c(560.9302105680692,756.659172041735,577.0099094845065,1010.4804974388038,865.6661206361633,832.0558313334487,784.6364650825279,646.5636816867036,688.5999946670611,760.7877095898701,728.4113478274145,701.0640515208645,834.1168349004416,593.8747994373335,458.2254329662003,1341.9225646318057,390.56051933696114,439.3069466337985,547.5558449997956,449.4898076071566,406.98207790952324,377.8980155824552,444.37510530362397,582.7352614957772,473.67571922498337,510.94612353235874,609.8797234392572,621.7064521078696,367.2726089830766,1036.4971007785814,637.9282134103973,493.07209601417145,225.48000267027004,614.4642234414723,409.15998122864573,738.9521990523397,562.9541194477675,850.6891722640032,903.118834872254,800.7918504458235,976.9507404239366,942.1704365478317,989.8587553258354,1114.0685774432818,1186.5040072671031,1091.0515309842217,705.1647414311238,729.6233121792596,727.0562925717124,1185.6025746612213,1103.3628475899743,1152.9036508842235,624.4707832823684,621.9504319048286,629.1264178861688,573.4994687525559,592.8387715112968,625.6724197466073),c(467.860410026093,483.02456580022704,296.34476329503184,378.08624403055467,742.6163229397512,888.0825133859876,718.1731409814197,1135.2238052736197,1077.0410172997622,1003.7519719619742,620.0526349274685,684.2971982707392,683.1541087672575,1683.9828209270336,1130.96326224746,814.033908692088,926.5297243347601,526.8812072372681,786.531489215808,863.5578640713579,987.6098423937764,1337.6163721371433,1131.7336425712986,1639.4865192828954,1064.746573474026,3204.3951457730736,1867.7566530327251,2043.6171072217667,992.1391574172974,1207.2739477257865,1359.2911795284217,1254.4056389019534,1182.8145902787894,1961.3478560743426,1238.7283280496113,796.8300579945084,739.1304086274645,1003.5780096755061,1068.8287128304657,1017.295529469072,1121.7866858881087,1091.9065017989835,1106.2040941048049,833.3721127040511,819.8232253900002,799.0662862962051,1180.7186201891707,1098.2450116745251,1162.731510143494,836.7705976235424,957.4892784289931,954.7190763548563,800.3274981147595,737.5894569323596,654.4545059732103,964.9619618952798,931.2086457642454,938.7964274210823),c(394.8818680138133,360.48385083120394,363.76711684892797,492.86242525411586,414.4835290826518,493.5116248883206,431.0885049335771,385.8826597349835,389.79920802652174,381.80098372759204,366.2123167451877,402.4044780030074,438.55627401981985,1296.0916230963428,398.7010507426498,543.9226571715315,280.00184924772907,327.32674455067337,609.039869967993,142.90844426640575,309.3063792112377,119.78654078840088,608.5530998739284,1459.7373341448945,569.2298988957293,53.17538842191969,28.58811203621518,330.28155268230574,417.5839252821282,140.34136927344576,241.61313804916958,717.8827451547323,133.7593236179568,2280.924115141001,338.8575789556825,231.51143576867472,718.8802604458901,406.72350978060064,404.1479801314164,384.9960819451074,379.15651965461564,319.89068485473337,322.2581209036535,404.48186223292856,385.43150367763667,407.806058414263,384.28596263276506,377.1942971579462,353.75338178905344,433.4526486052835,432.65479874554825,434.1334538115741,357.0967984861819,389.9778531709227,313.5442628706172,361.58408377211316,323.61805412202983,326.65050432953046))
targetgene="Tacstd2"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(553.2482587773029,403.3136152863965,264.98552908391736,243.05544259107083,617.4077568627,613.9093884480317,748.6354978610943,784.8460875965767,706.2564047867293,867.7295084718002,749.4810975579595,795.3776010528193,802.5866452650298,6507.209232573486,1688.021631735782,1156.9148581108766,5922.099197823213,1091.0891485022446,1386.2907516414316,1840.7096197390895,1610.292421595347,1374.6931585716484,2035.807132671775,2694.788186867288,4582.505445067059,2961.637937759962,1591.4049033493118,1097.7004545029572,2210.679238180327,9309.874448428824,2508.2572532730337,6523.287155313923,1142.6867931934025,5760.6020947638035,2380.439340962533,1152.1731919650324,1091.4829869868586,922.233307719386,1008.9890346788892,947.5432981519584,840.4174924704497,813.8252377611302,831.0381341354962,883.0606173318031,896.9095261255275,912.9405317245316,907.8755867199075,916.3154390554148,891.8308940892451,810.8973707053899,850.1015019828241,779.3179253540621,560.5881399350917,571.2498383492144,496.95455591471085,673.0941666545917,657.6853141701272,666.539707512945),c(621.2039861571585,951.7725434487232,976.840145676216,1462.8336822610745,1075.066653558128,1075.235472582766,1143.7230355732377,1183.80951545817,1348.6780960638887,1056.2847854478346,863.8597389523469,967.2378468666037,837.9386760683703,2059.836016066427,2714.5364497041815,2416.200647163334,3263.884216982112,3052.1783285733845,3285.3350699987736,6792.42614158532,1823.2797090346642,1628.5265426232597,1635.212825920232,6568.093208550663,4193.463427836165,3403.2248590028603,5889.151079460327,5121.792607404285,4120.496804892326,6929.143750392539,3667.652671106099,3927.5742820439173,2086.645448440126,6309.230865693689,7101.9486776147405,2967.922766685627,1877.188736431944,1179.008150038705,1194.9523421653269,1167.670469711161,1005.5489207385184,1102.6019350312088,1028.6405349188253,1251.8016253588048,1218.796917034689,1114.410350559263,1078.8828400914879,1230.64402002037,1167.3861599038762,1077.5438034148199,1072.9466565734292,1047.1011772378367,769.8217414601611,698.0013222382498,708.6042115386093,888.0527229598189,854.3762492490437,871.163944145805),c(468.00813986822317,467.5582619691853,575.4419477739507,414.0944577477503,619.5665252433389,568.6112199800216,608.3240358698657,679.2656020032276,706.2564047867293,610.6939567731264,711.3548837598304,792.2338160684208,761.5018527097961,4145.085593370038,2714.5364497041815,574.7572749250197,3954.8759050398126,637.425765703943,2489.522973240596,1982.3966243109107,2199.0598276377905,1805.354293310899,4097.8827444747985,5892.5841740804335,8681.779752942059,2321.221303287277,3649.7489699568046,2256.1144297195738,3905.1643711323845,16102.058549289444,3613.7677266490905,2658.055322191338,2575.822403385797,2962.595363021385,2359.3486202806444,961.0416577839172,3021.322108690896,708.5809580033115,791.7249724670116,779.0508952300997,824.7346193947114,783.6835622884958,774.7122161552014,883.0606173318031,932.3275561932022,831.1846632118869,826.2148196604448,800.1091151835222,862.0411356227986,1042.8432402540036,980.1462370433583,952.8464662018229,598.6306129396497,601.1145715395077,594.4822514222844,745.8536265108012,792.2956728647606,735.0355841917363),c(584.5669853088885,370.00157626569114,332.4078826378135,229.55236244712245,738.2987861784735,690.2010406046803,680.325970312733,826.8914137178218,854.2986127131783,1062.851387133567,653.1622416468965,746.1249696305762,577.0980163572357,2465.1154400067694,2091.2150886839827,1378.9241059359915,1690.826617560321,1204.5049942018202,2222.7055063974753,2473.415381533946,2326.580878716108,665.9561255736097,2438.5904793509217,4422.6997085164585,3061.8289285926157,6050.4344130506015,1248.3475589147295,3795.8093150179693,2157.349242903332,24257.07570598618,4990.441146324934,1401.7605181705562,649.6881432872187,2253.492676594507,4264.543721877947,1351.3807064636594,10586.77746932708,830.1079826124547,862.6119758158022,895.0026563806261,852.4102777636615,766.1819442721273,894.7510577525509,878.7019765749828,838.5739471905339,836.0510839566872,843.5076879789193,847.73465775397,828.5276573480462,933.5669053879245,951.9026310994236,960.6490085061287,631.289717122808,655.9823371681861,550.2308791322808,609.1875688341188,647.2361082440597,664.5251229047452),c(546.7481457235776,566.3046633519904,475.09239829838435,623.3921999789502,993.0334550938533,801.0623476448103,934.1789443100215,1672.469639045086,1650.1952534920692,1628.5172180616703,780.584061445907,931.6082837100874,868.5134054118,4363.107197667978,4256.554879759557,5418.259031642943,4111.100112774597,3208.6634827664693,3658.8795235791426,3536.067915822604,2798.680089091155,10080.607819442926,6262.843232875213,2957.1640135606604,6489.493859353231,16047.407436371503,1572.3461619918348,2169.9012303061777,3413.11969772766,1028.0428014247593,2640.362278393443,7110.817507269507,1723.5844271913863,8307.6111638058,2708.048535554542,8361.331622063997,2583.9189079688895,1355.4183470519774,1510.7217207190304,1328.0100144271235,1614.4134048554195,1644.1797814266083,1629.7581186101675,1911.699835941406,1939.6579995885393,1938.7820247284296,1516.96883749284,1471.6292654268357,1576.995338817517,2460.0872935589196,2540.9934270658564,2546.437706433237,791.35521674576,796.9716589735241,751.6910740315076,1067.8764830607167,1040.3106488158319,1053.0521544861251),c(492.5312936618232,615.0830062037373,876.4905962006497,621.1416866216255,725.3461758946406,835.6320025282917,954.4871822298046,1158.5823197854227,1307.9325342492698,1374.2959242283105,823.7268823227373,768.1314645213657,811.1857878928694,2609.571472302337,3525.415769806134,3351.1062574490957,3372.039437721578,1348.0693558468522,4359.565393028033,4312.9035615784505,3489.1930146109794,2555.4462034858857,5087.328791751834,2704.935318286369,4850.057148145147,6098.985854653223,2639.6356780105352,4019.2350712442353,3971.5753086471323,2248.843628116661,2244.0472030322153,30115.181159241023,2033.1417189929434,2739.029138867456,4434.675535378517,4933.077977280192,7480.404738273573,851.6692289140769,855.2470923509928,836.1209026713744,916.0642920122466,838.1330405616419,1018.4834021682803,913.5711026295456,925.035608826328,952.8451818318938,894.4255780277606,933.460634380776,905.7948433703921,933.5669053879245,937.0049048872384,911.0248394507439,626.6241308109284,669.5256464056446,621.557104204984,858.4509655278249,775.699875217477,861.0910211048063))
targetgene="Arl15"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(437.5757923894182,1019.5863371694447,912.5537155434314,724.665301058563,580.7086943918403,547.1541928109641,546.4762203868901,1180.0721531362815,1263.112416253189,1152.9076388236133,391.2953521386937,285.03650525213027,358.2976094933169,2280.532732073544,774.9400704575446,1387.5577989069682,884.4693607138565,1227.4752920650253,607.8797940251968,1232.4326518359267,704.0789947834752,794.2988478468964,1784.0675409973082,2580.2705608519486,561.0395406382368,5680.518667506812,857.6433610864555,4715.012018622769,885.479166863308,721.9971648164017,547.5405646438015,6765.100290523938,1243.9617096469983,3273.942190524095,780.3566652298913,1456.3684505913143,516.3787786301465,1505.3670145132592,1455.4850947329596,1510.0905143588095,1429.9090157290857,1535.280824880316,1620.5243615642175,1786.17098214498,1892.7811950872049,1691.5678508925755,1206.6579226668823,1298.2722904704058,1242.7914860220692,2294.803032187663,2374.63548436312,2273.972929166879,544.0791422161325,550.7612423233155,667.8463686399219,729.8078140710287,762.7920326029232,767.5567357241038),c(547.339065092098,452.0919581381435,769.8691998828605,542.37371911526,688.6471134237809,684.240755279942,601.8623238044803,717.5735658025844,675.0181407288547,728.8927871163121,442.464744341446,424.41097289379684,446.1999563556773,726.2928290416039,479.5643624425675,303.4126386943237,216.31044147893232,561.3366540320759,186.7722267901845,311.4671221190895,234.6929982611584,506.2407378557418,74.427357538538,81.17705135264558,182.91800108399934,510.94612353235874,1172.1125934848224,299.9247923254762,505.12561564247795,1388.195953897578,384.1475072580322,47.229127970706074,280.8945795977093,651.4966654792397,254.4946962281267,3173.8602647821804,226.80165963363294,943.7945540210081,1069.7493232635668,1029.0718802109225,934.5147309248799,930.5026912035861,989.8587553258354,1271.8513728401786,1338.5931952047652,1321.7198742877547,843.5076879789193,911.55288479837,877.8669448080983,1874.1348015889962,1787.1064068700623,1905.3808307114737,580.6860502016507,608.059858327948,601.1781827556403,723.9981233600766,715.4632763495589,706.8313996769399),c(537.2934358272498,306.9466452622132,224.21852460946852,533.371665685961,623.8840620046165,656.8234427861465,714.4807340869137,835.3004789420709,861.0895396822815,929.6431815087069,459.52120840903007,530.2517340352128,436.6453534358555,1025.9053404694478,648.0295951507293,751.131288474972,614.0813088651912,633.1188348545919,517.393870487095,1172.582106801278,755.6300579853482,2281.6483959695406,512.2353430593498,579.8360810903256,505.07209254537133,321.36430394116684,619.4090941179956,1809.2629172670424,597.6984376327329,808.2310182253864,1526.1606849436755,1301.6347668726594,785.3583143854321,2830.924457998212,757.859896502543,1397.1445949295603,328.05240054150477,1408.3414061559592,1345.9324531939199,1359.7155741167205,1369.0225673173957,1436.1049894542286,1390.6038111200635,2064.252262430118,2028.203074757726,1975.7668223889116,1103.8614276626176,1092.5299465660714,1170.1789497601055,2461.913638988436,2442.2959909101287,2445.6288598616065,668.9732988726062,705.9884020449562,689.0986724370947,823.8694732007292,872.5086948266313,917.2115923332278),c(562.2597791472404,619.841868920981,393.55838934948673,645.8973335521976,590.4231521047149,517.3527661872732,641.5556979204199,940.8809645354199,848.8658711378957,840.5250157737653,405.3418519590571,444.3216111283207,435.6898931438733,1231.8889420760904,559.3045725910974,1723.0384400649195,753.4813711516142,2246.782259744754,972.1436400631964,1564.6642487629554,686.4431047407293,1669.8814198002076,2351.0288822467596,1143.7266699506672,569.2298988957293,2700.384942469661,952.9370678738394,512.4221148232832,467.8952415811798,972.2444256895338,756.1274464128688,1403.6496832893845,535.0372944718272,772.1949950838147,688.9635422750392,4363.721364895601,884.9314755347999,1096.6833914325111,1171.9370813377975,1191.2231711948618,1335.8117772746557,1245.5318154982172,1225.3195599975593,1467.1184787457303,1488.5989696090346,1437.5406880140013,1186.4829096286621,1223.9764440605072,1120.8396623000535,2133.1714616754402,2107.4075204320466,2175.9729978247983,626.2652395561684,620.9086388865626,600.8870553063639,710.1655264292384,730.5224260665384,697.6218700394554),c(558.271073409727,485.4039971588488,470.3885131667172,362.3326505292815,776.0772328396527,750.9959509170096,789.2519737006604,1053.9361747725459,1049.8773094233495,1058.1609573580438,429.4215659368229,462.1363927065788,456.71001956748125,2022.3844521379467,768.2014611492182,1602.166738471246,650.13304911168,845.5940900892396,605.5596421396044,1703.908373945607,1153.115887410316,911.2333281403353,1109.843243295258,879.901253054569,636.1178246652514,388.4115328209786,686.1146888691643,9623.093033114974,1903.7802087561122,1197.1287885012,1477.490412530893,1163.7257131981976,1417.8488303503423,1313.965906377077,898.4647010484695,2344.726285517624,567.0041490840823,1267.2132485453412,1398.4072478806868,1325.292395025158,1215.8839243425386,1400.1294413094713,1318.5805061616538,1662.385584651282,1756.3176086499877,1736.3389217447382,1314.2579922040563,1180.1609448956954,1196.2449884182463,2657.0282090417973,2539.4415805854205,2570.1574350383266,727.4725733984832,726.129733731433,634.6578394224192,808.1003126995736,855.298238007226,751.7278566596772),c(577.6236827287729,667.4304960934172,439.0292789556027,589.6344996190793,863.5073522555246,820.1352606839724,724.6348530468052,799.7955368841306,831.2094610182276,889.305485439207,468.55110115069226,485.1908159255011,494.92843124676835,302.2876231370211,560.4276741424852,2007.9503081071502,676.570991959105,1603.6139195750095,759.849742531496,3319.8730898811186,854.6623636099988,1123.7118350149988,597.6079002359081,250.7791050715658,595.166033377789,5509.432635192809,762.3496542990715,673.9200799216164,466.88901525519873,219.81178319937288,1145.4896257151277,761.333542887782,1234.4074722457158,1806.3602282866498,1117.8081961401147,2088.986908796414,419.1780673585895,1036.899935778013,1021.8775807423057,989.213462315429,1052.5975399657334,1005.370723829162,1073.88594444398,1236.1105186342515,1253.1732403356673,1211.7387654552685,964.5577662082403,896.3127111758267,965.3743603032852,1703.6758948341094,1711.9970372169614,1754.0115100079413,604.3728730158094,646.9534643432137,563.9138692482688,697.4395372528671,679.5057147804445,692.1537118171989))
targetgene="Nprl3"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(505.97470929566424,1041.001219397041,1085.029503704561,1300.796720533694,1416.1520576990602,1530.6012713927626,1493.5785888276826,1172.5974284925044,1130.0102476587667,1111.6318567990088,1273.214876574365,1338.2044750256262,1416.9476130095704,1729.4597199830457,1257.8737375542753,741.2642107938559,718.6313555800085,720.6930954580616,1178.637157880916,1459.6204350286741,1276.567117709538,2852.060494961926,2861.075185378505,665.3619030511486,1330.9332168425326,2624.0898199512544,857.6433610864555,2750.322488328759,1903.7802087561122,4034.3916516438744,1918.9993122754188,2608.9370291018035,1366.255948383416,2723.9418476668843,1607.1129159599384,1284.0808704843935,1498.5109654365033,1264.27307859512,1414.0576252434068,1370.5860517245824,1352.4171722960257,1322.344472347834,1295.496113546779,1223.0345963637906,1233.3808117684373,1254.563268009511,1353.6473033739148,1281.1270951450447,1388.947488498073,1554.5243514235833,1565.502729463806,1555.2027320942298,804.9930844266393,787.5955218091297,765.0829366982191,1057.3637093932798,1036.6226937831022,1073.1980005681226),c(484.40615234466657,655.5333393003082,969.0003371234374,969.9712570069586,481.4053488824549,507.8163096676922,487.3977100747938,457.8268844313364,541.9159721344326,554.4087994668474,414.37174470071926,552.2582289260023,585.6971589850752,351.7771897567989,776.0631720089324,793.066368619716,727.0434283041892,641.7326965532939,641.521996366286,228.40922288733228,489.735100417793,256.6854445465733,820.8899728515222,736.3918229847135,711.1961086922661,823.0625338349308,1715.286722172911,1100.1289953315036,720.4580494024187,563.0563369645474,792.6301507224556,109.5715768920381,873.2572984772323,700.8732548629295,916.74332563944,729.5302220152424,812.0309420811323,451.8061156839925,493.4471921422305,469.2422834060368,474.1762800546775,450.1805078654759,473.6917364572328,599.7489681384803,573.9804284496697,625.8217077813154,513.0217601147414,521.9759465721074,491.53101469636897,472.4146844349719,468.65763709166276,483.13341948261444,474.81313004745596,466.37600784376593,444.8427424942461,538.9179764254602,502.1765436233587,530.123549757705),c(495.929080030816,1990.3943314871424,4570.608386269935,3465.790570280084,267.68727919921264,228.8749564699458,246.46816020827643,436.33705108047775,528.3341181962263,488.742782609522,300.9964247220721,270.3655086582706,243.64237445545547,888.1370874468231,564.9200803480361,1254.3522502118992,521.5485088992035,468.01981896280495,557.9965284849612,335.89591601078274,543.9993774723961,703.0329120081147,1444.766352218679,852.3590392027785,763.0683776563853,3225.2029064599114,571.7622407243036,271.9965727971929,547.3871213336813,2561.652704208076,669.2162456757575,79.3449349907862,248.41017243334835,234.53879957252627,324.7970985010899,646.0784254009527,664.2048603556393,363.6010171773562,372.8472254059764,418.5133879026815,430.81774860998905,470.5990622179056,435.833332568838,385.30384290291903,369.80590217719197,348.4357253276997,406.38240548414905,431.48741568825665,386.3359301117294,250.51371474869967,269.7109182997715,275.58579418808046,436.0528745333779,516.0348083811141,484.14494814655194,445.1329692343765,415.50960035421116,398.88775242354995),c(531.2365122999149,538.9412027278395,432.7574321133798,598.6365530483782,836.5227474975394,823.7114318788153,677.5566651418535,896.0326166727584,915.4169554351067,834.8965000431374,860.8497747051263,769.1793928494985,836.9832157763882,363.81519244809624,833.3413511297074,682.0617447071586,800.3486334720495,861.3861698701932,718.0870085908336,715.7636610266135,562.9918744415072,2377.192422550765,4837.778240004971,969.7758456235695,667.5141979856394,14001.310968832418,1353.1706363808519,593.7782325795864,584.6174953949794,613.7821330874797,537.1112205553482,375.94385864682033,208.2823753479613,447.13244830785715,523.049872910846,523.5927239186888,722.930290082205,747.7832240062609,742.9326195126492,713.8280295829286,662.3707569635378,657.2829877258351,642.669490398117,709.5867152103532,641.6913682849303,702.7111555491597,740.7111929746546,741.053442396167,736.365592092477,525.683092795874,559.2854715491234,594.8658252802734,556.9992273874918,568.4717236338383,541.2059282047144,626.6166409669751,668.4418496822553,652.7254130567181),c(576.1463843074716,1142.127052138468,1056.8061929145579,603.1375797630276,570.9942366789656,432.71671457599126,576.9385772665646,1048.330131289713,1174.8303656548478,1107.8795129785901,625.0692420061697,685.345126598872,701.3078543149189,436.04320859588006,421.1630817704047,992.8746916623194,587.6433660177661,2400.396126704938,801.6124764721584,152.6799618230831,290.31388224212657,926.919660862626,492.5339837109133,463.8688648722604,277.1071210451632,2027.6006802618942,1210.230076199776,1522.6950994985714,668.1342804514051,437.93270652798134,653.5722295430775,4220.394875462295,865.6139085562062,250.99766270042286,874.561884275662,331.11519301798825,328.05240054150477,631.1564826474863,601.1586128150681,632.2994475239647,658.6806691810111,659.2276119498761,707.3057897197667,637.2332786471353,591.6894434835071,626.7949919302754,705.1647414311238,696.2854323799462,661.8911959263604,665.0941272489778,700.5035012687966,670.7065364781256,690.1478829034451,636.8827984999753,662.0238196543951,703.5258799024359,712.3899804889508,661.6471448930313),c(491.053995240522,962.4799845625214,1152.451857258457,1201.774132811406,703.7584920882525,693.7772117995231,639.7094944731668,635.3515947210383,723.9128149063974,694.1836067774401,714.3648480070511,757.6521812400374,787.299280593315,333.0514077925587,477.318159339792,695.6289765186933,511.9347115001398,420.6435796199443,360.78361820961106,822.0289144554793,538.5729497669357,256.6854445465733,1114.221323150466,208.7409891925172,839.511721392982,92.47893638594729,285.8811203621518,352.138420139223,437.7084518017488,1418.6314315713373,790.8919267077134,387.27884935978983,611.4711936820883,186.53378211616126,704.430070775091,390.3390486797423,538.6539416298782,677.2191452009519,765.9478803401787,686.651835563274,660.5257130722745,678.6738541902854,643.592866102712,696.5107929398921,663.5672103855529,675.4591993782782,749.3576271338918,741.053442396167,673.9932853033544,613.3476734126729,667.9147251796412,632.9422317252855,621.2407619895286,623.3394892625166,627.3796531905108,620.2536463787894,638.0162206622355,664.5251229047452))
targetgene="Tmem121b"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(388.0862952758277,531.8029086519741,332.4078826378135,501.8644786834148,464.1352018373444,456.5578558749439,362.77897738521585,324.2161814238239,293.36804506525675,268.29258315992956,501.6607078701202,418.1234029249999,330.5892610258337,89.61624225743547,478.4412608911797,587.091122026415,462.6639998299386,116.28713293247607,233.1752645020316,582.6267343168851,267.2515644939203,491.98043538093225,210.14783304998969,711.7487895383746,260.7264045301782,441.5869212428983,228.70489628972143,686.0627840643483,309.9177084021578,569.819776447605,191.20464162164498,58.56411868367553,508.28542974823586,186.53378211616126,213.71930290980808,185.7475473027739,279.4520449057263,323.41869452433303,285.38923426136466,306.1851192881089,313.6574615147672,331.55843019897895,303.7906068117536,395.7645807192879,381.26467661085144,378.6075339454614,321.8394937049407,377.1942971579462,368.6482610222767,482.4595842973134,543.1462681525893,473.45826702527523,361.04460228854174,384.42162374017045,380.5035762041752,371.54355356231673,361.41959320750914,398.88775242354995),c(447.7691514963966,750.7105936451804,862.3789408056482,956.4681768630103,664.9006612367539,658.0154998510941,629.5553755132753,542.8518772542989,601.6761294625405,507.504501711615,557.8467071515737,747.1728979587091,643.9802367959882,783.8077307889132,726.6467037478716,648.7603575333914,533.565755648033,1062.3762761732382,867.7368052115405,410.4037373804473,535.8597359142057,1216.4038011012615,488.15590385570516,3729.795591613519,708.465989273102,413.84324032711413,962.4664385525778,218.5686745691729,760.70710244166,1249.5454444948966,643.1428854546241,2297.2247844951435,389.8128859723313,1599.252867260618,703.0240227296318,975.8476216993557,524.4788379027761,522.3701944893015,562.4929746248188,567.0765818767935,562.7383868353177,664.0891725099784,659.2902530808269,543.0866382998157,562.5216540160103,583.970489376033,663.8540004481016,621.0370751186388,619.9993480829199,572.5592921534678,606.7719738504641,573.9550119047339,592.52946160873,580.2787111741868,550.2308791322808,676.4139899179929,656.1486662398231,635.745342787606),c(584.8624449931488,2155.764810911358,2754.908725446407,2086.225882240025,1043.7645120388654,1056.162559543604,981.2571322149731,902.5730007360631,889.6114329525147,756.0972798143468,920.0457382338004,915.8893587880949,1041.4517182605744,798.5208451893876,633.4292749826886,1871.0446052816628,544.3812777219797,396.2376381402888,535.9550855718338,620.4913648490096,614.5429376433801,286.63207974367356,431.2408657379996,800.1737919046492,244.34568801519316,469.3306021586825,3039.8692465175477,307.21041481111524,301.86789779430956,1024.6610816832303,316.35677068308536,3238.0290136716085,485.35525998515755,359.3518449590754,455.5595667288014,80.75980317511909,328.05240054150477,896.7518348174689,882.8654053440281,896.8144026486032,993.5561354453067,981.0629210286504,1018.4834021682803,1061.7648883614374,1035.4565260961374,1107.5973615165426,862.7219861105575,849.6396794567879,758.707910942312,1439.4645893640347,1381.4537368841,1381.0499878621247,612.2684806205291,666.7475316902685,609.6208787846541,726.4879908076275,712.08265090289,722.0846831390237),c(383.0634806434036,1085.0206995315446,951.7527583073245,1244.5338866005757,484.64350145341314,567.4191629150739,450.47364112973366,228.9134422156682,321.88993833549006,400.562702829685,572.8965283876772,460.04053605031316,541.7459855538951,434.70565274129143,153.86491254012117,83.87016028948786,167.03972980873107,292.87129775586567,259.8570111863437,311.4671221190895,253.68549523026948,221.03468835954925,131.34239565624355,147.858200678033,92.82406025158176,312.1164103025721,333.5279737558438,285.353547354198,158.98375950500304,519.0939803246729,121.6756810319559,5.667495356484729,32.48440716436094,266.0849539009947,123.7322280004152,652.8084089988794,129.60094836207597,326.35886447455425,409.67164273002345,353.2905222555103,381.92408549151065,424.9003929529437,437.680083978028,458.52900761750095,428.1414811121856,484.6955061821074,369.8752390340363,354.3340367241313,318.3780436101481,530.8577381795045,539.421836599543,519.9614191589378,354.22566844810206,371.9201075209779,366.82058608818727,346.36822714819107,356.809649416597,367.2299942946968),c(419.7004814916736,422.34906615537096,636.592454485624,713.4127342719394,825.7289055943454,913.1157117498879,753.2510064792268,345.7060147746826,336.829977667517,352.72031911934795,614.0327064330271,613.0380719577066,626.7819515403089,378.5283068485707,387.4700352287723,2095.5206225270567,547.9864517466285,588.613882744632,552.1961487709802,349.33175265121406,229.2665705556981,497.68455637085606,501.2901434213295,552.2938672385351,339.89986768593906,217.3255005069761,219.17552561098304,740.7049527066415,329.0360085957974,351.69885311899657,648.3575574988507,239.92397009118687,401.27797085387044,960.1003491273005,250.27655209174893,493.98079608781177,309.8272671780879,469.44713538531977,463.06704784989165,418.5133879026815,505.54202620615416,491.98992868235587,454.3008466607379,504.73059963979665,465.64292471325297,469.12295979874654,517.825334647651,539.1211418974685,488.7382248401396,555.8177923828987,508.07453769473636,497.80219901470934,424.5683543810585,410.81371353624354,462.01926200155015,472.79816309605314,498.18125900456823,469.68601151171254),c(500.2132454525895,3133.7110993049214,2532.258162547494,3168.72280711322,1557.5513866309025,1614.045265939097,1577.5808456776945,1020.2999138755497,1112.3538375390985,1017.8232612885439,1498.962195115919,1494.3457959174182,1389.2392645420873,1464.623660774505,725.5236021964838,1066.8777742706911,1130.8229190648628,918.811914528206,1142.6748036542344,1030.8951022294568,512.7974181659993,1518.7222135672255,1278.3993177207706,310.2123033833242,1206.7127832705628,1997.5450259364613,1505.640567240666,1863.9050859093356,493.05089973070557,1898.8356348684288,874.3266794153403,3404.275544128494,861.7922135956932,1083.5418225865249,413.3781253650235,1103.717310059961,1022.6324831695057,1295.6348913974796,1295.298879373355,1312.610171149319,1516.6260786184625,1534.3085127682957,1513.4127798311981,1379.0739354579591,1420.8880297737742,1443.3803929077615,1291.2008344460905,1223.0239332090982,1340.5391309900972,1901.834373936665,1981.0872169245586,1934.406288083491,801.7630631337995,865.035469500239,776.7280346692727,1108.5443180373813,1145.417367248628,1146.2986420656562))
targetgene="G3bp1"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(611.897006102961,775.6946229107094,352.7913848750379,846.1930223540985,662.7418928561151,593.6444183439219,530.7834910852395,564.3417106051576,598.9597586748993,597.5607534016613,572.8965283876772,736.6936146773808,592.3853810289505,561.7734589272075,332.43805921077274,513.0880394180433,307.6415167700371,1264.8020260927335,490.7121238027829,789.0500427016933,332.368696959444,155.43729697542497,181.6903139911369,536.3483750085511,252.53604627268567,672.7842622077665,781.4083956565482,814.7754479773057,176.08960704668056,536.0025790323169,220.75444987226285,283.37476782423647,124.20508621667418,178.30435055221295,178.56810177332648,80.75980317511909,220.72661517916063,524.330307789449,524.7479468676705,510.91244756950726,488.9366311847842,484.2114317861922,497.6995047767027,354.7933576051766,363.55566157701406,357.19528266834016,482.27888310412015,492.4481101784298,459.87939632576945,326.0026591687209,337.6817941428669,323.6494547826041,579.2504851826106,609.448915685636,608.1652415382724,553.5805291721488,565.486438351885,598.9072242376677),c(486.7698298187485,272.44489056219703,305.75253355836617,382.5872707452041,510.5487220210789,495.89573901821586,501.24423592919135,524.1650656448566,438.6938822040645,551.5945416015335,536.7769574210286,505.1014541600249,433.77897255990894,1408.4463148817842,1008.5451931461957,610.5254315190659,745.0692984274335,288.5643669065147,590.4786548832542,285.8168885328115,851.9491497572686,831.3756342814014,820.8899728515222,305.8635327751467,709.831048982684,312.1164103025721,819.5258783715019,1611.3368397405136,1006.2263259810318,1489.6475461434422,1941.5962244670677,2863.9743201436163,1964.3512097037085,766.7087073745157,1110.7779559128182,584.1625763000281,886.9564903529574,395.94288662978954,454.7815539519811,450.21894759227854,420.6700072080407,467.68212588184423,423.82944840910307,437.6075319847632,460.4343908797714,420.45875235074374,468.82887441197335,453.39516527066263,437.5370774759345,417.31993064455315,432.3444294494611,382.0124712188114,467.99419620701633,512.5621649868939,493.46102652339476,500.46335695772973,511.0891016191222,526.3821783424769),c(604.2150543121946,1113.5738758350062,1444.0927354218218,882.2012360712941,330.29156223773816,358.8091765492379,358.1634687670833,469.9733119774739,611.1834272192849,591.9322376710334,322.06617445261713,399.2606930186089,310.52459489420795,1106.1586917447632,382.9776290232213,437.8515720995322,355.7105037653554,1069.5544942554898,790.0117170441966,991.8090320027477,443.61046492138036,168.27156920275362,232.03823232603025,213.08975980069462,473.67571922498337,510.94612353235874,600.3503527605188,499.06514026627815,461.8578836252936,965.4809862064762,544.0641166143171,154.91153974391594,563.7000066756751,207.10736102603198,598.9764673656463,168.24958994816478,453.6033192672659,556.6721772418823,556.0487015931105,484.64212668384107,443.7330558488324,481.29449545013074,462.61122800209284,495.1415899747919,494.8107141807498,482.7489378841873,565.8610799767465,531.501055086197,554.834251437568,584.1261465404066,559.2854715491234,585.8148762072786,554.128097349412,559.7901151482879,535.6745066684639,604.7611378162505,551.0419478070271,533.2893255705902),c(613.0788448400019,621.0315846002919,642.8643013278469,522.1190988993374,379.9432349924308,348.08066296470923,363.7020791088424,490.5288047478604,535.1250451653294,439.9623129440803,416.3783875321997,434.89025617512516,416.58068730422974,290.24962044572385,841.2030619894216,329.31371760725375,462.6639998299386,585.7425955117313,585.8383511120694,517.8904305038978,485.66527963869777,298.0403217235213,792.4324537926694,785.6778898773911,383.5817783925658,94.79090979559597,476.4685339369197,824.4896112914911,407.52166202231786,847.1207952529677,1246.3066185701769,613.978663619179,416.5647506959226,504.73846925549515,586.322034956513,1585.5841356715048,396.90290435885765,504.7291747879743,446.4960600540705,461.9952983341289,462.1834947614658,426.84501717698464,460.7644765929029,445.45308534703986,484.3936465137866,445.76414022370517,399.65740113807567,426.7248614312119,450.5700968050049,266.03765089959114,271.57313407629465,267.4711501916024,504.2422129377745,458.0416636976376,496.6634284654345,425.21402965396936,475.13154005000774,395.4341788094933),c(461.9512163408882,543.7000654450832,611.5050671167323,393.83983753182775,759.8864699848616,599.60470366866,707.0959202979017,625.073848335845,628.8398373389532,556.2849713770568,628.0792062533905,629.8049252078318,882.8453097915327,658.0774804575858,432.3940972842821,1323.4217939797127,493.90884137689545,396.2376381402888,632.2413888239165,475.1400411934345,522.2936666505549,313.72665444581185,774.9201343718369,334.855336829663,461.39018183874464,46.239468192973646,419.2923098644893,322.9959301966666,385.3846828507352,931.663788791188,538.8494445700904,296.5989236560342,342.0416989659181,1028.6789454935363,646.7821009112613,2368.95422647016,858.6062828987533,507.6693447381955,586.4288458854493,603.311507236333,617.167181627586,547.4117190675224,535.5579086650976,720.9191811780861,682.3179321860865,651.1270956542768,583.153948295221,547.6937395601492,554.834251437568,931.7405599584079,791.7520743184316,853.9102297832255,545.8735984899324,508.0477285744077,535.3833792191876,563.2633470237356,601.7513295070603,587.9709077931549),c(460.32618807745683,751.9003093244913,1230.8499427862432,1170.2669458088596,1191.6401461126238,1335.1039127413503,1324.6509734040324,819.4166890740449,1029.50452851604,835.834585998242,963.1885591106308,967.2378468666037,1096.8684151955406,1401.7585356088414,846.8185697463604,878.1699136193433,878.4607373394418,1340.8911377646007,952.4223490356613,470.2542824150959,600.9768683797294,2757.9424986281824,1085.7638040916133,842.2119077836978,754.8780193988928,1581.3898121996986,705.1734302266411,2361.755955761341,1767.9396547486729,2257.297927470483,1548.7575971353244,224.8106491405609,1058.6095040621153,1256.3598854294391,1810.9898825515315,180.36356042443265,848.4812088079661,1274.0736450958573,1325.6790236656939,1239.2344472962516,1492.6405080320392,1340.818402476223,1414.6115794395334,1545.5740123684966,1510.4748117096572,1585.4798786559295,1224.9115058919385,1202.0686944781014,1159.9387202872647,1378.8907992850661,1312.2413838566558,1391.6614453959805,722.4480958318435,720.2262399612588,681.8204862051862,827.7426003413639,908.4662563957457,882.1002605903179))
targetgene="Dennd2d"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(691.8188506953563,455.66110517607626,391.990427638931,373.5852173159052,793.3473798847632,704.5057253840519,625.8629686187693,607.3213773068749,747.0019666013483,629.4556758752193,454.5046013303289,597.3191470357141,586.6526192770575,825.2719622811594,818.7410309616668,358.9149506506024,866.4434905906122,717.8218082251609,1316.686195073661,1404.6556487723642,934.7021722655384,1364.7109468392816,759.5968548786085,376.8934527087116,683.8949145006244,325.98825076046415,152.4699308598143,1602.8369468406013,780.8316289612807,769.3412411978051,632.7135413661707,190.80567700165255,395.54542841310086,1013.5916542929644,721.3026473206022,1745.7577453021577,807.9809124448174,603.7148964454217,634.3005884067105,606.0291266382985,637.4626644314827,692.286223758572,692.5317784462468,881.317161029075,879.2005110916901,809.7724119347657,617.7396849321698,629.6096727813193,637.6870171723726,812.4193252299871,852.5844563515216,842.0503654806807,638.1086509632478,643.4808209489935,542.6615654510961,607.5276572024181,556.8812099421824,610.9947318868662),c(675.8640277453034,732.8648584555169,721.262386855633,819.1868620662017,719.9492549430436,635.366415617089,676.633563418227,1064.2139211577392,1083.8319442688653,1146.3410371378807,752.4910618051803,707.3516214896614,759.5909321258317,1261.3151708770395,959.128724885135,704.2626694896701,867.6452152654952,1411.2376749706664,823.6539193852857,789.0500427016933,683.7298908879991,741.5357286901008,1153.6240418473392,721.8959209574552,1152.1103948872794,1884.2583288636758,790.9377663352867,995.7017397040099,814.0370977186548,689.8708272718779,1301.9297870419282,2982.9917226297957,901.9200106810802,297.63110822946317,1335.7456431863004,300.15726846752597,826.2060458082343,879.1108151161416,827.6287793579575,778.1450220961112,881.9309800238748,800.2128681928436,860.5861566825361,904.8538211159049,939.6195035600764,887.6351438515702,847.3505476052469,852.4972120110148,862.0411356227986,939.0459416764744,868.1029211558813,891.050331151721,830.115472259838,746.6183297573319,796.2335737707874,906.0350989699087,894.0217658508877,914.6214121226853),c(596.5331025214284,993.4125922246049,893.7381750167626,985.7248505082317,1348.1508537089378,1174.1762089734198,1159.4157648748883,1200.6276459066678,1272.6197140099332,1410.8812764773918,1286.2580549789882,1320.389693447368,1327.1343455632457,1635.8308101618445,2103.569205749248,2966.290227885563,1664.3886747128959,2087.425818318768,1792.3173316200937,1460.8418747232588,1652.3472363126643,1671.3074500476887,1729.3415428072067,2212.074649359592,2457.1074772477523,1814.8991265742154,1372.2293777383286,2367.8273078327065,1386.5798772018618,1851.4915584870253,2136.2773141181974,6064.22003143866,1977.7271420655043,1981.9214349842134,1404.6419974138043,3195.3962122955454,3134.7229385077126,1286.8143815468159,1248.347747285195,1405.9151039501335,1431.7540596203492,1488.6098435033337,1483.8647572841583,1373.8435665497748,1413.5960824069,1467.7124966317629,1411.2901977688296,1349.7078764464893,1370.3288894565437,1470.5124616658177,1546.8805716985744,1479.3620208963775,915.8904821474737,896.2892600482203,915.0135730755338,1151.702020461597,1153.4079364862089,1166.4444881476536),c(465.05354302562074,731.675142776206,1188.5149766012387,1159.014379022236,840.8402842588171,1038.2817035693895,896.3317736413348,692.3463701298373,764.6583767210165,774.8589989164399,921.0490596495407,1069.9348230236212,1065.3382255601289,2372.824086040157,1184.8721367140718,1631.7679715145946,1377.1764774158692,2085.9901747023177,647.3223760802668,814.7002762879713,1714.751154925458,2069.1698890948774,1357.2047551145167,2300.4996517258664,1736.3559505884116,494.76230966481796,1172.1125934848224,2367.8273078327065,1138.0419746845469,1339.16101764541,1338.432491351515,1305.413097110316,687.9050928923493,1451.1230991095485,632.7216204566687,843.9399431799945,656.1048010830095,785.0253767090629,748.4562821112563,776.3332758281342,904.0715067190349,866.3300918102353,831.9615098400911,903.1103648131767,889.6175787586533,887.6351438515702,925.1684550383818,962.0359599230446,983.9929593448144,1115.2882756248305,1048.4274821825409,1095.1648378323605,685.4822965915653,620.5613745471405,721.122691857492,875.6033857220644,901.3976759163471,907.4264670934004),c(446.1441232329652,911.3222103521525,758.8934679089704,882.2012360712941,716.7111023720854,650.8631574614084,732.9427685594437,593.306268599793,752.4347081766308,594.7464955363473,807.6737396708935,853.0136591001251,767.2346144616891,838.6475208270454,791.7865937283608,545.1560418816711,612.8795841903083,574.2574465801288,712.2866288768528,594.8411312627317,694.5827462989197,1985.0341044935005,794.6214937202734,807.4217429182784,712.5611684018482,4129.184509632546,1010.1132919462697,1276.198205401115,1007.2325523070128,1552.2093613617253,851.7297672236913,2761.959403726891,892.3657732797976,934.0404825081309,832.3804429118841,1390.4146113316338,718.8802604458901,791.8857732595791,848.8028193192846,825.2504250635126,869.9381947306631,945.0873728838932,940.9198429823007,910.0841900240894,892.7426990587422,951.8718976829338,809.8826662485524,832.4944841314267,779.188369887994,683.3575815441443,698.9516547883607,647.9231129495527,570.2782038136112,618.4777885106084,609.9120062339305,714.0386535698731,695.1795236695456,762.3763753030187),c(495.33816066229554,555.5972222381922,760.4614296195261,861.9466158553716,358.3555511860427,385.0344319780859,396.9337411593965,376.53925393026236,346.33727542426146,445.5908286747082,469.5544225664325,469.47189100350863,412.75884613630103,323.68851681043856,251.57474751085505,312.0463316653004,317.25531416910076,595.7921008268836,360.78361820961106,205.20186869022365,272.6779921993806,221.03468835954925,251.7395916744668,605.9287047393902,270.2818224972528,806.8787199673901,829.0552490502403,365.495394696228,477.9575048409901,1285.053501780949,538.8494445700904,272.039777111267,936.3152653256976,201.62107331673312,376.82087618308265,351.30514381176806,2154.615766519513,402.8032831803057,432.68690355755285,413.07814909875054,447.4231436313591,418.09420816880044,450.6073438423579,523.0368908184421,511.47802244789085,570.3445112905922,475.5538787580467,520.0709248692895,543.6630920126505,415.4935852150365,430.17184437685074,389.19081013877275,415.237181757299,431.30230956214245,389.5285271317417,412.76469241621487,432.10539800149473,409.2484732657201))
targetgene="Tacc2"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(221.89022287944167,111.83327385522497,216.3787160566899,231.80287580444718,162.98701273823025,127.55010594939687,201.23617575057776,162.57526100214804,226.81696076804573,137.89863540038337,163.54139076565917,263.03001036134077,243.64237445545547,105.66691251249854,327.9456530052218,334.2472564478119,286.0104726221438,14.356436164503219,110.20721456563682,500.7902747797125,280.81763375757106,342.2472593954311,183.87935391874097,265.27500709882395,499.611853707043,110.97472366313674,438.3510512219661,150.56953136987468,166.02734378687023,175.84942655949828,455.41469186246354,158.6898699815724,494.9094973864402,517.0826166014176,379.6329722740012,312.27123894379383,874.8064014440127,216.59251966629574,269.73885689864466,246.39749244486873,265.68632034192046,223.63178576470722,306.56073392553856,257.15980465240074,252.0930375405083,259.8668677723347,185.41797697030913,223.84005008110444,214.11388897758496,212.16046072885013,214.77555289233817,249.0571503534408,203.13245019414973,210.789454029163,205.82710663837173,228.23784935883197,228.34588244317965,229.95044313594258),c(323.2328945807046,110.64355817591408,152.09228592390522,96.77207436496339,68.00120399012256,101.32485052054892,72.92503616649377,181.26207261159033,161.62406186465535,250.4689500129412,80.26571325921923,91.16976454755637,75.48136306659208,207.3211574612313,236.97442734281438,141.83924166604564,170.64490383337994,53.11881380866191,263.3372390147322,43.97182900504792,222.48353592387272,44.20693767190985,383.0819873307103,65.23155912266162,346.7251662338495,41.61552137367628,142.9405601810759,780.7758763776566,157.977533179022,179.2311463010271,142.53436920886264,502.51792160831263,131.8484761377003,130.29933309584794,606.0067075929427,308.23324878503786,234.9017189062627,105.84611820796354,119.67935630315291,92.39905966682578,132.84316017096023,113.76051710639454,141.27648280303436,96.76182480141179,138.54699997060993,111.92767713040632,117.20721860299334,103.8236828035761,131.26112324278034,117.79928020382353,120.73365617791842,120.78335487065361,271.3217885985463,267.7408056943734,264.9259788414686,216.89511987554457,211.75008479589607,220.74091349845804),c(369.02914564104213,1719.1391566042564,1815.6996608235283,1606.8665371298573,659.5037402851568,700.929554189209,794.7905840424195,1019.3655732950775,1029.50452851604,1008.4424017374974,752.4910618051803,763.9397512088343,665.9558235115783,522.9843391441383,933.2973892032168,1423.3259555010145,1019.0625243007478,1016.4356804468279,728.5276920759992,429.946772493802,685.0864978143642,557.5778267650566,1037.604925684324,1546.7127463084435,956.9068564170414,358.3558784955457,76.23496542990715,563.4214722227568,772.7818183534324,500.49452174626435,643.1428854546241,1626.5711673111173,808.2884841485104,1488.155541147316,655.2183891840168,2531.8198295399834,712.8052159914179,1058.4611820796354,984.1325529851574,1031.7894996128878,934.5147309248799,866.3300918102353,928.9159588225657,1061.7648883614374,1094.8338117978274,1114.410350559263,906.9148718133255,956.3208948145909,928.137162220227,1051.9749674015868,1166.0574453995873,1029.6234824761918,716.7058357556838,701.47396563247,696.6679861182795,873.1135182745136,868.5134102078408,897.0657462512304),c(427.2347034403098,193.92365572767736,147.38840079223806,195.7946620872515,387.49892432466663,360.00123361418554,421.8574876973121,283.1051958830509,226.81696076804573,245.77852023741798,269.89346083412465,337.4329216587718,295.2372302224931,160.50670255063068,352.6538871357522,196.10816891218482,280.00184924772907,262.7227818104089,415.3071875210314,178.33019540936104,541.2861636196659,549.0216452801708,499.1011034937255,942.233631771779,505.07209254537133,469.3306021586825,667.0559475116876,97.14163314185463,342.1169508335508,399.04292950039996,326.78611477153873,170.02486069454187,246.49932495309184,533.5414797293142,368.38458791032707,332.4611897375736,115.42584463497391,379.281923578536,337.8640289481317,378.654970007188,320.1151151341889,374.34016312787946,304.7139825163486,357.40854205926877,359.3888345102288,371.794544902741,304.5466253864663,345.7614390614507,336.06571269960074,361.31200413937603,325.26702229937916,298.0571160244811,415.237181757299,424.70428711312417,431.45087982753455,445.1329692343765,453.3111394396904,466.2324378976558),c(560.6347508838089,224.85626338976087,247.7379502678044,216.0492823031741,219.11499063483936,210.99410049573126,252.92987227366194,220.50437699141915,317.81538215402816,273.92109889055746,227.75396137303457,214.8253072672305,258.9297391271703,601.9001345648651,283.02159094971194,276.2781750712541,353.30705441558945,511.0891274563146,432.70832666297406,320.0171999811821,383.91976016131696,155.43729697542497,468.4545445072686,431.9778804122925,457.29500270999836,1019.5802736550688,543.1741286880884,77.7133065134837,344.12940348551285,434.55098678645254,328.52433878628096,2675.057808260792,781.5366194249191,153.61605586036808,334.63943481930477,309.5792455046232,431.3281562675341,312.63807137352194,348.9113541453458,305.2792461541205,326.57276875361055,342.2538634312041,325.9516237220335,333.87188197243887,347.9300600765693,313.3974959651377,364.1109495945449,361.001612683994,406.8163890574114,375.31398576567034,366.85650797506315,347.99338677203815,470.5064349903362,403.86842674780326,482.98043834944656,366.2871667285982,402.29442815359647,345.0695636044996),c(402.85927948883983,262.92716512770977,101.91751118612206,101.27310107961286,182.41592816397957,237.21935592457922,155.08108956925258,267.2214060150249,167.05680343993788,214.82168371896458,147.48824811381533,151.9496075792606,193.00297898040003,131.08047374968172,208.8968885581207,159.106627607999,269.18632717378244,528.3168508537185,323.6611880401334,919.7440900222524,371.7102978240312,116.93448029343897,96.3177568145786,574.0377202794223,346.7251662338495,73.98314910875783,200.11678425350627,309.6389556396616,483.9948627968763,164.01340746414746,278.11584235875637,134.13072343680525,468.1576326628488,32.91772625579316,285.42775322823053,370.1490978859625,287.55210417835605,231.2933694174018,241.19993347250818,269.0443207945809,235.2430961360754,193.49011029207279,190.2153951465691,258.0315328037648,259.38498490738255,276.41269830465563,305.50734029304823,220.9825175268776,282.07177547916626,190.8530973844893,186.84231624449072,184.76420176596108,373.60579620514113,359.7658556412074,310.92411582713015,288.547971977287,324.54004288021224,353.12790203729855))
targetgene="Prkab1"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(495.929080030816,744.762015248626,787.1167786989735,913.7084230738404,1273.6733445768987,1178.9444372332102,1379.1139750979962,1008.1534863294122,943.9388487053401,865.8533365615908,1114.690092887407,1283.7122019627188,1215.3454914013307,1146.2853673824209,1365.6914864874989,1801.9750615138494,1028.6763216998115,862.8218134866435,1332.9272582728074,1016.2378258944409,1488.19779822249,808.559150321706,1576.1087478749225,1998.9848895588973,1194.427245884324,1431.1115405725343,1419.8762311320206,1674.478901282719,1335.2623345768293,1469.3572276942693,1626.9776777987247,1874.051797877617,2625.5044378724665,1780.3003616674803,1595.8645315962642,668.9603696339032,1767.8379362514424,933.9939875202708,992.4180468830681,973.8136190376246,1071.9705008239985,1053.9863294301854,1035.1041648509902,1273.5948291429065,1226.0888644015631,1210.7654813063084,971.2827705543136,1017.281589304764,938.377391693068,1401.1113353441854,1321.8628320353587,1344.8461915701457,718.8591832842436,782.3865567177994,750.2354367851259,873.666822151747,859.9081817981382,920.0895703449418),c(40.33024690152302,0.0,0.0,0.0,0.0,0.0,0.0,1.8686811609442302,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.358640756820352,6.250240600177892,5.83970489376033,0.0,0.0,0.9309299520764563,0.0,0.0,0.0,16.150106464199183,21.53038904416492,13.3918626667116,0.553303877233532,2.1513071024256494,0.575595602342785),c(551.3277708296114,508.008595065756,558.1943689578377,445.60164475029654,782.5535379815691,785.565605800491,768.9437357808773,643.7606599452873,653.2871744277246,573.1705185689403,753.4943832209206,813.1923826310774,692.7087116870792,691.5163768223006,618.8289548146479,836.2348334745994,860.4348672161974,641.7326965532939,570.7573638557192,836.6861907904953,649.8147177288721,581.8203409722329,1138.3007623541107,1448.140612523088,773.988855333042,312.1164103025721,514.5860166518733,497.85086985200496,597.6984376327329,1247.854584624132,830.8710790467846,2605.158698864147,728.0328899777363,1121.945836551617,750.8296562752467,345.9211569334268,795.8308235358727,630.1764259974125,643.5066927377222,621.4289699161028,689.1238933868561,607.6950700127913,667.6006344221819,773.2228702599303,786.4886088557181,738.7226690606817,681.1468687665761,711.5256060024894,715.8851331467949,853.5120973941116,902.864282317647,891.9866362282378,607.9617855634092,636.8827984999753,615.1523003209045,731.7443776413461,661.3732692028568,715.753131513253),c(485.8834507659678,949.3931120901015,1905.0734783252046,616.640659906976,338.9266357602934,368.345633068819,390.47202909401096,587.7002251169604,514.75226425802,497.18555620546385,350.1591740933439,407.64411964367156,357.3421492013347,263.49850335395206,275.1598800899977,99.9041615213017,630.9054543135526,488.11882959310947,266.8174668431207,522.7761892822365,401.55565020406294,412.1227415219983,577.9065408874716,469.6672256831637,369.93118129674497,1153.6747314146924,247.76363764719824,189.42618462661653,271.6811080148786,130.1962100488593,239.87491403442735,1649.2411487370562,768.1606870631234,41.14715781974145,205.2830146370525,205.9374980965537,396.90290435885765,404.76339648045314,432.68690355755285,501.85371622962236,410.5222658060924,399.6202780404116,324.1048723128435,389.6624836597394,414.5992931451335,411.69919501010327,414.06812473680435,364.8116560896298,413.3328987219466,345.4836770835651,372.4431553046327,374.8341322988501,407.34157415257937,410.81371353624354,433.77989942174526,395.33562028335865,419.81221455906245,390.5416161895796),c(485.1448015553172,540.1309184071505,301.048648426699,537.8726924006105,570.9942366789656,517.3527661872732,605.5547306989863,536.311493190994,493.02129795688984,532.8328224994405,523.7337790164055,509.29316747255626,417.5361475962119,731.6430524599582,722.1542975423206,329.31371760725375,490.3036673522466,383.31684559223595,358.4634663240187,233.29498166567095,598.2636545269992,539.039433547804,468.4545445072686,892.9475648791014,298.94807639847653,587.2412460507653,714.7028009053795,247.7111645117293,403.4967567183937,1207.2739477257865,601.4255091008106,506.29625184596915,437.5840729787444,939.5267702174299,763.4840886843801,95.56576709055759,520.4288082664613,472.387305335541,477.7968147795105,517.2535595074266,543.3654259770526,537.6885979473178,550.3319199386175,651.1809290689605,661.4837968521603,595.6498991635536,506.29675576866794,468.6353388932059,525.0444929711214,473.0234662448108,490.3834878177663,536.1907071518938,552.692532330372,510.82584328978385,501.0303402045796,491.3338429833764,568.559734212493,549.6938002373596),c(627.7040992108839,636.4978884313336,682.06334409174,972.2217703642833,1192.7195303029432,1097.8845568167712,1149.2616459149967,839.0378412639593,664.1526575782897,852.7201331901257,1126.72994987629,1173.6797275087715,1054.828162348325,2879.7577549292323,1375.7994004499885,1499.7958075296651,1249.7936618782755,404.8514998389908,725.0474642476107,951.5015220814537,1130.0535696621096,1100.8953510553033,1026.6597260463036,2620.8590865282713,1507.0259193786214,3967.3463709571383,2144.1084027161387,4772.082728093608,1443.9347777827807,1508.2470047218508,987.3112403735851,453.39962851877834,1337.593236179568,1028.6789454935363,1147.3352050947592,1522.3222898509948,1129.9582685318499,1102.5637313329535,1159.048535274381,1009.1426712631757,1178.0605245716404,1133.7159226158635,1197.6182888597095,1161.1418976169416,1169.8366989999622,1233.1510167323897,1079.8435549980697,1109.6751418914328,1039.8487564694017,1431.24603493121,1341.416097688852,1464.0690379799382,825.4498859479583,815.7239333023128,814.2834756259205,958.0456634298607,903.8563126048336,938.7964274210823))
targetgene="Klf15"
collabel=c("pDNA_CP1704","KA1.RPMI_5","KA2.RPMI_5","KA3.RPMI_5","KA4.MPM_5","KA5.MPM_5","KA6.MPM_5","KA7.RPMI_21","KA8.RPMI_21","KA9.RPMI_21","KA10.MPM_21","KA11.MPM_21","KA12.MPM_21","AR2466_BM","AR2466_SP","AR2467_BM","AR2467_SP","AR2468_BM","AR2468_SP","AR2469_BM","AR2469_SP","AR2473_BM","AR2473_SP","AR2474_BM","AR2474_SP","AR2475_BM","AR2475_SP","AR2476_BM","AR2476_SP","AR2480_BM","AR2480_SP","AR2481_BM","AR2481_SP","AR2482_BM","AR2482_SP","AR2483_BM","AR2483_SP","ahEGFRv3_1to10rep1","ahEGFRv3_1to10rep2","ahEGFRv3_1to10rep3","ahEGFRv3_1to2rep1","ahEGFRv3_1to2rep2","ahEGFRv3_1to2rep3","amCD19_1to10rep1","amCD19_1to10rep2","amCD19_1to10rep3","NoCAR_T_rep1","NoCAR_T_rep2","NoCAR_T_rep3","amCD19_1to2rep1","amCD19_1to2rep2","amCD19_1to2rep3","Input1_DOI_rep1","Input1_DOI_rep2","Input1_DOI_rep3","Input2_ACT_rep1","Input2_ACT_rep2","Input2_ACT_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("batch_summary.Rnw");
library(tools);

texi2dvi("batch_summary.tex",pdf=TRUE);

